{"version":2,"kind":"Notebook","sha256":"9c0825cf8c5b91c44b0a0a330540c4205b8041fd0071cfe98e7c84d7d89f0028","slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","location":"/notebooks/eodashboard_STAC_access/eodashboard_STAC_access.ipynb","dependencies":[],"frontmatter":{"title":"EODashboard STAC access examples","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"eodashboard-stac-conda-forge","language":"python"},"github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","subject":"Notebook examples","numbering":{"title":{"offset":2}},"edit_url":"https://github.com/ESA-eodashboards/eodashboard-notebooks/blob/main/notebooks/eodashboard_STAC_access/eodashboard_STAC_access.ipynb","exports":[{"format":"ipynb","filename":"eodashboard_STAC_access.ipynb","url":"/eodashboard-notebooks/build/eodashboard_STAC_acc-d5b3e9635e709b295bea0a124b80c1c2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EODashboard STAC access examples","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fxq6hyzFM8"}],"identifier":"eodashboard-stac-access-examples","label":"EODashboard STAC access examples","html_id":"eodashboard-stac-access-examples","implicit":true,"key":"zYGagtjxQx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"http://eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Grydn7YgF3"}],"urlSource":"http://eodashboard.org","key":"Fobo6LDPDj"},{"type":"text","value":" uses a standard static STAC catalog","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q0NHgOZuqx"}],"key":"UjdnkoJp0s"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This example notebook outlines","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JqkMCDZUIg"}],"key":"HaBNUn9XSJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"accessing eodashboard STAC catalog","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Io6XLOrTe3"}],"key":"lZSlEjWblB"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"discovery of the collections","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZGDj1dQBuk"}],"key":"un8YFvgNdG"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"checking individual metadata fields","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bNBleIZ8Oi"}],"key":"Uk4kahNMyU"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"browsing through items inside linked GeoParquet storage","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dxM9YICpBv"}],"key":"do1I9tzbuN"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"showing linked XYZ service on an interactive map for a single date","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ENyCvV3Oli"}],"key":"LK4L4sCeX8"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"time series analysis using referenced statistics endpoint","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"SvGXDw3xHd"}],"key":"v9DUICMTdn"}],"key":"qLj0Ek81je"}],"key":"ZniK33dS6z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1: Accessing the EODashboard STAC Catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t4nzvfh1H5"}],"identifier":"step-1-accessing-the-eodashboard-stac-catalog","label":"Step 1: Accessing the EODashboard STAC Catalog","html_id":"step-1-accessing-the-eodashboard-stac-catalog","implicit":true,"key":"lrOmOobuz4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nuqyqBbLxt"},{"type":"link","url":"http://eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d0DV5epGNC"}],"urlSource":"http://eodashboard.org","key":"fmgYjtmoad"},{"type":"text","value":" platform provides a publicly accessible STAC catalog.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BmsPuBNB2i"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nb1QQmK5lk"},{"type":"text","value":"In this step, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cGLwn30CLJ"},{"type":"inlineCode","value":"pystac","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RrM19pvKJy"},{"type":"text","value":" library to load the root catalog from the provided URL to explore provided collections.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H23nZ8NML7"}],"key":"wJuWDdIQKN"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This root catalog serves as the entry point and provides metadata and links to collections and subcatalogs.\nWe’ll inspect the catalog description, and check how many child collections are directly linked.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wa9gPFEeLv"}],"key":"nZfT1T5Ab6"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Structure","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ppdDreSzV2"}],"identifier":"structure","label":"Structure","html_id":"structure","implicit":true,"key":"neAtOhpmur"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"eodash organizes its data in a two-level STAC structure:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"osA5obY37a"}],"key":"r6XKXentiR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The top level consists of ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ezc6AevurA"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"“indicators”","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"NBJ9jXtMAo"}],"key":"JALr1Lv24I"},{"type":"text","value":", represented as STAC ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"lZv1je956a"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"collections","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"WeHShF9Xbn"}],"key":"JbQWkhwuGs"},{"type":"text","value":". Each indicator describes a derived environmental variable or theme (e.g. “SMOS Ocean Salinity”).","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"VcjMqHWAhb"}],"key":"XiU46uUYBd"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Each indicator then groups one or more ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"DKynCAQpwg"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"sub-collections","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Q0tXqsAU6r"}],"key":"poWxetDUZk"},{"type":"text","value":", represented also as STAC ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"EjfmIicuL5"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"collections","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"rTFInMA2kJ"}],"key":"yGhgqwQe77"},{"type":"text","value":". They group the actual datasets contributing to the indicator and each subcollection is shown as separate layer in the eodash client interface.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"n0ZsvcCWhA"}],"key":"l44OmJIqHC"}],"key":"gyWpd1AZ2j"}],"key":"WAJzoQpsyP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Step 1: Access the EODashboard STAC Catalog via PySTAC\n\nfrom pystac import Catalog\n\n# URL to the root STAC catalog (adjust if necessary)\ncatalog_url = \"https://ESA-eodashboards.github.io/eodashboard-catalog/trilateral/catalog.json\"\n\n# Load the catalog\ncatalog = Catalog.from_file(catalog_url)\n\n# Print basic information\nprint(f\"Catalog ID: {catalog.id}\")\nprint(f\"Description: {catalog.description}\")\nindicators = list(catalog.get_children())\n\nprint(f\"Number of child indicators: {len(indicators)}\")","key":"IwNki9apkK"},{"type":"output","id":"pBIjlE3cG1EivsJVwZpTG","data":[{"name":"stdout","output_type":"stream","text":"Catalog ID: trilateral\nDescription: A Tri-Agency Dashboard by NASA, ESA, JAXA\nNumber of child indicators: 127\n"}],"key":"xsdCkHxUhq"}],"key":"OSDiX0bQvC"},{"type":"block","kind":"notebook-content","children":[],"key":"Xrg886Xw5p"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2: Discovering and Filtering Indicators","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GfAZp7rwjk"}],"identifier":"step-2-discovering-and-filtering-indicators","label":"Step 2: Discovering and Filtering Indicators","html_id":"step-2-discovering-and-filtering-indicators","implicit":true,"key":"jBrlvgsMwm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The STAC catalog contains over 100 indicators.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KKxpwbQpBN"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BTZqysidKI"},{"type":"text","value":"In this step, we retrieve all indicators and filter them to include only those relevant to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C7HAC2g8wU"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Soil Moisture and Ocean Salinity satellite (SMOS)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gWul5EgGPs"}],"key":"hXhBmJ2dpR"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UiHxUOP4U8"}],"key":"Lh4W1VWLtH"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We look for the keyword “SMOS” in the collection’s ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gXgVtCrNkD"},{"type":"inlineCode","value":"satellite","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ceV8eSgk4I"},{"type":"text","value":" metadata field.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HrXYRCt0Nh"},{"type":"break","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"iLCP1tEeDZ"},{"type":"text","value":"This helps us isolate datasets derived from or related to ESA’s SMOS mission.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Yto180b0Oz"}],"key":"txTK1Y70RB"}],"key":"YOn0ZltNFg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Step 2: Filter indicators related to SMOS\n\n# Filter indicators that mention 'SMOS' in satellite property\nsmos_indicators = [\n    ind for ind in indicators\n    if \"satellite\" in ind.extra_fields and \"SMOS\" in [s.upper() for s in ind.extra_fields[\"satellite\"]]\n]\n\n# Show results\nprint(f\"Found {len(smos_indicators)} SMOS-related collections (strict filter):\")\nfor ind in smos_indicators:\n    print(f\"{ind.id}: {ind.title}\")","key":"E9IMBds6uG"},{"type":"output","id":"pPwRNBM6HhCGWRwcGUP8H","data":[{"name":"stdout","output_type":"stream","text":"Found 14 SMOS-related collections (strict filter):\nRECCAP2_1_AGC_LVOD_amazonia_methods_mean_crop: Methods mean aboveground carbon (CCI RECCAP2)\nRECCAP2_2_AGC_LVOD_amazonia_smooth_max_crop: Smooth max aboveground carbon (CCI RECCAP2)\nRECCAP2_3_AGC_LVOD_amazonia_smooth_mean_crop: Smooth mean aboveground carbon (CCI RECCAP2)\nRECCAP2_4_AGC_LVOD_amazonia_trend_mean_crop: Trend mean aboveground carbon (CCI RECCAP2)\nRECCAP2_5_SF_biomass_growth: Secondary forest growth (CCI RECCAP2)\nRECCAP2_6_deforested_biomass: Deforestation (CCI RECCAP2)\nRECCAP2_7_degraded_biomass: Degradation (CCI RECCAP2)\nRECCAP2_8_edge_biomass_change: Edge biomass change (CCI RECCAP2)\nRECCAP2_9_intact_biomass_change_methods_mean: Methods mean intact biomass change (CCI RECCAP2)\nRECCAP2_10_intact_biomass_change_smooth_max: Smooth max intact biomass change (CCI RECCAP2)\nRECCAP2_11_intact_biomass_change_smooth_mean: Smooth mean intact biomass change (CCI RECCAP2)\nRECCAP2_12_intact_biomass_change_trend_mean: Mean intact biomass change trend (CCI RECCAP2)\nsmos_ocean_salinity: SMOS Ocean Salinity\nsmos_soil_moisture: SMOS Soil Moisture\n"}],"key":"OUGNew7q3c"}],"key":"L1XpZEnnU8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3: Checking Individual Metadata Fields","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cza887csB7"}],"identifier":"step-3-checking-individual-metadata-fields","label":"Step 3: Checking Individual Metadata Fields","html_id":"step-3-checking-individual-metadata-fields","implicit":true,"key":"tjQ7TPP91v"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Now that we’ve identified SMOS-related indicators, we’ll examine one specific indicator in detail:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"We1IQDhGEW"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nuQcyhfXGt"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"smos_ocean_salinity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZrHB41WoJV"}],"key":"iz7CLxlXQu"},{"type":"text","value":", which shows the sea surface salinity globally acquired by the SMOS mission.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t1utarEMbY"}],"key":"wWmKJpmPdk"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We’ll print out the main metadata fields, including:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gJcpwEqz17"}],"key":"OxG3ZoEyKe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Basic identification (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HverI1WCGp"},{"type":"inlineCode","value":"title","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zxY8i2ra5T"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ALUIUIkopV"},{"type":"inlineCode","value":"description","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yJF0L09ChP"},{"type":"text","value":")","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E4AWyJc9V7"}],"key":"e8uvUyiVQx"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Spatial and temporal extent","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KtcE1gGM07"}],"key":"q2aiAQrKpC"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Licensing and providers","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OzxIf3SktY"}],"key":"MWozjvElDB"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Custom fields such as ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"mrLFWEeeaG"},{"type":"inlineCode","value":"satellite","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"CXEbdjU6fK"},{"type":"text","value":", ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ynNP1XYA7K"},{"type":"inlineCode","value":"region","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HGAqe2DeeH"},{"type":"text","value":", and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Ns4KXncjrp"},{"type":"inlineCode","value":"data_source","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"PhPrBU2owF"},{"type":"text","value":" if available","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MHxS1Lqtox"}],"key":"jan9kgbnhP"}],"key":"uzvVynb1Xi"}],"key":"wtRtvZHrjs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"indicator = next(ind for ind in indicators if ind.id == \"smos_ocean_salinity\") \n# Print basic metadata\nprint(f\"Title: {indicator.title}\")\nprint(f\"License: {indicator.license}\")\nprint(f\"Temporal Extent: {indicator.extent.temporal.to_dict()}\")\nprint(f\"Spatial Extent (bbox): {indicator.extent.spatial.bboxes}\")\nprint(\"-----------------------------------------------\")\nprint(f\"Description: {indicator.description}\")","key":"fTqQKgvDKO"},{"type":"output","id":"SmfGK8NUMQ4Q9axl9Me4c","data":[{"name":"stdout","output_type":"stream","text":"Title: SMOS Ocean Salinity\nLicense: other\nTemporal Extent: {'interval': [['2023-01-04T00:00:00Z', '2023-12-27T00:00:00Z']]}\nSpatial Extent (bbox): [[-180.0, -88.59375, 180.0, 88.59375], [-180.0, -88.59375, 180.0, 88.59375]]\n-----------------------------------------------\nDescription: ## Ocean Salinity\n\nThis indicator shows the sea surface salinity globally acquired by the ESA Earth Explorer [Soil Moisture and Ocean Salinity (SMOS) mission](https://earth.esa.int/eogateway/missions/smos/description). Ocean currents are driven by temperature and salinity variations in the seawater and Understanding ocean salinity's annual and inter-annual variability are crucial in understanding the role of the ocean in the climate system. Ocean circulation is mainly driven by the water and heat flux through the atmosphere-ocean interface, but salinity is also fundamental in determining ocean density and hence thermohaline circulation. \n\nThis dataset is provided by the **Euro Data Cube**'s [SMOS Level-2C Datacube Service](https://collections.eurodatacube.com/smos-datacube/readme.html) offered by Brockmann Consult. The SMOS data cube service is implemented using the [xcube-smos datastore](https://github.com/xcube-dev/xcube-smos), which is available with the permissive MIT license.   \n\n### Dataset description\n-  Data is acquired by the sensor onboard SMOS, the [Microwave Imaging Radiometer with Aperture Synthesis (MIRAS)](https://earth.esa.int/eogateway/instruments/miras). MIRAS creates images of radiation emitted in the microwave L-band (1.4 GHz), by measuring changes in the salinity of seawater by observing variations in the natural microwave emission coming up off the surface of the ocean.\n-  The Level 2 Ocean Salinity (OS) product comprises sea surface salinity measurements geo-located in an equal-area (grid system ISEA 4H9).\n-  Spatial resolution: ~40 km (varies due to the SMOS interferometric imaging technique)\n\n### Applications\nOcean salinity can be used for various applications, including ocean circulation, climate monitoring and water management.\n\n### Read more\n\n* [SMOS L1 and L2 Science data](https://earth.esa.int/eogateway/catalog/smos-science-products)\n* [SMOS Datacube Service - Euro Data Cube](https://collections.eurodatacube.com/smos-datacube/)\n* [xcube SMOS Python Package](https://xcube-dev.github.io/xcube-smos/)\n* [Notebooks for xcube SMOS store](https://github.com/xcube-dev/xcube-smos/tree/main/notebooks)\n\n"}],"key":"mLt9cTth02"}],"key":"NIkashJ7v0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4: Navigating the Indicator and Dataset Hierarchy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FNyBGog3hP"}],"identifier":"step-4-navigating-the-indicator-and-dataset-hierarchy","label":"Step 4: Navigating the Indicator and Dataset Hierarchy","html_id":"step-4-navigating-the-indicator-and-dataset-hierarchy","implicit":true,"key":"ttbjhwVe12"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"So far, we’ve explored the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KsLsFK84Ga"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"indicator STAC Collection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JEJVBBFrTa"}],"key":"nDeEE7Fa57"},{"type":"text","value":" ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kYv6rbJB87"},{"type":"inlineCode","value":"smos_ocean_salinity","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"U0vbH6GfKL"},{"type":"text","value":" as explained in the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zEho4kmmqg"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Step 1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"d1M3jmhUkE"}],"key":"liHeeOKYkL"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"T5UFLyqchT"}],"key":"vWRJtK4AJm"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To access the actual data items on a ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mXbMg8332N"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"subcollection STAC Collection","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PwuNNy8lGH"}],"key":"bMHapnJcrk"},{"type":"text","value":" we now need to look at its ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vUVLtCM5mY"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"child collections","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EVPCQnYakQ"}],"key":"icIAOtAyBt"},{"type":"text","value":", which contain the STAC Items and assets.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"V5owCZ9Vdq"}],"key":"cKfPEWvmk6"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"In this step, we identify and load those child collections so we can continue our exploration at the data level.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EqyTO0i2QQ"}],"key":"HlkCGZoTkr"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"In our case, the indicator has just one collection - itself so it looks easy.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"K6ovwDTrOI"}],"key":"paEsZqxcFF"}],"key":"adRwT4msGY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get child links that are STAC collections\nchild_collections = []\nfor link in indicator.get_links(\"child\"):\n    if link.rel == \"child\":\n        child_collection = link.resolve_stac_object().target\n        child_collections.append(child_collection)\n\n# Show child collection IDs and titles\nprint(f\"{len(child_collections)} child collections found under 'smos_ocean_salinity':\")\nfor col in child_collections:\n    print(f\"- {col.id}: {col.title}\")","key":"h5pia3mp1K"},{"type":"output","id":"wwWEMu3DX81m1AFwnlLVM","data":[{"name":"stdout","output_type":"stream","text":"1 child collections found under 'smos_ocean_salinity':\n- smos_ocean_salinity: SMOS Ocean Salinity\n"}],"key":"FZFumLPxRm"}],"key":"kKGYWhwlck"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 5: Accessing and Browsing STAC Items via GeoParquet","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B5nLhcPWs0"}],"identifier":"step-5-accessing-and-browsing-stac-items-via-geoparquet","label":"Step 5: Accessing and Browsing STAC Items via GeoParquet","html_id":"step-5-accessing-and-browsing-stac-items-via-geoparquet","implicit":true,"key":"KfVjhg5K4g"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In eodashboard, each child collection under an indicator may reference a bulk listing of STAC Items using a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MasxQ3NocX"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"GeoParquet","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"z0wui1Y5Tn"}],"key":"IVWUDfulXF"},{"type":"text","value":" file for performance reasons during the catalog creation.\nThis file acts as a storage for the STAC Items associated with that dataset and can be efficiently read and queried.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p6Tcr3sqjw"}],"key":"I2oqdrxRdV"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We identify this asset by checking for an ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"z9B5bqBBr0"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Asset","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yF8JB2Kalz"}],"key":"JJtHaXy0Sx"},{"type":"text","value":" with a ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sm4h018Tzz"},{"type":"inlineCode","value":"roles","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qL3dHmaPsF"},{"type":"text","value":" array containing ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ybiKV58hKD"},{"type":"inlineCode","value":"\"collection-mirror\"","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"w9kpbOgDfQ"},{"type":"text","value":" which is eodash specific way of distinction of the GeoParquet.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"F05UdrpU5f"}],"key":"a37YwdkPm5"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Once found, we load it and use ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kzQFAOMTSk"},{"type":"inlineCode","value":"pyarrow.parquet","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vbMjjcI7vN"},{"type":"text","value":" to load the GeoParquet file and ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tBBjUFEUsG"},{"type":"inlineCode","value":"stac_geoparquet","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Jq14xTAsx3"},{"type":"text","value":" to convert it back to STAC Item structure and display their contents.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"t3rkyZgVqk"}],"key":"ntxY18XAGd"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This enables fast, local-style exploration of all STAC items in the dataset, including geometry, timestamp, and links to assets like XYZ tiles or statistics endpoints.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"VzYIbx5raQ"}],"key":"k9yFxodYjy"}],"key":"dJQp00E98e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import requests\nimport pyarrow.parquet as pq\nimport io\nimport stac_geoparquet\n\ngeoparquet_asset = None\nfor key, asset in child_collection.assets.items():\n    # specific way how eodash labels the asset with a geoparquet of items\n    if \"collection-mirror\" in asset.roles:\n        geoparquet_asset = asset\n        break\n\nif geoparquet_asset is None:\n    raise ValueError(\"No asset with role 'collection-mirror' found in the child collection.\")\n# eodash catalog links the asset href with relative path, we need to get absolute to retrieve it\nparquet_url = geoparquet_asset.get_absolute_href()\nprint(f\"Reading remote GeoParquet from: {parquet_url}\")\n\nresponse = requests.get(parquet_url)\nif response.status_code != 200:\n    print(f\"Failed to download parquet file from {parquet_url}\")\n# Read the table with pyarrow\ntable = pq.read_table(io.BytesIO(response.content))\n\n# Convert to a list of STAC dictionaries\nitems = list(stac_geoparquet.arrow.stac_table_to_items(table))\nprint(f\"In total {len(items)} items were retrieved.\")\nprint(f\"Submission {len(items)} items were retrieved.\")\n# show example of metadata of one item\nitem = items[0]\nprint(\"-------------------------------------\")\nprint(f\"Datetime: {item['properties'].get('datetime')}\")\nprint(f\"BBox: {item['bbox']}\")\nprint(f\"Number of service links: {len(item['links'])}\")\n","key":"YEva1Xmokt"},{"type":"output","id":"zRsDdoIracM5xuNyDG3vV","data":[{"name":"stdout","output_type":"stream","text":"Reading remote GeoParquet from: https://ESA-eodashboards.github.io/eodashboard-catalog/trilateral/smos_ocean_salinity/smos_ocean_salinity/items.parquet\nIn total 52 items were retrieved.\nSubmission 52 items were retrieved.\n-------------------------------------\nDatetime: 2023-01-04T00:00:00.000000Z\nBBox: [-180.0, -88.59375, 180.0, 88.59375]\nNumber of service links: 1\n"}],"key":"eB9mMcshQo"}],"key":"mtDJ8zG4mJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 6. Visualize Linked XYZ Tile Layer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vda0qQKW0m"}],"identifier":"step-6-visualize-linked-xyz-tile-layer","label":"Step 6. Visualize Linked XYZ Tile Layer","html_id":"step-6-visualize-linked-xyz-tile-layer","implicit":true,"key":"YwAQmjr86N"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For each item, eodash links the suggested rendering of the visualization layer, which we can display using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"daLKumFxRi"},{"type":"inlineCode","value":"folium","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XZIUAlDJ8P"},{"type":"text","value":" on the map.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T4nHpkAeXb"}],"key":"unZUuXWrW6"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We selected the first Item containing data for 1.4.2023 and add the tile layer with a eox cloudless background..","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NCDe5XHwig"}],"key":"wyvAYxHPgT"}],"key":"ZPgeQaVVuq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import folium\n\n# Find the xyz tile link for 1.4.2023\nxyz_link = next((l for l in item[\"links\"] if l[\"rel\"] == \"xyz\"), None)\nprint(f\"Actual link is {xyz_link}\")\nm = folium.Map(location=[45, 10], zoom_start=4, tiles=None)\nif xyz_link:\n    folium.TileLayer(\n        tiles=xyz_link[\"href\"],\n        attr='Rendering of SMOS datacube provided by xcube-server operated by Brockmann Consult GmbH',\n        name=xyz_link.get(\"title\", \"Tile Layer\"),\n        overlay=True,\n        control=True\n    ).add_to(m)\n\n# Add EOxCloudless layer\nfolium.TileLayer(\n    tiles=\"https://tiles.maps.eox.at/wmts/1.0.0/s2cloudless-2024_3857/default/GoogleMapsCompatible/{z}/{y}/{x}.jpg\",\n    attr='<a href=\"https://maps.eox.at\">Overlay</a> { Data &copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Rendering &copy; <a href=\"https://eox.at\">EOX</a> and <a href=\"https://github.com/mapserver/basemaps\">MapServer</a> }',\n    name=\"EOxCloudless 2024\",\n    overlay=False,\n    control=True\n).add_to(m)\n\nfolium.LayerControl().add_to(m)\nm","key":"zD2NsH1ipN"},{"type":"output","id":"uKHjJNla2z1FTaFZSSN9s","data":[{"name":"stdout","output_type":"stream","text":"Actual link is {'href': 'https://api.earthsystemdatalab.net/api/tiles/smos-os/SSS_corr/{z}/{y}/{x}?crs=EPSG:3857&time=2023-01-04T00:00:00Z&vmin=0&vmax=50&cbar=jet', 'rel': 'xyz', 'title': 'xcube tiles', 'type': 'image/png'}\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc=\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    \n    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;\n    \n            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;\n            &lt;style&gt;\n                #map_a26eabbe1a83bd64022fbca20c853cf0 {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            &lt;/style&gt;\n\n            &lt;style&gt;html, body {\n                width: 100%;\n                height: 100%;\n                margin: 0;\n                padding: 0;\n            }\n            &lt;/style&gt;\n\n            &lt;style&gt;#map {\n                position:absolute;\n                top:0;\n                bottom:0;\n                right:0;\n                left:0;\n                }\n            &lt;/style&gt;\n\n            &lt;script&gt;\n                L_NO_TOUCH = false;\n                L_DISABLE_3D = false;\n            &lt;/script&gt;\n\n        \n&lt;/head&gt;\n&lt;body&gt;\n    \n    \n            &lt;div class=&quot;folium-map&quot; id=&quot;map_a26eabbe1a83bd64022fbca20c853cf0&quot; &gt;&lt;/div&gt;\n        \n&lt;/body&gt;\n&lt;script&gt;\n    \n    \n            var map_a26eabbe1a83bd64022fbca20c853cf0 = L.map(\n                &quot;map_a26eabbe1a83bd64022fbca20c853cf0&quot;,\n                {\n                    center: [45.0, 10.0],\n                    crs: L.CRS.EPSG3857,\n                    ...{\n  &quot;zoom&quot;: 4,\n  &quot;zoomControl&quot;: true,\n  &quot;preferCanvas&quot;: false,\n}\n\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_40e61b0b1ef261965f21a673d12e7044 = L.tileLayer(\n                &quot;https://api.earthsystemdatalab.net/api/tiles/smos-os/SSS_corr/{z}/{y}/{x}?crs=EPSG:3857\\u0026time=2023-01-04T00:00:00Z\\u0026vmin=0\\u0026vmax=50\\u0026cbar=jet&quot;,\n                {\n  &quot;minZoom&quot;: 0,\n  &quot;maxZoom&quot;: 18,\n  &quot;maxNativeZoom&quot;: 18,\n  &quot;noWrap&quot;: false,\n  &quot;attribution&quot;: &quot;Rendering of SMOS datacube provided by xcube-server operated by Brockmann Consult GmbH&quot;,\n  &quot;subdomains&quot;: &quot;abc&quot;,\n  &quot;detectRetina&quot;: false,\n  &quot;tms&quot;: false,\n  &quot;opacity&quot;: 1,\n}\n\n            );\n        \n    \n            tile_layer_40e61b0b1ef261965f21a673d12e7044.addTo(map_a26eabbe1a83bd64022fbca20c853cf0);\n        \n    \n            var tile_layer_c99752973ac84b7941ee846fcef27e68 = L.tileLayer(\n                &quot;https://tiles.maps.eox.at/wmts/1.0.0/s2cloudless-2024_3857/default/GoogleMapsCompatible/{z}/{y}/{x}.jpg&quot;,\n                {\n  &quot;minZoom&quot;: 0,\n  &quot;maxZoom&quot;: 18,\n  &quot;maxNativeZoom&quot;: 18,\n  &quot;noWrap&quot;: false,\n  &quot;attribution&quot;: &quot;\\u003ca href=\\&quot;https://maps.eox.at\\&quot;\\u003eOverlay\\u003c/a\\u003e { Data \\u0026copy; \\u003ca href=\\&quot;http://www.openstreetmap.org/copyright\\&quot;\\u003eOpenStreetMap\\u003c/a\\u003e contributors, Rendering \\u0026copy; \\u003ca href=\\&quot;https://eox.at\\&quot;\\u003eEOX\\u003c/a\\u003e and \\u003ca href=\\&quot;https://github.com/mapserver/basemaps\\&quot;\\u003eMapServer\\u003c/a\\u003e }&quot;,\n  &quot;subdomains&quot;: &quot;abc&quot;,\n  &quot;detectRetina&quot;: false,\n  &quot;tms&quot;: false,\n  &quot;opacity&quot;: 1,\n}\n\n            );\n        \n    \n            tile_layer_c99752973ac84b7941ee846fcef27e68.addTo(map_a26eabbe1a83bd64022fbca20c853cf0);\n        \n    \n            var layer_control_e17e273b4763687b4674382cbf46aeac_layers = {\n                base_layers : {\n                    &quot;EOxCloudless 2024&quot; : tile_layer_c99752973ac84b7941ee846fcef27e68,\n                },\n                overlays :  {\n                    &quot;xcube tiles&quot; : tile_layer_40e61b0b1ef261965f21a673d12e7044,\n                },\n            };\n            let layer_control_e17e273b4763687b4674382cbf46aeac = L.control.layers(\n                layer_control_e17e273b4763687b4674382cbf46aeac_layers.base_layers,\n                layer_control_e17e273b4763687b4674382cbf46aeac_layers.overlays,\n                {\n  &quot;position&quot;: &quot;topright&quot;,\n  &quot;collapsed&quot;: true,\n  &quot;autoZIndex&quot;: true,\n}\n            ).addTo(map_a26eabbe1a83bd64022fbca20c853cf0);\n\n        \n&lt;/script&gt;\n&lt;/html&gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>","content_type":"text/html"},"text/plain":{"content":"<folium.folium.Map at 0x7e80a46a3380>","content_type":"text/plain"}}}],"key":"kbXcUjOxng"}],"key":"gkArE9pnJr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 7. Create the legend for the provided layer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cl7FUnL1l7"}],"identifier":"step-7-create-the-legend-for-the-provided-layer","label":"Step 7. Create the legend for the provided layer","html_id":"step-7-create-the-legend-for-the-provided-layer","implicit":true,"key":"xPDLnnT3jH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When viewing geospatial datasets, especially those using color mapped imagery such as the SMOS ocean salinity layer, the colors themselves have no meaning without a reference.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vKX1FE8Jp5"}],"key":"HZPyqktjzr"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In our case, the SMOS layer visualization uses the jet colormap scaled from 0 to 50 as seen in the XYZ link from metadata, which corresponds to sea surface salinity in parts per 1000 (ppt).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NcI3rvhf2X"}],"key":"bIhsLa6DDW"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Including a legend ensures that viewers can correctly interpret the scientific meaning behind the visual patterns.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"h2HlepUO6t"}],"key":"NA6cDtmWe1"}],"key":"WWrw5mXKov"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\nimport matplotlib.pyplot as plt\n\nfig, ax = plt.subplots(figsize=(6, 1))\nfig.subplots_adjust(bottom=0.5)\n\n# Create a colorbar image from the \"jet\" colormap\ncmap = plt.get_cmap('jet')\nnorm = plt.Normalize(vmin=0, vmax=50)\n\ncb = plt.colorbar(\n    plt.cm.ScalarMappable(norm=norm, cmap=cmap),\n    cax=ax,\n    orientation='horizontal'\n)\n\ncb.set_label(\"Sea Surface Salinity (ppt)\")\nplt.show()","key":"hDBiuNGWbu"},{"type":"output","id":"TeqddR8xDNDp6xIxJyTLI","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6d736eb524cb2beb50d4992620081ae2","path":"/eodashboard-notebooks/build/6d736eb524cb2beb50d4992620081ae2.png"},"text/plain":{"content":"<Figure size 600x100 with 1 Axes>","content_type":"text/plain"}}}],"key":"zXt2EtXakL"}],"key":"qyTTOlsvoe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 8. Fetching and Plotting Time Series Statistics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G9Fm7XuKW7"}],"identifier":"step-8-fetching-and-plotting-time-series-statistics","label":"Step 8. Fetching and Plotting Time Series Statistics","html_id":"step-8-fetching-and-plotting-time-series-statistics","implicit":true,"key":"GeJbgx5FOz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this step, we access the statistics service linked from the indicator level STAC collection.\nWe sent a POST request with a specified geographic polygon to retrieve median values of the satellite data over time.\nThe response provides a time series which we then visualized using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z4v06c0nF9"},{"type":"inlineCode","value":"Matplotlib","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XVlKfW06Zi"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uIVRkxEYsP"}],"key":"ZPN4PnFPGE"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To ensure the date labels on the x-axis are readable and well-formatted, we converted the time strings to datetime objects and used Matplotlib’s date locators and formatters.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JoaQMM16dc"}],"key":"UPjcagJZxh"}],"key":"Nb5AEDjfsX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import requests\nimport json\nimport matplotlib.pyplot as plt\nfrom shapely.geometry import Polygon, mapping\nimport matplotlib.dates as mdates\nfrom datetime import datetime\n\n# Find the statistics link in the indicator-level STAC Collection\nstats_link = next(\n    link for link in indicator.links\n    if link.rel == \"service\" and link.media_type == \"application/json\"\n)\nprint(f\"Statistics link {stats_link.target}\")\n# Prepare the polygon geometry (example: small box in the Mediterranean sea south of France)\npolygon_geom = Polygon([\n    (4.35, 40.55),\n    (4.35, 42.35),\n    (7.2, 42.35),\n    (7.2, 40.55),\n    (4.35, 40.55)\n])\n\ngeometry_geojson = mapping(polygon_geom)\n\n# Load POST body template from linked JSON file and fill {{{geometry}}}\nbody_url = stats_link.extra_fields[\"body\"]\nbody_template_str = requests.get(body_url).text\n# Replace the placeholder with the actual JSON object text\nbody_filled_str = body_template_str.replace(\n    \"{{{polygon}}}\",\n    json.dumps(geometry_geojson)\n)\n\n# Now parse into a Python dict\nbody_filled = json.loads(body_filled_str)\n\n# Send the POST request\nresponse = requests.post(stats_link.target, json=body_filled)\nresponse.raise_for_status()\ndata = response.json()\n\n# Extract times and median values\ntimes = [entry[\"time\"] for entry in data[\"result\"]]\n# Convert to datetime\ntimes_dt = [datetime.fromisoformat(t.replace(\"Z\", \"+00:00\")) for t in times]\nmedians = [entry[\"median\"] for entry in data[\"result\"]]\n\n# Plot as a time series\nfig, ax = plt.subplots(figsize=(10, 5))\nax.plot(times_dt, medians, marker=\"o\")\n\nax.set_title(\"SMOS Ocean Salinity Median Values\")\nax.set_xlabel(\"Time\")\nax.set_ylabel(\"Median Value Salinity (ppt)\")\n\n# Format the x-axis dates\nax.xaxis.set_major_locator(mdates.MonthLocator(interval=1))  # one tick per month\nax.xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m'))\n\nplt.xticks(rotation=45, ha=\"right\")\nplt.tight_layout()\nplt.show()","key":"c9fh82qJXF"},{"type":"output","id":"9CQPXGP12eP6-rC0XZ-kp","data":[{"name":"stdout","output_type":"stream","text":"Statistics link https://api.earthsystemdatalab.net/api/timeseries/smos-os/SSS_corr?aggMethods=median\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"751002775fa2456776ee10981658b412","path":"/eodashboard-notebooks/build/751002775fa2456776ee10981658b412.png"},"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"}}}],"key":"nPPVJfafbu"}],"key":"wJ3rlKQQFw"}],"key":"SPv1D5dz3H"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Using the NASA VEDA EOAPI","url":"/notebooks/veda-api-bids-2023","group":"Notebooks"},"next":{"title":"Monitoring socio-economic activities with nighttime light maps","url":"/notebooks/nightlights-notebook/night-lights-blending","group":"Nightlights Notebook"}}},"domain":"http://localhost:3000"}