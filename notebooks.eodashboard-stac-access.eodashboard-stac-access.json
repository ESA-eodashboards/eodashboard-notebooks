{"version":2,"kind":"Notebook","sha256":"9c0825cf8c5b91c44b0a0a330540c4205b8041fd0071cfe98e7c84d7d89f0028","slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","location":"/notebooks/eodashboard_STAC_access/eodashboard_STAC_access.ipynb","dependencies":[],"frontmatter":{"title":"EODashboard STAC access examples","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"eodashboard-stac-conda-forge","language":"python"},"github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","subject":"Notebook examples","numbering":{"title":{"offset":2}},"edit_url":"https://github.com/ESA-eodashboards/eodashboard-notebooks/blob/main/notebooks/eodashboard_STAC_access/eodashboard_STAC_access.ipynb","exports":[{"format":"ipynb","filename":"eodashboard_STAC_access.ipynb","url":"/eodashboard-notebooks/build/eodashboard_STAC_acc-466754a1da1c9137b8c2e0362fcab121.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EODashboard STAC access examples","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lEQKQO3sQV"}],"identifier":"eodashboard-stac-access-examples","label":"EODashboard STAC access examples","html_id":"eodashboard-stac-access-examples","implicit":true,"key":"XcSj1IPCnp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"http://eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cmVV1dniMs"}],"urlSource":"http://eodashboard.org","key":"AKl9QL3huw"},{"type":"text","value":" uses a standard static STAC catalog","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IVqjmvIKLk"}],"key":"dL8qDMrHjn"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This example notebook outlines","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FM8D9xQmo9"}],"key":"snPpuUr6ht"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"accessing eodashboard STAC catalog","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"IGdr6biI4p"}],"key":"Z9Ztper6yr"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"discovery of the collections","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FlfBRTCADL"}],"key":"hRxCRsFIcj"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"checking individual metadata fields","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Ohy0JW338g"}],"key":"ySBd1wAwcC"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"browsing through items inside linked GeoParquet storage","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"FP3f3WW2Zt"}],"key":"ntp0IQ9C69"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"showing linked XYZ service on an interactive map for a single date","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"C15ljALiAB"}],"key":"yzW14fYbRP"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"time series analysis using referenced statistics endpoint","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JPN4vgQnpb"}],"key":"KFKcn1juGi"}],"key":"bmAWXH2gky"}],"key":"EXTExqC5aD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1: Accessing the EODashboard STAC Catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NpZFDtZXHn"}],"identifier":"step-1-accessing-the-eodashboard-stac-catalog","label":"Step 1: Accessing the EODashboard STAC Catalog","html_id":"step-1-accessing-the-eodashboard-stac-catalog","implicit":true,"key":"QDBbexMFRb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ux5JMAYaTi"},{"type":"link","url":"http://eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wPA78Q0lAC"}],"urlSource":"http://eodashboard.org","key":"Op1jCBEtzs"},{"type":"text","value":" platform provides a publicly accessible STAC catalog.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m76rLAiEvR"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hOck1yK7aX"},{"type":"text","value":"In this step, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zVLo0h2gYn"},{"type":"inlineCode","value":"pystac","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CAhNFrNwdA"},{"type":"text","value":" library to load the root catalog from the provided URL to explore provided collections.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i93amXQhdS"}],"key":"E7NkZqvNga"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This root catalog serves as the entry point and provides metadata and links to collections and subcatalogs.\nWe’ll inspect the catalog description, and check how many child collections are directly linked.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UnDvXZmQeP"}],"key":"DAbhlKeAgS"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Structure","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tp0Jf5VDSD"}],"identifier":"structure","label":"Structure","html_id":"structure","implicit":true,"key":"QmMU0viR1i"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"eodash organizes its data in a two-level STAC structure:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"d21dCiyXd6"}],"key":"AIuTgw6LiJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The top level consists of ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"n8ANiwLrH5"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"“indicators”","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FnKRxT8RHm"}],"key":"OGVH8F7Yt6"},{"type":"text","value":", represented as STAC ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"dqSGy95r5p"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"collections","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FpA2lOEpLd"}],"key":"zQsRbq3PXB"},{"type":"text","value":". Each indicator describes a derived environmental variable or theme (e.g. “SMOS Ocean Salinity”).","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HelThY4vZZ"}],"key":"okv2OGTLeo"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Each indicator then groups one or more ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yG2hJBcIBy"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"sub-collections","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KSlMod7IBI"}],"key":"vPtBDqHu07"},{"type":"text","value":", represented also as STAC ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"WeEivKDIQH"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"collections","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"hj8gwMNH78"}],"key":"GGInfcahH4"},{"type":"text","value":". They group the actual datasets contributing to the indicator and each subcollection is shown as separate layer in the eodash client interface.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"q1npRp9ZKP"}],"key":"pzxKv3qT3n"}],"key":"IAvBcb82Ak"}],"key":"F5W7pXp2Xm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Step 1: Access the EODashboard STAC Catalog via PySTAC\n\nfrom pystac import Catalog\n\n# URL to the root STAC catalog (adjust if necessary)\ncatalog_url = \"https://ESA-eodashboards.github.io/eodashboard-catalog/trilateral/catalog.json\"\n\n# Load the catalog\ncatalog = Catalog.from_file(catalog_url)\n\n# Print basic information\nprint(f\"Catalog ID: {catalog.id}\")\nprint(f\"Description: {catalog.description}\")\nindicators = list(catalog.get_children())\n\nprint(f\"Number of child indicators: {len(indicators)}\")","key":"rYT4sNFRd1"},{"type":"output","id":"P_-oceSGcm795h-mgD2q0","data":[{"name":"stdout","output_type":"stream","text":"Catalog ID: trilateral\nDescription: A Tri-Agency Dashboard by NASA, ESA, JAXA\nNumber of child indicators: 127\n"}],"key":"WlrwAMLe85"}],"key":"MmSDwbrKtN"},{"type":"block","kind":"notebook-content","children":[],"key":"n7Vi7Ow6ep"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2: Discovering and Filtering Indicators","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XyIafsIZNT"}],"identifier":"step-2-discovering-and-filtering-indicators","label":"Step 2: Discovering and Filtering Indicators","html_id":"step-2-discovering-and-filtering-indicators","implicit":true,"key":"bz8cV4UHD0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The STAC catalog contains over 100 indicators.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CZB1QIzVIK"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WUnv1Mqfuz"},{"type":"text","value":"In this step, we retrieve all indicators and filter them to include only those relevant to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hZ9V4sFkmW"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Soil Moisture and Ocean Salinity satellite (SMOS)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RqOe79EpZw"}],"key":"w7k2DXfeNL"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Svx8Hs1AQk"}],"key":"gAorJ0LyJO"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We look for the keyword “SMOS” in the collection’s ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TkOjVoiszS"},{"type":"inlineCode","value":"satellite","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"i2QVTSHWc7"},{"type":"text","value":" metadata field.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CiypZHzj03"},{"type":"break","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"koO6NlI4Hb"},{"type":"text","value":"This helps us isolate datasets derived from or related to ESA’s SMOS mission.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TSkElC55iE"}],"key":"CwzmT33HNr"}],"key":"bZlVCFEKEW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Step 2: Filter indicators related to SMOS\n\n# Filter indicators that mention 'SMOS' in satellite property\nsmos_indicators = [\n    ind for ind in indicators\n    if \"satellite\" in ind.extra_fields and \"SMOS\" in [s.upper() for s in ind.extra_fields[\"satellite\"]]\n]\n\n# Show results\nprint(f\"Found {len(smos_indicators)} SMOS-related collections (strict filter):\")\nfor ind in smos_indicators:\n    print(f\"{ind.id}: {ind.title}\")","key":"gRMvEoL0du"},{"type":"output","id":"uREzeUTXLDeeDpb6xDABJ","data":[{"name":"stdout","output_type":"stream","text":"Found 14 SMOS-related collections (strict filter):\nRECCAP2_1_AGC_LVOD_amazonia_methods_mean_crop: Methods mean aboveground carbon (CCI RECCAP2)\nRECCAP2_2_AGC_LVOD_amazonia_smooth_max_crop: Smooth max aboveground carbon (CCI RECCAP2)\nRECCAP2_3_AGC_LVOD_amazonia_smooth_mean_crop: Smooth mean aboveground carbon (CCI RECCAP2)\nRECCAP2_4_AGC_LVOD_amazonia_trend_mean_crop: Trend mean aboveground carbon (CCI RECCAP2)\nRECCAP2_5_SF_biomass_growth: Secondary forest growth (CCI RECCAP2)\nRECCAP2_6_deforested_biomass: Deforestation (CCI RECCAP2)\nRECCAP2_7_degraded_biomass: Degradation (CCI RECCAP2)\nRECCAP2_8_edge_biomass_change: Edge biomass change (CCI RECCAP2)\nRECCAP2_9_intact_biomass_change_methods_mean: Methods mean intact biomass change (CCI RECCAP2)\nRECCAP2_10_intact_biomass_change_smooth_max: Smooth max intact biomass change (CCI RECCAP2)\nRECCAP2_11_intact_biomass_change_smooth_mean: Smooth mean intact biomass change (CCI RECCAP2)\nRECCAP2_12_intact_biomass_change_trend_mean: Mean intact biomass change trend (CCI RECCAP2)\nsmos_ocean_salinity: SMOS Ocean Salinity\nsmos_soil_moisture: SMOS Soil Moisture\n"}],"key":"E72jM5KFAj"}],"key":"Nuo6RI6u7U"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3: Checking Individual Metadata Fields","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mhGPiilN4V"}],"identifier":"step-3-checking-individual-metadata-fields","label":"Step 3: Checking Individual Metadata Fields","html_id":"step-3-checking-individual-metadata-fields","implicit":true,"key":"sz0hJTszFN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Now that we’ve identified SMOS-related indicators, we’ll examine one specific indicator in detail:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vBjIyR5YLr"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LK95mUOXLS"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"smos_ocean_salinity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LNPX9mvV0D"}],"key":"XFiP3bADsk"},{"type":"text","value":", which shows the sea surface salinity globally acquired by the SMOS mission.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y4jePCETsG"}],"key":"ZqBJECwAZt"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We’ll print out the main metadata fields, including:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eI9gY047vE"}],"key":"UlzBKjyXIf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Basic identification (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vSzIoyfJiS"},{"type":"inlineCode","value":"title","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yvxO4OEEB3"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NGlUR1Jnb9"},{"type":"inlineCode","value":"description","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ukZI3RQcqJ"},{"type":"text","value":")","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JUrV5rMXS4"}],"key":"HWb6R4pCcd"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Spatial and temporal extent","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"dZimpV1uzn"}],"key":"E1qJyxs03f"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Licensing and providers","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"q0fwoLP6oS"}],"key":"v5hNR4qZwY"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Custom fields such as ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vDOmVUylvg"},{"type":"inlineCode","value":"satellite","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"K3uZXNfqrx"},{"type":"text","value":", ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"efL4CjGveU"},{"type":"inlineCode","value":"region","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DFv4JNqwYE"},{"type":"text","value":", and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"yOUAzxDIh6"},{"type":"inlineCode","value":"data_source","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HGmXawaFPA"},{"type":"text","value":" if available","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"EtXB1Ex0T1"}],"key":"V0B7wxYSqa"}],"key":"wtekjyAtnS"}],"key":"FxmujBVd5i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"indicator = next(ind for ind in indicators if ind.id == \"smos_ocean_salinity\") \n# Print basic metadata\nprint(f\"Title: {indicator.title}\")\nprint(f\"License: {indicator.license}\")\nprint(f\"Temporal Extent: {indicator.extent.temporal.to_dict()}\")\nprint(f\"Spatial Extent (bbox): {indicator.extent.spatial.bboxes}\")\nprint(\"-----------------------------------------------\")\nprint(f\"Description: {indicator.description}\")","key":"iBi2Lnp57m"},{"type":"output","id":"Y-yQ6ft9OgmvhBxu524JJ","data":[{"name":"stdout","output_type":"stream","text":"Title: SMOS Ocean Salinity\nLicense: other\nTemporal Extent: {'interval': [['2023-01-04T00:00:00Z', '2023-12-27T00:00:00Z']]}\nSpatial Extent (bbox): [[-180.0, -88.59375, 180.0, 88.59375], [-180.0, -88.59375, 180.0, 88.59375]]\n-----------------------------------------------\nDescription: ## Ocean Salinity\n\nThis indicator shows the sea surface salinity globally acquired by the ESA Earth Explorer [Soil Moisture and Ocean Salinity (SMOS) mission](https://earth.esa.int/eogateway/missions/smos/description). Ocean currents are driven by temperature and salinity variations in the seawater and Understanding ocean salinity's annual and inter-annual variability are crucial in understanding the role of the ocean in the climate system. Ocean circulation is mainly driven by the water and heat flux through the atmosphere-ocean interface, but salinity is also fundamental in determining ocean density and hence thermohaline circulation. \n\nThis dataset is provided by the **Euro Data Cube**'s [SMOS Level-2C Datacube Service](https://collections.eurodatacube.com/smos-datacube/readme.html) offered by Brockmann Consult. The SMOS data cube service is implemented using the [xcube-smos datastore](https://github.com/xcube-dev/xcube-smos), which is available with the permissive MIT license.   \n\n### Dataset description\n-  Data is acquired by the sensor onboard SMOS, the [Microwave Imaging Radiometer with Aperture Synthesis (MIRAS)](https://earth.esa.int/eogateway/instruments/miras). MIRAS creates images of radiation emitted in the microwave L-band (1.4 GHz), by measuring changes in the salinity of seawater by observing variations in the natural microwave emission coming up off the surface of the ocean.\n-  The Level 2 Ocean Salinity (OS) product comprises sea surface salinity measurements geo-located in an equal-area (grid system ISEA 4H9).\n-  Spatial resolution: ~40 km (varies due to the SMOS interferometric imaging technique)\n\n### Applications\nOcean salinity can be used for various applications, including ocean circulation, climate monitoring and water management.\n\n### Read more\n\n* [SMOS L1 and L2 Science data](https://earth.esa.int/eogateway/catalog/smos-science-products)\n* [SMOS Datacube Service - Euro Data Cube](https://collections.eurodatacube.com/smos-datacube/)\n* [xcube SMOS Python Package](https://xcube-dev.github.io/xcube-smos/)\n* [Notebooks for xcube SMOS store](https://github.com/xcube-dev/xcube-smos/tree/main/notebooks)\n\n"}],"key":"K3Ex46UDFD"}],"key":"QSKGcnVOKL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4: Navigating the Indicator and Dataset Hierarchy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lnh770VMt1"}],"identifier":"step-4-navigating-the-indicator-and-dataset-hierarchy","label":"Step 4: Navigating the Indicator and Dataset Hierarchy","html_id":"step-4-navigating-the-indicator-and-dataset-hierarchy","implicit":true,"key":"pAJuBAlUjW"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"So far, we’ve explored the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zvwMgq7cOU"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"indicator STAC Collection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bloNumbpU5"}],"key":"yrZtpKvPoc"},{"type":"text","value":" ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qi1s0ixN5j"},{"type":"inlineCode","value":"smos_ocean_salinity","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VP7pbIhga8"},{"type":"text","value":" as explained in the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kR6rDmZynZ"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Step 1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rRgDE7XJrE"}],"key":"gbWh3rQK2p"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"cC1sQgvBq7"}],"key":"jckrihyxQ1"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To access the actual data items on a ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"woZcWLziV5"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"subcollection STAC Collection","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ORGwacMl58"}],"key":"vmU88KJurN"},{"type":"text","value":" we now need to look at its ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GvDmCqWFS8"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"child collections","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"z7x8jc0ppg"}],"key":"TllWMFg7fY"},{"type":"text","value":", which contain the STAC Items and assets.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AD5aLLFroh"}],"key":"T6H97FoKJ8"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"In this step, we identify and load those child collections so we can continue our exploration at the data level.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Jp6lG1TwS9"}],"key":"kkPnBvdqZW"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"In our case, the indicator has just one collection - itself so it looks easy.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RsW179feuL"}],"key":"hFrkBfPkiM"}],"key":"VLs1p830l0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get child links that are STAC collections\nchild_collections = []\nfor link in indicator.get_links(\"child\"):\n    if link.rel == \"child\":\n        child_collection = link.resolve_stac_object().target\n        child_collections.append(child_collection)\n\n# Show child collection IDs and titles\nprint(f\"{len(child_collections)} child collections found under 'smos_ocean_salinity':\")\nfor col in child_collections:\n    print(f\"- {col.id}: {col.title}\")","key":"YEqHsF168J"},{"type":"output","id":"1OQuldlwTzQWWOWbWnfAS","data":[{"name":"stdout","output_type":"stream","text":"1 child collections found under 'smos_ocean_salinity':\n- smos_ocean_salinity: SMOS Ocean Salinity\n"}],"key":"LpkYypyeNt"}],"key":"eBWn8mXR9n"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 5: Accessing and Browsing STAC Items via GeoParquet","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D5Dj76sD7S"}],"identifier":"step-5-accessing-and-browsing-stac-items-via-geoparquet","label":"Step 5: Accessing and Browsing STAC Items via GeoParquet","html_id":"step-5-accessing-and-browsing-stac-items-via-geoparquet","implicit":true,"key":"OX6O3W79bs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In eodashboard, each child collection under an indicator may reference a bulk listing of STAC Items using a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uo35rXoSZr"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"GeoParquet","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q9rLDhFYEN"}],"key":"j4exsuKx23"},{"type":"text","value":" file for performance reasons during the catalog creation.\nThis file acts as a storage for the STAC Items associated with that dataset and can be efficiently read and queried.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tT1Jo3Tztr"}],"key":"zDCHtrNLtQ"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We identify this asset by checking for an ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Mt0lOxydbt"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Asset","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tsuUK6SNPM"}],"key":"sh4j9FWzBr"},{"type":"text","value":" with a ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xdJ712uE9p"},{"type":"inlineCode","value":"roles","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Sm3twzg6CL"},{"type":"text","value":" array containing ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"o24EW6mWNp"},{"type":"inlineCode","value":"\"collection-mirror\"","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EttzLQTLMP"},{"type":"text","value":" which is eodash specific way of distinction of the GeoParquet.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HukJ07yTrN"}],"key":"IJ1CkbLhwr"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Once found, we load it and use ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CooTDiPsPZ"},{"type":"inlineCode","value":"pyarrow.parquet","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EiY5wAzOfM"},{"type":"text","value":" to load the GeoParquet file and ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"haUMT4Ig1D"},{"type":"inlineCode","value":"stac_geoparquet","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MnIJMhAhpb"},{"type":"text","value":" to convert it back to STAC Item structure and display their contents.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ck4iS3VPHx"}],"key":"b69HSrAumQ"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This enables fast, local-style exploration of all STAC items in the dataset, including geometry, timestamp, and links to assets like XYZ tiles or statistics endpoints.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"PX2UrIRRPE"}],"key":"b1Z1EbmjYE"}],"key":"YXTvZlYaCZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import requests\nimport pyarrow.parquet as pq\nimport io\nimport stac_geoparquet\n\ngeoparquet_asset = None\nfor key, asset in child_collection.assets.items():\n    # specific way how eodash labels the asset with a geoparquet of items\n    if \"collection-mirror\" in asset.roles:\n        geoparquet_asset = asset\n        break\n\nif geoparquet_asset is None:\n    raise ValueError(\"No asset with role 'collection-mirror' found in the child collection.\")\n# eodash catalog links the asset href with relative path, we need to get absolute to retrieve it\nparquet_url = geoparquet_asset.get_absolute_href()\nprint(f\"Reading remote GeoParquet from: {parquet_url}\")\n\nresponse = requests.get(parquet_url)\nif response.status_code != 200:\n    print(f\"Failed to download parquet file from {parquet_url}\")\n# Read the table with pyarrow\ntable = pq.read_table(io.BytesIO(response.content))\n\n# Convert to a list of STAC dictionaries\nitems = list(stac_geoparquet.arrow.stac_table_to_items(table))\nprint(f\"In total {len(items)} items were retrieved.\")\nprint(f\"Submission {len(items)} items were retrieved.\")\n# show example of metadata of one item\nitem = items[0]\nprint(\"-------------------------------------\")\nprint(f\"Datetime: {item['properties'].get('datetime')}\")\nprint(f\"BBox: {item['bbox']}\")\nprint(f\"Number of service links: {len(item['links'])}\")\n","key":"ergyeb6vRH"},{"type":"output","id":"D8_duwu8XqX63hB2UxekS","data":[{"name":"stdout","output_type":"stream","text":"Reading remote GeoParquet from: https://ESA-eodashboards.github.io/eodashboard-catalog/trilateral/smos_ocean_salinity/smos_ocean_salinity/items.parquet\nIn total 52 items were retrieved.\nSubmission 52 items were retrieved.\n-------------------------------------\nDatetime: 2023-01-04T00:00:00.000000Z\nBBox: [-180.0, -88.59375, 180.0, 88.59375]\nNumber of service links: 1\n"}],"key":"MEr2reTCqZ"}],"key":"nHv1Tsc0U3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 6. Visualize Linked XYZ Tile Layer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LrkzF5bIuS"}],"identifier":"step-6-visualize-linked-xyz-tile-layer","label":"Step 6. Visualize Linked XYZ Tile Layer","html_id":"step-6-visualize-linked-xyz-tile-layer","implicit":true,"key":"iw8iDdfehO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For each item, eodash links the suggested rendering of the visualization layer, which we can display using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fSkA6vveom"},{"type":"inlineCode","value":"folium","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y4IIPsw6FV"},{"type":"text","value":" on the map.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pB6spt3q9S"}],"key":"mHhy2QrOcO"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We selected the first Item containing data for 1.4.2023 and add the tile layer with a eox cloudless background..","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"W8hQwi9qjm"}],"key":"AEvxwUZUBI"}],"key":"bhOHG61JkQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import folium\n\n# Find the xyz tile link for 1.4.2023\nxyz_link = next((l for l in item[\"links\"] if l[\"rel\"] == \"xyz\"), None)\nprint(f\"Actual link is {xyz_link}\")\nm = folium.Map(location=[45, 10], zoom_start=4, tiles=None)\nif xyz_link:\n    folium.TileLayer(\n        tiles=xyz_link[\"href\"],\n        attr='Rendering of SMOS datacube provided by xcube-server operated by Brockmann Consult GmbH',\n        name=xyz_link.get(\"title\", \"Tile Layer\"),\n        overlay=True,\n        control=True\n    ).add_to(m)\n\n# Add EOxCloudless layer\nfolium.TileLayer(\n    tiles=\"https://tiles.maps.eox.at/wmts/1.0.0/s2cloudless-2024_3857/default/GoogleMapsCompatible/{z}/{y}/{x}.jpg\",\n    attr='<a href=\"https://maps.eox.at\">Overlay</a> { Data &copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Rendering &copy; <a href=\"https://eox.at\">EOX</a> and <a href=\"https://github.com/mapserver/basemaps\">MapServer</a> }',\n    name=\"EOxCloudless 2024\",\n    overlay=False,\n    control=True\n).add_to(m)\n\nfolium.LayerControl().add_to(m)\nm","key":"nXECZQqzzg"},{"type":"output","id":"q2ra9_Jp_xEKSbnFc2QP2","data":[{"name":"stdout","output_type":"stream","text":"Actual link is {'href': 'https://api.earthsystemdatalab.net/api/tiles/smos-os/SSS_corr/{z}/{y}/{x}?crs=EPSG:3857&time=2023-01-04T00:00:00Z&vmin=0&vmax=50&cbar=jet', 'rel': 'xyz', 'title': 'xcube tiles', 'type': 'image/png'}\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc=\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    \n    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;\n    \n            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;\n            &lt;style&gt;\n                #map_a26eabbe1a83bd64022fbca20c853cf0 {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            &lt;/style&gt;\n\n            &lt;style&gt;html, body {\n                width: 100%;\n                height: 100%;\n                margin: 0;\n                padding: 0;\n            }\n            &lt;/style&gt;\n\n            &lt;style&gt;#map {\n                position:absolute;\n                top:0;\n                bottom:0;\n                right:0;\n                left:0;\n                }\n            &lt;/style&gt;\n\n            &lt;script&gt;\n                L_NO_TOUCH = false;\n                L_DISABLE_3D = false;\n            &lt;/script&gt;\n\n        \n&lt;/head&gt;\n&lt;body&gt;\n    \n    \n            &lt;div class=&quot;folium-map&quot; id=&quot;map_a26eabbe1a83bd64022fbca20c853cf0&quot; &gt;&lt;/div&gt;\n        \n&lt;/body&gt;\n&lt;script&gt;\n    \n    \n            var map_a26eabbe1a83bd64022fbca20c853cf0 = L.map(\n                &quot;map_a26eabbe1a83bd64022fbca20c853cf0&quot;,\n                {\n                    center: [45.0, 10.0],\n                    crs: L.CRS.EPSG3857,\n                    ...{\n  &quot;zoom&quot;: 4,\n  &quot;zoomControl&quot;: true,\n  &quot;preferCanvas&quot;: false,\n}\n\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_40e61b0b1ef261965f21a673d12e7044 = L.tileLayer(\n                &quot;https://api.earthsystemdatalab.net/api/tiles/smos-os/SSS_corr/{z}/{y}/{x}?crs=EPSG:3857\\u0026time=2023-01-04T00:00:00Z\\u0026vmin=0\\u0026vmax=50\\u0026cbar=jet&quot;,\n                {\n  &quot;minZoom&quot;: 0,\n  &quot;maxZoom&quot;: 18,\n  &quot;maxNativeZoom&quot;: 18,\n  &quot;noWrap&quot;: false,\n  &quot;attribution&quot;: &quot;Rendering of SMOS datacube provided by xcube-server operated by Brockmann Consult GmbH&quot;,\n  &quot;subdomains&quot;: &quot;abc&quot;,\n  &quot;detectRetina&quot;: false,\n  &quot;tms&quot;: false,\n  &quot;opacity&quot;: 1,\n}\n\n            );\n        \n    \n            tile_layer_40e61b0b1ef261965f21a673d12e7044.addTo(map_a26eabbe1a83bd64022fbca20c853cf0);\n        \n    \n            var tile_layer_c99752973ac84b7941ee846fcef27e68 = L.tileLayer(\n                &quot;https://tiles.maps.eox.at/wmts/1.0.0/s2cloudless-2024_3857/default/GoogleMapsCompatible/{z}/{y}/{x}.jpg&quot;,\n                {\n  &quot;minZoom&quot;: 0,\n  &quot;maxZoom&quot;: 18,\n  &quot;maxNativeZoom&quot;: 18,\n  &quot;noWrap&quot;: false,\n  &quot;attribution&quot;: &quot;\\u003ca href=\\&quot;https://maps.eox.at\\&quot;\\u003eOverlay\\u003c/a\\u003e { Data \\u0026copy; \\u003ca href=\\&quot;http://www.openstreetmap.org/copyright\\&quot;\\u003eOpenStreetMap\\u003c/a\\u003e contributors, Rendering \\u0026copy; \\u003ca href=\\&quot;https://eox.at\\&quot;\\u003eEOX\\u003c/a\\u003e and \\u003ca href=\\&quot;https://github.com/mapserver/basemaps\\&quot;\\u003eMapServer\\u003c/a\\u003e }&quot;,\n  &quot;subdomains&quot;: &quot;abc&quot;,\n  &quot;detectRetina&quot;: false,\n  &quot;tms&quot;: false,\n  &quot;opacity&quot;: 1,\n}\n\n            );\n        \n    \n            tile_layer_c99752973ac84b7941ee846fcef27e68.addTo(map_a26eabbe1a83bd64022fbca20c853cf0);\n        \n    \n            var layer_control_e17e273b4763687b4674382cbf46aeac_layers = {\n                base_layers : {\n                    &quot;EOxCloudless 2024&quot; : tile_layer_c99752973ac84b7941ee846fcef27e68,\n                },\n                overlays :  {\n                    &quot;xcube tiles&quot; : tile_layer_40e61b0b1ef261965f21a673d12e7044,\n                },\n            };\n            let layer_control_e17e273b4763687b4674382cbf46aeac = L.control.layers(\n                layer_control_e17e273b4763687b4674382cbf46aeac_layers.base_layers,\n                layer_control_e17e273b4763687b4674382cbf46aeac_layers.overlays,\n                {\n  &quot;position&quot;: &quot;topright&quot;,\n  &quot;collapsed&quot;: true,\n  &quot;autoZIndex&quot;: true,\n}\n            ).addTo(map_a26eabbe1a83bd64022fbca20c853cf0);\n\n        \n&lt;/script&gt;\n&lt;/html&gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>","content_type":"text/html"},"text/plain":{"content":"<folium.folium.Map at 0x7e80a46a3380>","content_type":"text/plain"}}}],"key":"ErCMCcA5L5"}],"key":"kXzK0nbqrX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 7. Create the legend for the provided layer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BhZ1RktH5o"}],"identifier":"step-7-create-the-legend-for-the-provided-layer","label":"Step 7. Create the legend for the provided layer","html_id":"step-7-create-the-legend-for-the-provided-layer","implicit":true,"key":"CB7IeEXSHf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When viewing geospatial datasets, especially those using color mapped imagery such as the SMOS ocean salinity layer, the colors themselves have no meaning without a reference.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SbwlHPrS9t"}],"key":"PYmGCn9o5y"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In our case, the SMOS layer visualization uses the jet colormap scaled from 0 to 50 as seen in the XYZ link from metadata, which corresponds to sea surface salinity in parts per 1000 (ppt).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"z2tmINClzt"}],"key":"jNEncAHdM6"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Including a legend ensures that viewers can correctly interpret the scientific meaning behind the visual patterns.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E25fMOyXsb"}],"key":"rz4tIVNFwa"}],"key":"kaH89k7sCt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\nimport matplotlib.pyplot as plt\n\nfig, ax = plt.subplots(figsize=(6, 1))\nfig.subplots_adjust(bottom=0.5)\n\n# Create a colorbar image from the \"jet\" colormap\ncmap = plt.get_cmap('jet')\nnorm = plt.Normalize(vmin=0, vmax=50)\n\ncb = plt.colorbar(\n    plt.cm.ScalarMappable(norm=norm, cmap=cmap),\n    cax=ax,\n    orientation='horizontal'\n)\n\ncb.set_label(\"Sea Surface Salinity (ppt)\")\nplt.show()","key":"ltugwUeNUb"},{"type":"output","id":"CGbm9sst5mghSnUfwlyJF","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6d736eb524cb2beb50d4992620081ae2","path":"/eodashboard-notebooks/build/6d736eb524cb2beb50d4992620081ae2.png"},"text/plain":{"content":"<Figure size 600x100 with 1 Axes>","content_type":"text/plain"}}}],"key":"ni7xtatjoM"}],"key":"VUdB5Bm562"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 8. Fetching and Plotting Time Series Statistics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XJfemA6xKz"}],"identifier":"step-8-fetching-and-plotting-time-series-statistics","label":"Step 8. Fetching and Plotting Time Series Statistics","html_id":"step-8-fetching-and-plotting-time-series-statistics","implicit":true,"key":"OaIFvJXxrT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this step, we access the statistics service linked from the indicator level STAC collection.\nWe sent a POST request with a specified geographic polygon to retrieve median values of the satellite data over time.\nThe response provides a time series which we then visualized using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IDiSdx3CFc"},{"type":"inlineCode","value":"Matplotlib","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a6hetNALFC"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WWZj9LPVrB"}],"key":"WMEE2RkRK0"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To ensure the date labels on the x-axis are readable and well-formatted, we converted the time strings to datetime objects and used Matplotlib’s date locators and formatters.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"q3JjJWxflg"}],"key":"T2IXE8jys9"}],"key":"xQXq1ucak3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import requests\nimport json\nimport matplotlib.pyplot as plt\nfrom shapely.geometry import Polygon, mapping\nimport matplotlib.dates as mdates\nfrom datetime import datetime\n\n# Find the statistics link in the indicator-level STAC Collection\nstats_link = next(\n    link for link in indicator.links\n    if link.rel == \"service\" and link.media_type == \"application/json\"\n)\nprint(f\"Statistics link {stats_link.target}\")\n# Prepare the polygon geometry (example: small box in the Mediterranean sea south of France)\npolygon_geom = Polygon([\n    (4.35, 40.55),\n    (4.35, 42.35),\n    (7.2, 42.35),\n    (7.2, 40.55),\n    (4.35, 40.55)\n])\n\ngeometry_geojson = mapping(polygon_geom)\n\n# Load POST body template from linked JSON file and fill {{{geometry}}}\nbody_url = stats_link.extra_fields[\"body\"]\nbody_template_str = requests.get(body_url).text\n# Replace the placeholder with the actual JSON object text\nbody_filled_str = body_template_str.replace(\n    \"{{{polygon}}}\",\n    json.dumps(geometry_geojson)\n)\n\n# Now parse into a Python dict\nbody_filled = json.loads(body_filled_str)\n\n# Send the POST request\nresponse = requests.post(stats_link.target, json=body_filled)\nresponse.raise_for_status()\ndata = response.json()\n\n# Extract times and median values\ntimes = [entry[\"time\"] for entry in data[\"result\"]]\n# Convert to datetime\ntimes_dt = [datetime.fromisoformat(t.replace(\"Z\", \"+00:00\")) for t in times]\nmedians = [entry[\"median\"] for entry in data[\"result\"]]\n\n# Plot as a time series\nfig, ax = plt.subplots(figsize=(10, 5))\nax.plot(times_dt, medians, marker=\"o\")\n\nax.set_title(\"SMOS Ocean Salinity Median Values\")\nax.set_xlabel(\"Time\")\nax.set_ylabel(\"Median Value Salinity (ppt)\")\n\n# Format the x-axis dates\nax.xaxis.set_major_locator(mdates.MonthLocator(interval=1))  # one tick per month\nax.xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m'))\n\nplt.xticks(rotation=45, ha=\"right\")\nplt.tight_layout()\nplt.show()","key":"NFmBoEE1qD"},{"type":"output","id":"ruU3jPm43fJMJKw0oNHLm","data":[{"name":"stdout","output_type":"stream","text":"Statistics link https://api.earthsystemdatalab.net/api/timeseries/smos-os/SSS_corr?aggMethods=median\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"751002775fa2456776ee10981658b412","path":"/eodashboard-notebooks/build/751002775fa2456776ee10981658b412.png"},"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"}}}],"key":"KPHrkxrGSa"}],"key":"LRWFNS9QLV"}],"key":"r99lct2vzv"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Using the NASA VEDA EOAPI","url":"/notebooks/veda-api-bids-2023","group":"Notebooks"},"next":{"title":"Monitoring socio-economic activities with nighttime light maps","url":"/notebooks/nightlights-notebook/night-lights-blending","group":"Nightlights Notebook"}}},"domain":"http://localhost:3000"}