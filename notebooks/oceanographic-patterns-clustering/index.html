<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>K-means clustering analysis of oceanographic patterns in the Mediterranean Sea - EO Dashboard Notebooks</title><meta property="og:title" content="K-means clustering analysis of oceanographic patterns in the Mediterranean Sea - EO Dashboard Notebooks"/><meta name="generator" content="mystmd"/><meta name="description" content="Collection of examples relevant to the EO Dashboard project"/><meta property="og:description" content="Collection of examples relevant to the EO Dashboard project"/><meta name="keywords" content=""/><meta name="image" content="/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg"/><meta property="og:image" content="/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg"/><link rel="stylesheet" href="/eodashboard-notebooks/build/_assets/app-2K3KGISG.css"/><link rel="stylesheet" href="/eodashboard-notebooks/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/eodashboard-notebooks/favicon.ico"/><link rel="stylesheet" href="/eodashboard-notebooks/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100%;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-full top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block lg:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/eodashboard-notebooks/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 dark:text-gray-300 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-full xl:pointer-events-none overflow-auto max-xl:w-[75vw] max-xl:max-w-[350px] max-xl:!top-0 max-xl:h-screen lg:hidden hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden max-xl:h-full hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity lg:hidden ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white font-medium"></div></nav></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="myst-fm-block-subject flex-none pr-2 smallcaps">Notebook examples</div><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/ESA-eodashboards/eodashboard-notebooks" title="GitHub Repository: ESA-eodashboards/eodashboard-notebooks" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/ESA-eodashboards/eodashboard-notebooks/edit/main/notebooks/Oceanographic patterns clustering.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">K-means clustering analysis of oceanographic patterns in the Mediterranean Sea</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="pEZylh45Ep" class="myst-jp-nb-block relative group/block"><img id="eqDsnkVX5I" style="margin-left:auto;margin-right:auto" src="/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg" alt="Sept-2025-Venice-Edinburgh-Leeds.jpg" data-canonical-url="data:image/jpeg;base64,/9j/4AAQSk...KKAP/2Q==
" class=""/></div><div id="DTl0bjL6kv" class="myst-jp-nb-block relative group/block"><p><strong>Note</strong><br/>
This notebook has been developed and validated on the <a target="_blank" rel="noreferrer" href="https://deepesdl.readthedocs.io/en/latest/" class="link whitespace-nowrap"><span class="link-text whitespace-normal"><strong>DeepESDL</strong></span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> environment, where the necessary data, tools, and execution kernels are available. <em>DeepESDL</em> is part of ESA’s <a target="_blank" rel="noreferrer" href="https://earthcode.esa.int" class="link whitespace-nowrap"><span class="link-text whitespace-normal"><strong>EarthCODE</strong> initiative</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, enabling open and reproducible Earth Science. Sponsored access can be requested through ESA’s <a target="_blank" rel="noreferrer" href="https://nor-discover.org/" class="link whitespace-nowrap"><span class="link-text whitespace-normal"><strong>Network of Resources</strong></span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.</p></div><div id="BeqvGY2uSn" class="myst-jp-nb-block relative group/block"><h2 id="table-of-contents" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Table of Contents</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#table-of-contents" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ol start="1"><li><p><span data-state="closed"><a href="#title" class="hover-link">Title</a></span></p></li><li><p><span data-state="closed"><a href="#description" class="hover-link">Description</a></span></p></li><li><p><span data-state="closed"><a href="#references" class="hover-link">References</a></span></p></li><li><p><a class="link" href="/eodashboard-notebooks#conclusions">Key Conclusions</a></p></li><li><p><a class="link" href="/eodashboard-notebooks#context">Societal Context</a></p></li><li><p><a class="link" href="/eodashboard-notebooks#libraries">Python Libraries</a></p></li><li><p><a class="link" href="/eodashboard-notebooks#inputs">Data Sources</a></p><ol start="1"><li><p><a class="link" href="/eodashboard-notebooks#combo">Combining input data</a></p></li><li><p><a class="link" href="/eodashboard-notebooks#visuals">Visualizing input data</a></p></li></ol></li><li><p><span data-state="closed"><a href="#analysis" class="hover-link">Analysis</a></span></p><ol start="1"><li><p><a class="link" href="/eodashboard-notebooks#utility">Utility functions</a></p></li><li><p><a class="link" href="/eodashboard-notebooks#kmeans">K-means implementation</a></p></li><li><p><a class="link" href="/eodashboard-notebooks#monthly">Monthly clustering</a></p></li><li><p><a class="link" href="/eodashboard-notebooks#seasonal">Seasonal clustering</a></p></li></ol></li></ol></div><div id="MwgobFpXMR" class="myst-jp-nb-block relative group/block"><h2 id="title" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Title</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#title" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="challenge-k-means-clustering-analysis-of-oceanographic-patterns-in-the-mediterranean-sea" class="relative group"><span class="heading-text">Challenge: <em>K-means clustering analysis of oceanographic patterns in the Mediterranean Sea</em></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#challenge-k-means-clustering-analysis-of-oceanographic-patterns-in-the-mediterranean-sea" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Authors:</strong></p><ul><li><p><strong>Katie Lowery</strong>, British Antarctic Survey (BAS), Cambridge, United Kingdom of Great Britain</p></li><li><p><strong>William Luty</strong> , University of Leeds, Leeds, United Kingdom of Great Britain - England, Scotland, Wales</p></li><li><p><strong>Enrico Biscaro</strong>, Ca’ Foscari University of Venice, Italy <br/></p></li></ul><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="vwLJzXX94H" class="myst-jp-nb-block relative group/block"><h2 id="description" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Description</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#description" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="scientific-problem" class="relative group"><span class="heading-text">Scientific problem</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#scientific-problem" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Ocean water types - such as coastal, upwelling, oligotrophic, and eutrophic  waters - exhibit distinct spectral and biogeochemical characteristics. Classifying  these types is essential for understanding marine ecosystems, monitoring water  quality, and supporting climate and fisheries research. This challenge leverages <em>EO data</em> and <em>unsupervised learning</em> to classify ocean water types based on spectral reflectance and derived indices.</p><h3 id="objective" class="relative group"><span class="heading-text">Objective</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#objective" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Use <strong>clustering algorithms</strong> to classify ocean water types from EO spectral  bands and indices. Validate clusters against known oceanographic features or water classifications and produce a map of water types for a selected region.</p><h3 id="method" class="relative group"><span class="heading-text">Method</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#method" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>K-means clustering.</p><h4 id="clustering-optimization-technique" class="relative group"><span class="heading-text">Clustering optimization technique</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#clustering-optimization-technique" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li><p>Elbow method: to determine the optimal number of clusters to use.</p></li><li><p>Optimization metric: Inertia (Sum of Squared Errors)</p></li></ul><h3 id="service-used" class="relative group"><span class="heading-text">Service used</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#service-used" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><a target="_blank" rel="noreferrer" href="https://marine.copernicus.eu/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">Copernicus Marine Service</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.</p><h3 id="use-case-mediterranean-sea" class="relative group"><span class="heading-text">Use case: Mediterranean Sea</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-case-mediterranean-sea" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li><p>Optimizing fish harvesting while preserving fish populations and  marine biodiversity in the Mediterranean</p></li><li><p>Monitoring physico-chemical parameters of the Mediterranean Sea in a climate change scenario also considering its contribution to the Atlantic Meridional Overturning Circulation (AMOC)</p></li></ul><img id="ezLWNhOH3Z" style="margin-left:auto;margin-right:auto" src="/eodashboard-notebooks/build/5eae0210320dbf26b5e6545ec68c0514.jpeg" alt="Clustering_use-case.JPG" data-canonical-url="data:image/jpeg;base64,/9j/4AAQSk...AooooA/9k=" class=""/><h3 id="processing-workflow" class="relative group"><span class="heading-text">Processing workflow</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#processing-workflow" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><img id="Cv2z7h6CAl" style="margin-left:auto;margin-right:auto" src="/eodashboard-notebooks/build/f46649713c7cc868512dd6ec1895727f.jpeg" alt="kmeans-clustering_cmems.JPG" data-canonical-url="data:image/jpeg;base64,/9j/4AAQSk...ooooA//9k=" class=""/><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="pw3ay5pTIR" class="myst-jp-nb-block relative group/block"><h2 id="references" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">References</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li><p>Berthon, J.-F., Zibordi, G.: Bio-optical relationships for the northern Adriatic Sea. Int. J. Remote Sens., 25, 1527-1532, 2004</p></li><li><p>Buongiorno Nardelli, B., R. Droghei, and R. Santoleri, (2016): Multi-dimensional interpolation of SMOS sea
surface salinity with surface temperature and in situ salinity data. Rem. Sens. Environ</p></li><li><p>Droghei, R., B. Buongiorno Nardelli, and R. Santoleri, 2016: Combining in-situ and satellite observations to
retrieve salinity and density at the ocean surface. J. Atmos. Oceanic Technol.</p></li><li><p>Embury, O., Merchant, C.J., Good, S.A., Rayner, N.A., Høyer, J.L., Atkinson, C., Block, T., Alerskans, E.,
Pearson, K.J., Worsfold, M., McCarroll, N., Donlon, C., (2024). Satellite-based time-series of sea-surface
temperature since 1980 for climate applications. Sci Data 11, 326</p></li><li><p>Pisano, A., Nardelli, B. B., Tronconi, C., &amp; Santoleri, R. (2016). The new Mediterranean optimally interpolated pathfinder AVHRR SST Dataset (1982–2012). Remote Sensing of Environment, 176, 107-116</p></li><li><p>Sammartino, Michela, Salvatore Aronica, Rosalia Santoleri, and Bruno Buongiorno Nardelli. (2022). Retrieving
Mediterranean Sea Surface Salinity Distribution and Interannual Trends from Multi-Sensor Satellite and In Situ
Data, Remote Sensing 14, 250</p></li><li><p>Volpe, G., Buongiorno Nardelli, B., Colella, S., Pisano, A. and Santoleri, R. (2018). An Operational
Interpolated Ocean Colour Product in the Mediterranean Sea, in New Frontiers in Operational Oceanography,
edited by E. P. Chassignet, A. Pascual, J. Tintorè, and J. Verron, pp. 227–244z</p></li><li><p>Volpe, G., Colella, S., Brando, V. E., Forneris, V., Padula, F. L., Cicco, A. D., ... &amp; Santoleri, R. (2019). Mediterranean ocean colour Level 3 operational multi-sensor processing. Ocean Science, 15(1), 127-146</p></li></ul><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="pLRqUli3Mb" class="myst-jp-nb-block relative group/block"><h2 id="key-conclusions" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Key Conclusions</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#key-conclusions" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This study demonstrates the effectiveness of unsupervised clustering for identifying and mapping ocean water types from multi-parameter satellite observations. Key findings include:</p><ol start="1"><li><p><strong>Three distinct water types identified</strong>: Coastal (high productivity), eutrophic (moderate productivity), and oligotrophic (low productivity) waters distinguished by combined biological, physical, and atmospheric characteristics</p></li><li><p><strong>Geographic coherence</strong>: Spatial patterns align with known Mediterranean oceanography, validating the clustering approach against established understanding</p></li><li><p><strong>Seasonal dynamics captured</strong>: Temporal analysis reveals expansion/contraction of water types consistent with seasonal stratification and mixing cycles</p></li><li><p><strong>Multi-parameter synergy</strong>: Integration of chlorophyll-a, SST, sea level height, and wind components provides richer characterization than single-parameter approaches</p></li></ol><p><strong>Study limitations and future directions:</strong></p><ul><li><p><em>Cluster number selection</em>: Statistical optimum (5 clusters) provided insufficient detail, while chosen number (8) resulted in only 3 active clusters—suggesting need for adaptive cluster selection methods</p></li><li><p><em>Coastal water stability</em>: Lack of seasonal variation in Cluster 2 (coastal waters) may indicate need for higher temporal resolution or separate coastal-specific analysis</p></li><li><p><em>Validation needed</em>: No quantitative validation against in-situ measurements or existing water type classifications was performed</p></li><li><p><em>Algorithm exploration</em>: Testing alternative clustering methods (hierarchical, DBSCAN, Gaussian mixture models) could improve classification</p></li><li><p><em>Additional parameters</em>: Including sea surface salinity, turbidity, or fluorescence line height could enhance water type discrimination</p></li></ul><p><strong>Future work priorities:</strong></p><ul><li><p>Extend analysis to other ocean basins for method generalization</p></li><li><p>Incorporate in-situ validation data from research cruises and Argo floats</p></li><li><p>Develop operational products for near-real-time water type mapping</p></li><li><p>Investigate machine learning approaches for temporal prediction of water type transitions</p></li></ul><p>The framework established here provides a foundation for automated ocean water type classification from Earth observation data, with potential applications in operational oceanography, ecosystem monitoring, and climate change impact assessment.</p><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="U8rRXwH2dQ" class="myst-jp-nb-block relative group/block"><h2 id="societal-context" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Societal Context</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#societal-context" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li><p>Understanding marine ecosystems</p></li><li><p>Monitoring water quality</p></li><li><p>Supporting climate and fisheries research by mapping productive zones</p></li></ul></div><div id="ZPjuDzPylZ" class="myst-jp-nb-block relative group/block"><h2 id="import-libraries" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Import Libraries</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#import-libraries" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="muxsRZMwt3" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
import matplotlib.pyplot as plt
from datetime import datetime
import os
import shapely.geometry
import xarray as xr
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
from IPython.display import JSON, display, HTML
import joblib
import cartopy.crs as ccrs
import cartopy.feature as cfeature
from cartopy.mpl.gridliner import LONGITUDE_FORMATTER, LATITUDE_FORMATTER
import xcube_cmems
from xcube.core.store import (
    find_data_store_extensions,
    get_data_store_params_schema,
    new_data_store,
)
import pandas as pd</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="F3ysD7d2XrST4gFhAZyNN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ZidNDpKOPE" class="myst-jp-nb-block relative group/block"><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="GPyKAW7Qwg" class="myst-jp-nb-block relative group/block"><h2 id="data-sources" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Data sources</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-sources" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="IIX8oIKX3k" class="myst-jp-nb-block relative group/block"><p>The table below shows the data products used with links to description, access source and classification attributes.</p></div><div id="RQakqpoiwU" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df = pd.DataFrame({
    &quot;Datacube name&quot;: [&#x27;CMEMS&#x27;, &#x27;CMEMS&#x27;, &#x27;CMEMS&#x27;, &#x27;CMEMS&#x27;, &#x27;CMEMS&#x27;],
    &quot;Variable description&quot;: [
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/OCEANCOLOUR_MED_BGC_L4_MY_009_144/description&quot;&gt;CHL&lt;/a&gt;&#x27;,
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/MULTIOBS_GLO_PHY_S_SURFACE_MYNRT_015_013/description&quot;&gt;SOS&lt;/a&gt;&#x27;,
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/SEALEVEL_EUR_PHY_L4_MY_008_068/description&quot;&gt;SLA&lt;/a&gt;&#x27;,
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/SST_MED_SST_L4_REP_OBSERVATIONS_010_021/description&quot;&gt;SST&lt;/a&gt;&#x27;,
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/WIND_GLO_PHY_CLIMATE_L4_MY_012_003/description&quot;&gt;Wind&lt;/a&gt;&#x27;,
    ],
    &quot;Data access&quot;: [
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/OCEANCOLOUR_MED_BGC_L4_MY_009_144/services&quot;&gt;source&lt;/a&gt;&#x27;,
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/MULTIOBS_GLO_PHY_S_SURFACE_MYNRT_015_013/services&quot;&gt;source&lt;/a&gt;&#x27;,
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/SEALEVEL_EUR_PHY_L4_MY_008_068/services&quot;&gt;source&lt;/a&gt;&#x27;,
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/SST_MED_SST_L4_REP_OBSERVATIONS_010_021/services&quot;&gt;source&lt;/a&gt;&#x27;,
        &#x27;&lt;a href=&quot;https://data.marine.copernicus.eu/product/WIND_GLO_PHY_CLIMATE_L4_MY_012_003/services&quot;&gt;source&lt;/a&gt;&#x27;,
    ],
    &quot;Temporal extent&quot;: [&#x27;Multi-year&#x27;, &#x27;Multi-year&#x27;, &#x27;Multi-year&#x27;, &#x27;Multi-year&#x27;, &#x27;Multi-year&#x27;],
    &quot;Temporal resolution&quot;: [&#x27;Daily,Monthly&#x27;, &#x27;Daily,Monthly&#x27;, &#x27;Daily,Monthly&#x27;, &#x27;Daily&#x27;, &#x27;Monthly&#x27;],
    &quot;Spatial extent&quot;: [&#x27;Mediterranean Sea&#x27;,&#x27;Global&#x27;,&#x27;Global&#x27;,&#x27;Mediterranean Sea&#x27;,&#x27;Global&#x27;],
    &quot;Spatial resolution&quot;: [&#x27;1 × 1 km&#x27;,&#x27;0.125° × 0.125°&#x27;,&#x27;0.0625° × 0.0625°&#x27;,&#x27;0.05° × 0.05°&#x27;,&#x27;0.25° × 0.25°&#x27;],
})

display(HTML(df.to_html(escape=False, index=False)))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="0nCnFRuOsHMRHsGvDwIgC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="QBmaKP8H51" class="myst-jp-nb-block relative group/block"><p>Copernicus Marine Service data cubes <a target="_blank" rel="noreferrer" href="https://data.marine.copernicus.eu/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">CMEMS</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> products have been accessed via xcube plugin from the CMEMS API. <br/>Further information on the available data sources on DeepESDL with data access example notebooks can be found <a target="_blank" rel="noreferrer" href="https://earthsystemdatalab.net/data/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">here</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.</p><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="qRlSwA1a8S" class="myst-jp-nb-block relative group/block"><h3 id="combining-input-data" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Combining input data</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#combining-input-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="tLk8bJjQIP" class="myst-jp-nb-block relative group/block"><h3 id="loading-and-combining-cmems-oceanographic-datasets" class="relative group"><span class="heading-text">Loading and combining CMEMS oceanographic datasets</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#loading-and-combining-cmems-oceanographic-datasets" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="b8It0aIg3J" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def make_combined_dataset(time_selected = [&#x27;1998-01-01&#x27;, &#x27;2023-11-01&#x27;], bounds = [-6,30,36.5,46], fill_nan_value = -9999, opt=False):
    
    cmems_store = new_data_store(&quot;cmems&quot;)
    ds_bgc = cmems_store.open_data(&#x27;cmems_obs-oc_med_bgc-plankton_my_l4-multi-1km_P1M&#x27;,
                               variable_names = [&#x27;CHL&#x27;],
                               time_range = time_selected,
                               bbox = bounds)

    ds_sal = cmems_store.open_data(&#x27;cmems_obs-mob_glo_phy-sss_my_multi_P1M&#x27;,
                               variable_names = [&#x27;sos&#x27;],
                               time_range = time_selected,
                               bbox = bounds)

    ds_ssh = cmems_store.open_data(&#x27;cmems_obs-sl_eur_phy-ssh_my_allsat-l4-duacs-0.0625deg_P1M-m&#x27;,
                               variable_names = [&#x27;sla&#x27;],
                               time_range = time_selected,
                               bbox = bounds)

    ds_sst = cmems_store.open_data(&#x27;cmems_SST_MED_SST_L4_REP_OBSERVATIONS_010_021&#x27;,
                               variable_names = [&#x27;analysed_sst&#x27;],
                               time_range = time_selected,
                               bbox = bounds)
    ds_sst = ds_sst.resample(time=&quot;MS&quot;).mean()

    ds_wind = cmems_store.open_data(&#x27;cmems_obs-wind_glo_phy_my_l4_P1M&#x27;,
                               variable_names = [&#x27;eastward_wind&#x27;, &#x27;northward_wind&#x27;, &#x27;eastward_stress&#x27;, &#x27;northward_stress&#x27;],
                               time_range = time_selected,
                               bbox = bounds)
    
    ds_ssh = ds_ssh.interp(latitude = ds_sal[&#x27;latitude&#x27;], longitude = ds_sal[&#x27;longitude&#x27;])
    ds_sst = ds_sst.interp(latitude = ds_sal[&#x27;latitude&#x27;], longitude = ds_sal[&#x27;longitude&#x27;])
    ds_bgc = ds_bgc.interp(latitude = ds_sal[&#x27;latitude&#x27;], longitude = ds_sal[&#x27;longitude&#x27;])
    ds_wind = ds_wind.interp(latitude = ds_sal[&#x27;latitude&#x27;], longitude = ds_sal[&#x27;longitude&#x27;])
    
    if opt:
        ds_combined = xr.merge([ds_bgc, ds_ssh, ds_sst, ds_wind])
    else:
        ds_combined = xr.merge([ds_bgc, ds_ssh, ds_sal, ds_sst, ds_wind])
    
    return ds_combined</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="vE48DC1p6d72Vl21hzW3g" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="KWMZ7fGepQ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Defining input parameters for the combined dataset
time_selected = [&#x27;1998-01-01&#x27;, &#x27;2023-11-01&#x27;]
bounds = [-6,30,36.5,46]
fill_nan_value = -9999
opt=True

ds_combined = make_combined_dataset(time_selected, bounds, fill_nan_value, opt)
ds_combined_m = ds_combined.where(~ds_combined[&#x27;CHL&#x27;].isnull())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="mU9kjMKhaKHnoKU-oeeBs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>INFO - 2025-11-13T21:53:44Z - Selected dataset version: &quot;202311&quot;
INFO - 2025-11-13T21:53:44Z - Selected dataset part: &quot;default&quot;
WARNING - 2025-11-13T21:53:45Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.005064010620117, 45.994937896728516]
WARNING - 2025-11-13T21:53:45Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-5.9935760498046875, 36.49357604980469]
WARNING - 2025-11-13T21:53:45Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.005064010620117, 45.994937896728516]
WARNING - 2025-11-13T21:53:45Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-5.9935760498046875, 36.49357604980469]
INFO - 2025-11-13T21:53:46Z - Selected dataset version: &quot;202311&quot;
INFO - 2025-11-13T21:53:46Z - Selected dataset part: &quot;default&quot;
INFO - 2025-11-13T21:53:47Z - Selected dataset version: &quot;202411&quot;
INFO - 2025-11-13T21:53:47Z - Selected dataset part: &quot;default&quot;
INFO - 2025-11-13T21:53:48Z - Selected dataset version: &quot;202411&quot;
INFO - 2025-11-13T21:53:48Z - Selected dataset part: &quot;default&quot;
WARNING - 2025-11-13T21:53:48Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.125, 46.025001525878906]
WARNING - 2025-11-13T21:53:48Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-18.125, 36.32500076293945]
WARNING - 2025-11-13T21:53:48Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.125, 46.025001525878906]
WARNING - 2025-11-13T21:53:48Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-18.125, 36.32500076293945]
INFO - 2025-11-13T21:53:50Z - Selected dataset version: &quot;202411&quot;
INFO - 2025-11-13T21:53:50Z - Selected dataset part: &quot;default&quot;
</span></code></pre></div></div></div></div><div id="LZp9ROWPz1" class="myst-jp-nb-block relative group/block"><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="Pfrg2DCnAh" class="myst-jp-nb-block relative group/block"><h3 id="visualizing-input-data" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Visualizing input data</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualizing-input-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="bZ2jVzNMOn" class="myst-jp-nb-block relative group/block"><h3 id="visualizing-oceanographic-input-variables" class="relative group"><span class="heading-text">Visualizing oceanographic input variables</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualizing-oceanographic-input-variables" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="R2wehl2XIy" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def plot_geo_input(
    ax, lon, lat, data,
    *,
    projection=ccrs.PlateCarree(),
    cmap=&quot;viridis&quot;,
    shading=&quot;auto&quot;,
    add_gridlines=True,
    gridlines_kwargs=None,
    coastline_kwargs=None,
    colorbar=True,
    cbar_label=&quot;&quot;,
    title=&quot;&quot;,
    vmin=None,
    vmax=None,
):
    
    # colormesh plot
    pcm = ax.pcolormesh(
        lon,
        lat,
        data,
        transform=projection,
        cmap=cmap,
        shading=shading,
        vmin=vmin,
        vmax=vmax,
    )

    # coastlines
    if coastline_kwargs is None:
        ax.add_feature(cfeature.LAND)
        ax.add_feature(cfeature.RIVERS)
        ax.add_feature(cfeature.LAKES)
        ax.coastlines()
    else: 
        extra = coastline_kwargs.get(&quot;extra_features&quot;, [])
        for item in extra:
            if isinstance(item, tuple):
                feature, feat_kwargs = item
            else:
                feature, feat_kwargs = item, {}
            ax.add_feature(feature, **feat_kwargs)
            ax.coastlines(linewidth=0.7)

    # gridlines
    if add_gridlines:
        if gridlines_kwargs is None:
            gridlines_kwargs = dict(draw_labels=True, linestyle=&quot;--&quot;, linewidth=0.5)
        gl = ax.gridlines(crs=projection, **gridlines_kwargs)
        gl.top_labels = False
        gl.right_labels = False

    # colorbar
    cbar = None
    if colorbar:
        cbar = plt.colorbar(pcm, ax=ax, orientation=&quot;horizontal&quot;, pad=0.1, aspect=50)
        if cbar_label:
            cbar.set_label(cbar_label)

    # title
    if title:
        dt_ = datetime.strptime(title, &quot;%Y-%m-%d&quot;)
        ax.set_title(dt_.strftime(&quot;%B - %Y&quot;), weight=&#x27;bold&#x27;)

    return pcm, cbar</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="rnnYOBJYwM_5tieE3TvZw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="YrSXgmMF2Y" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># --- Inputs ---
lon_ = ds_combined.longitude
lat_ = ds_combined.latitude
time_1 = &#x27;2000-01-01&#x27; # January
time_2 = &#x27;2000-08-01&#x27; # August</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Bf1agwJ2izaajHoR7O22i" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ALiHoOFCzg" class="myst-jp-nb-block relative group/block"><h4 id="chlorophyll-a-concentrations" class="relative group"><span class="heading-text">Chlorophyll-a concentrations</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#chlorophyll-a-concentrations" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="d2DFPFpJ1V" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))

# Inputs
var_ = ds_combined[&#x27;CHL&#x27;]
vmax = .5
cbar_label = r&quot;Concentration of Chlorophyll-a [$\mathrm{mg}\,\cdot\,\mathrm{m}^{-3}$]&quot;
# ---

plot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1), title=time_1,cbar_label=cbar_label,vmax=vmax)
plot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2), title=time_2,cbar_label=cbar_label,vmax=vmax)

plt.savefig(&#x27;Chl-a_concentrations.png&#x27;, dpi=300, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="NtkDGFM2R2nIxMwuDVM7V" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/acc0f55d084b42e81e0b7a0c290f8652.png" alt="&lt;Figure size 1500x800 with 4 Axes&gt;"/></div></div></div><div id="oLGoFXbXf5" class="myst-jp-nb-block relative group/block"><h4 id="sea-surface-height-ssh" class="relative group"><span class="heading-text">Sea Surface Height (SSH)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#sea-surface-height-ssh" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="xmLsqnbctb" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))

# Inputs
var_ = ds_combined[&#x27;sla&#x27;]
vmin = min(var_.sel(time=time_1).min().compute().item(), var_.sel(time=time_2).min().compute().item())
vmax = max(var_.sel(time=time_1).max().compute().item(), var_.sel(time=time_2).max().compute().item())
cmap=&#x27;magma&#x27;
cbar_label = r&quot;Sea Surface Height [m]&quot;
# ---

plot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1),cmap=cmap,title=time_1,cbar_label=cbar_label,vmin=vmin,vmax=vmax)
plot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2), cmap=cmap,title=time_2,cbar_label=cbar_label,vmin=vmin,vmax=vmax)

plt.savefig(&#x27;Sea_Surface_Height.png&#x27;, dpi=300, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="DlWU24rb9Ol2mBGTp9FUn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/ea6f917654993a2d25e2a2032a7aa1d2.png" alt="&lt;Figure size 1500x800 with 4 Axes&gt;"/></div></div></div><div id="eHrmjhrflp" class="myst-jp-nb-block relative group/block"><h4 id="sea-surface-temperature-sst" class="relative group"><span class="heading-text">Sea Surface Temperature (SST)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#sea-surface-temperature-sst" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="MLGKpRAZdY" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))

# Inputs
var_ = ds_combined[&#x27;analysed_sst&#x27;]
vmin = min(var_.sel(time=time_1).min().compute().item(), var_.sel(time=time_2).min().compute().item())
vmax = max(var_.sel(time=time_1).max().compute().item(), var_.sel(time=time_2).max().compute().item())
cmap=&#x27;coolwarm&#x27;
cbar_label = r&quot;Sea Surface Temperature [K]&quot;
# ---

plot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1),cmap=cmap,title=time_1,cbar_label=cbar_label,vmin=vmin,vmax=vmax)
plot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2), cmap=cmap,title=time_2,cbar_label=cbar_label,vmin=vmin,vmax=vmax)

plt.savefig(&#x27;Sea_Surface_Temperature.png&#x27;, dpi=300, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="o9IqLPDW4MpvjPe-9l6lB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/21cd8b9d533725aed35042bce3bd9a47.png" alt="&lt;Figure size 1500x800 with 4 Axes&gt;"/></div></div></div><div id="SjeH2AcWHa" class="myst-jp-nb-block relative group/block"><h4 id="eastward-wind-component" class="relative group"><span class="heading-text">Eastward Wind component</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#eastward-wind-component" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="jMG1DRCgSx" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))

# Inputs
var_ = ds_combined[&#x27;eastward_wind&#x27;]
feat_ = {&quot;extra_features&quot;: [(cfeature.LAND, {&quot;zorder&quot;: 1}),(cfeature.RIVERS),(cfeature.LAKES)]}
vmin = min(var_.sel(time=time_1).min().compute().item(), var_.sel(time=time_2).min().compute().item())
vmax = max(var_.sel(time=time_1).max().compute().item(), var_.sel(time=time_2).max().compute().item())
cmap=&#x27;PiYG&#x27;
cbar_label = r&quot;Eastward wind at 10 m [$\mathrm{m}\,\cdot\,\mathrm{s}^{-1}$]&quot;
# ---

plot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1),cmap=cmap,coastline_kwargs=feat_,title=time_1,cbar_label=cbar_label,vmin=vmin,vmax=vmax)
plot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2),cmap=cmap,coastline_kwargs=feat_,title=time_2,cbar_label=cbar_label,vmin=vmin,vmax=vmax)

plt.savefig(&#x27;EastwardWind.png&#x27;, dpi=300, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="0-L7roqSVhHg2rWThnyaC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/9bc08f5cb315bc6b0692c914610ac232.png" alt="&lt;Figure size 1500x800 with 4 Axes&gt;"/></div></div></div><div id="eqfvxkMR2r" class="myst-jp-nb-block relative group/block"><h4 id="northward-wind-component" class="relative group"><span class="heading-text">Northward Wind component</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#northward-wind-component" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="iXRZcgYqdr" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))

# Inputs
var_ = ds_combined[&#x27;northward_wind&#x27;]
feat_ = {&quot;extra_features&quot;: [(cfeature.LAND, {&quot;zorder&quot;: 1}),(cfeature.RIVERS),(cfeature.LAKES)]}
vmin = min(var_.sel(time=time_1).min().compute().item(), var_.sel(time=time_2).min().compute().item())
vmax = max(var_.sel(time=time_1).max().compute().item(), var_.sel(time=time_2).max().compute().item())
cmap=&#x27;PiYG&#x27;
cbar_label = r&quot;Northward wind at 10 m [$\mathrm{m}\,\cdot\,\mathrm{s}^{-1}$]&quot;
# ---

plot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1),cmap=cmap,coastline_kwargs=feat_,title=time_1,cbar_label=cbar_label,vmin=vmin,vmax=vmax)
plot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2),cmap=cmap,coastline_kwargs=feat_,title=time_2,cbar_label=cbar_label,vmin=vmin,vmax=vmax)

plt.savefig(&#x27;NorthwardWind.png&#x27;, dpi=300, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="BHrJom064oen0OYGgPCxl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/3444e72cf2a73d28f4abe960931406ec.png" alt="&lt;Figure size 1500x800 with 4 Axes&gt;"/></div></div></div><div id="rOVNYYCC3a" class="myst-jp-nb-block relative group/block"><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="c1XUpwOjDl" class="myst-jp-nb-block relative group/block"><h2 id="analysis" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Analysis</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#analysis" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="aOC8odiixF" class="myst-jp-nb-block relative group/block"><h3 id="utility-functions" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Utility functions</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#utility-functions" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="EzOewkaaz0" class="myst-jp-nb-block relative group/block"><h3 id="normalizing-input-variables" class="relative group"><span class="heading-text">Normalizing input variables</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#normalizing-input-variables" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="ZlyiWdZrc4" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def normalise(variable_array):
    
    scaler = StandardScaler()
    scaler.fit(variable_array)
    norm_data = scaler.transform(variable_array)
    
    return norm_data</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="8nQDRQZf1y1Cng529Ux6R" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vC9rqud7Ri" class="myst-jp-nb-block relative group/block"><h3 id="extracting-and-normalizing-monthly-oceanographic-variable" class="relative group"><span class="heading-text">Extracting and normalizing monthly oceanographic variable</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#extracting-and-normalizing-monthly-oceanographic-variable" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="vqj4itcw1w" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_month_variables(ds_combined, mth, fill_nan_value = -9999):
    
    #ds_combined= ds_combined.sel(depth=0)
    ds_months = ds_combined.groupby(&#x27;time.month&#x27;).mean()
    ds_m = ds_months.sel(month=mth)
    ds_vars = [i for i in ds_months.data_vars] 

    for i,var in enumerate(ds_vars):
        var_2d = ds_m[f&#x27;{var}&#x27;].values
        var_2d_n = normalise(var_2d)
        var_f = var_2d_n[5:-5,5:-5].flatten()

        if i ==0:
            var_all = var_f
        else:
            var_all = np.vstack((var_all, var_f))
        
    var_all_t = np.transpose(var_all)
    var_all_t_mask = np.where(np.isfinite(var_all_t), var_all_t, fill_nan_value)
    
    return var_all_t_mask</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Nn4sEa7dLTt27sG8f52q6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Y52L6rtRF2" class="myst-jp-nb-block relative group/block"><h3 id="averaging-and-normalizing-oceanographic-variable" class="relative group"><span class="heading-text">Averaging and normalizing oceanographic variable</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#averaging-and-normalizing-oceanographic-variable" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="YxnCiPFJF9" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_average_variables(ds_combined, fill_nan_value = -9999, opt = False):
    
    if opt:
        ds_av = ds_combined.groupby(&#x27;time.day&#x27;).mean()
        ds_av = ds_av.sel(day=1)
    else:
        ds_combined= ds_combined.sel(depth=0)
        ds_av = ds_combined.mean()
        
    ds_vars = [i for i in ds_av.data_vars] 

    for i,var in enumerate(ds_vars):
        var_2d = ds_av[f&#x27;{var}&#x27;].values
        var_2d_n = normalise(var_2d)
        var_f = var_2d_n[5:-5,5:-5].flatten()

        if i ==0:
            var_all = var_f
        else:
            var_all = np.vstack((var_all, var_f))
        
    var_all_t = np.transpose(var_all)
    var_all_t_mask = np.where(np.isfinite(var_all_t), var_all_t, fill_nan_value)
    
    return var_all_t_mask</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="_iafADdY41Dk8l696xtrb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="dTZiJUiOnY" class="myst-jp-nb-block relative group/block"><h3 id="finding-the-optimal-number-of-clusters-optimization-technique-elbow-method" class="relative group"><span class="heading-text">Finding the optimal number of clusters (optimization technique: Elbow Method)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#finding-the-optimal-number-of-clusters-optimization-technique-elbow-method" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="hFBP1oEYwA" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def test_number_of_clusters(variables, n_max, random_state):
    out = []
    
    for i in range(3,n_max):
        kmeans = KMeans(n_clusters=i, random_state=random_state)
        labels = kmeans.fit_predict(variables)
        out.append(kmeans.inertia_)
        
    plt.plot(np.arange(3, n_max), out)
    plt.xlabel(&#x27;Number of clusters&#x27;)
    plt.ylabel(&#x27;Inertia&#x27;)
    plt.title(&#x27;Optimal number of clusters\nElbow method&#x27;)
    
    return out</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="VkgrtIh-1ThdCVNAmh9so" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="KAaDwAzfl0" class="myst-jp-nb-block relative group/block"><h3 id="converting-cluster-assignments-to-geo-dataarray" class="relative group"><span class="heading-text">Converting cluster assignments to Geo-DataArray</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#converting-cluster-assignments-to-geo-dataarray" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="QGWcqNrlAq" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def masking_labels(labels):

    cluster_map = labels
    cluster_map = cluster_map.reshape(len(ds_combined_m.latitude[5:-5]), len(ds_combined_m.longitude[5:-5]))
    da_clusters = xr.DataArray(
        cluster_map,
        coords={&quot;latitude&quot;: ds_combined_m.latitude[5:-5], &quot;longitude&quot;: ds_combined_m.longitude[5:-5]},
        dims=(&quot;latitude&quot;, &quot;longitude&quot;)
    )
    
    return da_clusters</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="lQhbZCNcNTFNsfpx3Ioxz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="iCBLgQaKIf" class="myst-jp-nb-block relative group/block"><h3 id="processing-seasonal-climatology-variables-by-month" class="relative group"><span class="heading-text">Processing seasonal climatology variables by month</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#processing-seasonal-climatology-variables-by-month" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="sKHNyjz748" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, mth, fill_nan_value = -9999):
    
    ds_combined_seasonally_all_yrs_avg = ds_combined_seasonally_all_yrs_avg.sel(depth=0)
    ds_months = ds_combined_seasonally_all_yrs_avg
    ds_m = ds_months.sel(month=mth)
    ds_vars = [i for i in ds_months.data_vars] 

    for i,var in enumerate(ds_vars):
        
        var_2d = ds_m[f&#x27;{var}&#x27;].values
        var_2d_n = normalise(var_2d)
        var_f = var_2d_n[5:-5,5:-5].flatten() # remove the border because getting weird edge effects, then flatten
        
        if i ==0:
            var_all = var_f
        else:
            var_all = np.vstack((var_all, var_f))
        
    var_all_t = np.transpose(var_all)
    var_all_t_mask = np.where(np.isfinite(var_all_t), var_all_t, fill_nan_value)
    
    return var_all_t_mask</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="nflNnzLEJEklEFfjd_zXP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="NZt4LU8Ff4" class="myst-jp-nb-block relative group/block"><h3 id="converting-geo-dataarray-to-csv" class="relative group"><span class="heading-text">Converting Geo-DataArray to csv</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#converting-geo-dataarray-to-csv" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="qY0xBaJ41p" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def xarr_to_csv(xarray_name, xarray_ds):
    df_ = xarray_ds.to_dataframe(name=xarray_name).reset_index()
    csv_path = f&quot;{xarray_name}.csv&quot;
    df_.to_csv(csv_path, index=False)
    return csv_path

def csv_to_xarray(csv_path, xarray_name):
    df_ = pd.read_csv(csv_path)
    xarray_ = (df_.set_index([&quot;latitude&quot;, &quot;longitude&quot;]).to_xarray()[xarray_name])
    return xarray_</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="znBM75Kq5WYIspqfjYt9M" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="DU5YFW96ae" class="myst-jp-nb-block relative group/block"><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="jDfRMsERbM" class="myst-jp-nb-block relative group/block"><h3 id="k-means-implementation" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">K-means implementation</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#k-means-implementation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="XCLWNblJiF" class="myst-jp-nb-block relative group/block"><h4 id="finding-the-optimal-number-of-clusters" class="relative group"><span class="heading-text">Finding the optimal number of clusters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#finding-the-optimal-number-of-clusters" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="WHaM0FtAXJ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">variables_av = get_average_variables(ds_combined_m, fill_nan_value, opt)
np.savetxt(&#x27;variables_all_masked.txt&#x27;, variables_av)
variables_av = np.loadtxt(&#x27;variables_all_masked.txt&#x27;)

# Plotting Inertia against the number of clusters to find the optimal value
max_clusters = 15 # maximum number of clusters to be tested
random_state = 10 # setting &lt;random state&gt; for results reproducibility
elbow = test_number_of_clusters(variables_av, max_clusters, random_state)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Ve_X4ySAdCZ4gxoQM-IMl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/9f51ce903a6d19994a58a116b7e88599.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div></div><div id="PGzveF2cid" class="myst-jp-nb-block relative group/block"><p>By looking at the graph, the Elbow point is at 5. However, 8 has been chosen since 5, 6 and 7 clusters led to only two water types (coastal and open).</p></div><div id="m4fnqYRBmp" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">opt_clusters = 8 # optimal number of clusters 
random_state = 10 # setting &lt;random state&gt; for results reproducibility
kmeans = KMeans(n_clusters=opt_clusters, random_state=random_state) 
labels = kmeans.fit_predict(variables_av)

joblib.dump(kmeans, &#x27;kmeans.joblib&#x27;)
joblib.dump(labels, &#x27;labels.joblib&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="6ENlAcSz7ciDEZRm2ta0l" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>[&#x27;labels.joblib&#x27;]</span></code></div></div></div><div id="hjdMirMwoN" class="myst-jp-nb-block relative group/block"><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="RtJtGJ7UwX" class="myst-jp-nb-block relative group/block"><h3 id="monthly-clustering" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Monthly clustering</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#monthly-clustering" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="Ay5lKS7btZ" class="myst-jp-nb-block relative group/block"><h4 id="extracting-monthly-variables-from-the-combined-dataset" class="relative group"><span class="heading-text">Extracting monthly variables from the combined dataset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#extracting-monthly-variables-from-the-combined-dataset" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="cZsgVrKgKf" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">variables_8 = get_month_variables(ds_combined_m, 8) # August
variables_1 = get_month_variables(ds_combined_m, 1) # January</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="756iJXiYQFBYAuyEji-tR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
</span></code></pre></div></div></div></div><div id="UNK53fZZqh" class="myst-jp-nb-block relative group/block"><h4 id="applying-k-means-clustering-to-monthly-variables" class="relative group"><span class="heading-text">Applying K-means clustering to monthly variables</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#applying-k-means-clustering-to-monthly-variables" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="QphiOwMi76" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Loading clusters centroids and labels
kmeans = joblib.load(&#x27;kmeans.joblib&#x27;)
labels = joblib.load(&#x27;labels.joblib&#x27;)

labels_8 = kmeans.predict(variables_8)
labels_1 = kmeans.predict(variables_1)

da_8 = masking_labels(labels_8)
da_1 = masking_labels(labels_1)

jan = da_1.values
aug = da_8.values</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="4yG3Pv4-X6m7PJr1j-bt_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="WDlfczzjiB" class="myst-jp-nb-block relative group/block"><h4 id="visualization-of-monthly-clusters" class="relative group"><span class="heading-text">Visualization of monthly clusters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualization-of-monthly-clusters" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="E5meQF7lBI" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(15, 17))
ax = fig.add_subplot(121, projection=ccrs.PlateCarree())
ax.coastlines(zorder=4)
ax.add_feature(cfeature.LAKES, zorder=3)
ax.add_feature(cfeature.RIVERS, zorder=3)
pc = ax.pcolormesh(da_1.longitude,da_1.latitude, da_1, cmap=&#x27;Accent&#x27;)
gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color=&#x27;k&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;)
gl.xformatter = LONGITUDE_FORMATTER
gl.yformatter = LATITUDE_FORMATTER
cbar = plt.colorbar(pc, ax=ax, label=&#x27;Cluster&#x27;, pad=0.15, shrink=0.15)
cbar.set_ticks(np.arange(0,8,1))
ax.set_title(&#x27;January&#x27;, fontsize=16, weight=&#x27;bold&#x27;)

ax = fig.add_subplot(122, projection=ccrs.PlateCarree())
pc2 = ax.pcolormesh(da_8.longitude,da_8.latitude,da_8, cmap=&#x27;Accent&#x27;, zorder=2)
ax.coastlines(zorder=4)
ax.add_feature(cfeature.LAKES, zorder=3)
ax.add_feature(cfeature.RIVERS, zorder=3)
gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color=&#x27;k&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;)
gl.xformatter = LONGITUDE_FORMATTER
gl.yformatter = LATITUDE_FORMATTER
cbar = plt.colorbar(pc2, ax=ax, label=&#x27;Cluster&#x27;, pad=0.15, shrink=0.15)
cbar.set_ticks(np.arange(0,8,1))
ax.set_title(&#x27;August&#x27;, fontsize=16, weight=&#x27;bold&#x27;)
plt.tight_layout()
plt.savefig(&#x27;JanuaryAugust_clustering.png&#x27;,bbox_inches=&#x27;tight&#x27;)
plt.show()

fig = plt.figure(figsize=(15,6))
ax = plt.axes(projection = ccrs.PlateCarree())
ax.coastlines(zorder=4)
ax.add_feature(cfeature.LAND, zorder=2)
ax.add_feature(cfeature.LAKES, zorder=3)
ax.add_feature(cfeature.RIVERS, zorder=3)
ax.add_feature(cfeature.OCEAN)
pc3 = ax.pcolormesh(da_8.longitude, da_8.latitude, da_8 - da_1, cmap=&#x27;bwr&#x27;, zorder=1)
gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color=&#x27;k&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;, zorder=5)
gl.xformatter = LONGITUDE_FORMATTER
gl.yformatter = LATITUDE_FORMATTER
plt.colorbar(pc3, ax=ax, label = &#x27;Cluster Difference&#x27;, pad=0.10, shrink=0.8, )
ax.set_title(&#x27;Cluster differences&#x27;, fontsize=16, weight=&#x27;bold&#x27;)
plt.tight_layout()
plt.savefig(&#x27;JanuaryAugust_ClusterDifferences.png&#x27;,bbox_inches=&#x27;tight&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="JqDvYi7ugXkamU3IQ8G7I" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/bcf72160332e60beb964ca027c00511b.png" alt="&lt;Figure size 1500x1700 with 4 Axes&gt;"/></div><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/c135a217b1504c636c6092d998f51024.png" alt="&lt;Figure size 1500x600 with 2 Axes&gt;"/></div></div></div><div id="lWMLpOWwT0" class="myst-jp-nb-block relative group/block"><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div id="DSbCqieshx" class="myst-jp-nb-block relative group/block"><h3 id="seasonal-clustering" class="relative group"><span class="heading-text"><p><a class="link" href="/eodashboard-notebooks"></a></p><span class="" style="color:DarkCyan">Seasonal clustering</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#seasonal-clustering" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="BhCGxGYtEK" class="myst-jp-nb-block relative group/block"><h4 id="extracting-seasonal-variables-from-the-combined-dataset" class="relative group"><span class="heading-text">Extracting seasonal variables from the combined dataset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#extracting-seasonal-variables-from-the-combined-dataset" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="Q0h9WwYMjR" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Input parameters
time_selected = [&#x27;1998-01-01&#x27;, &#x27;2023-11-01&#x27;]
bounds = [-6,30,36.5,46]
fill_nan_value = -9999
opt = False

# Extracting seasonal values from the combined dataset
ds_combined = make_combined_dataset(time_selected, bounds, fill_nan_value, opt)
ds_combined_m = ds_combined.where(~ds_combined[&#x27;CHL&#x27;].isnull())
ds_combined_seasonally = ds_combined_m.resample(time=&quot;QS-DEC&quot;).mean() 
ds_combined_seasonally_all_yrs_avg = ds_combined_seasonally.groupby(&#x27;time.month&#x27;).mean()

ds_combined_seasonally_all_yrs_avg = ds_combined_seasonally_all_yrs_avg.drop_vars(&#x27;sos&#x27;)

variables_DJF = get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, 12)
variables_MAM = get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, 3)
variables_JJA = get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, 6)
variables_SON = get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, 9)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="vEKsQdHUYTUTBuiQcGYaQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>INFO - 2025-11-11T14:49:33Z - Selected dataset version: &quot;202311&quot;
INFO - 2025-11-11T14:49:33Z - Selected dataset part: &quot;default&quot;
WARNING - 2025-11-11T14:49:34Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.005064010620117, 45.994937896728516]
WARNING - 2025-11-11T14:49:34Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-5.9935760498046875, 36.49357604980469]
WARNING - 2025-11-11T14:49:34Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.005064010620117, 45.994937896728516]
WARNING - 2025-11-11T14:49:34Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-5.9935760498046875, 36.49357604980469]
INFO - 2025-11-11T14:49:35Z - Selected dataset version: &quot;202311&quot;
INFO - 2025-11-11T14:49:35Z - Selected dataset part: &quot;default&quot;
INFO - 2025-11-11T14:49:36Z - Selected dataset version: &quot;202411&quot;
INFO - 2025-11-11T14:49:36Z - Selected dataset part: &quot;default&quot;
INFO - 2025-11-11T14:49:37Z - Selected dataset version: &quot;202411&quot;
INFO - 2025-11-11T14:49:37Z - Selected dataset part: &quot;default&quot;
WARNING - 2025-11-11T14:49:37Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.125, 46.025001525878906]
WARNING - 2025-11-11T14:49:37Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-18.125, 36.32500076293945]
WARNING - 2025-11-11T14:49:37Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.125, 46.025001525878906]
WARNING - 2025-11-11T14:49:37Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-18.125, 36.32500076293945]
INFO - 2025-11-11T14:49:38Z - Selected dataset version: &quot;202411&quot;
INFO - 2025-11-11T14:49:38Z - Selected dataset part: &quot;default&quot;
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
</span></code></pre></div></div></div></div><div id="aRbIro2FXg" class="myst-jp-nb-block relative group/block"><h4 id="applying-k-means-clustering-to-seasonal-variables" class="relative group"><span class="heading-text">Applying K-means clustering to seasonal variables</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#applying-k-means-clustering-to-seasonal-variables" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="Avv0GWxrm5" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Loading clusters centroids and labels
kmeans = joblib.load(&#x27;kmeans.joblib&#x27;)
labels = joblib.load(&#x27;labels.joblib&#x27;)

# Clusters prediction
labels_DJF = kmeans.predict(variables_DJF)
labels_MAM = kmeans.predict(variables_MAM)
labels_JJA = kmeans.predict(variables_JJA)
labels_SON = kmeans.predict(variables_SON)

da_DJF = masking_labels(labels_DJF)
da_MAM = masking_labels(labels_MAM)
da_JJA = masking_labels(labels_JJA)
da_SON = masking_labels(labels_SON)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="vgtHpJUAm3X7QMbW2cl1U" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qAPpLKp52E" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Dumping to csv
djf_path = xarr_to_csv(&#x27;DJF_clusters&#x27;, da_DJF)
mam_path = xarr_to_csv(&#x27;MAM_clusters&#x27;, da_MAM)
jja_path = xarr_to_csv(&#x27;JJA_clusters&#x27;, da_JJA)
son_path = xarr_to_csv(&#x27;SON_clusters&#x27;, da_SON)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="bR1ADazZktG9xNHepPkhg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XsR1AWxTkv" class="myst-jp-nb-block relative group/block"><h4 id="visualization-of-seasonal-clusters" class="relative group"><span class="heading-text">Visualization of seasonal clusters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualization-of-seasonal-clusters" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="TFQciB1rsf" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Loading seasonal clusters
da_DJF = csv_to_xarray(djf_path, &#x27;DJF_clusters&#x27;)
da_MAM = csv_to_xarray(mam_path, &#x27;MAM_clusters&#x27;)
da_JJA = csv_to_xarray(jja_path, &#x27;JJA_clusters&#x27;)
da_SON = csv_to_xarray(son_path, &#x27;SON_clusters&#x27;)

# Plotting
fig = plt.figure(figsize=(15, 17))
#fig.suptitle(&#x27;Seasonal cycle of clusters&#x27;, y=0.6, fontsize=23)

ax = fig.add_subplot(121, projection=ccrs.PlateCarree())
ax.coastlines(zorder=4)
ax.add_feature(cfeature.LAKES, zorder=3)
ax.add_feature(cfeature.RIVERS, zorder=3)
pc = ax.pcolormesh(da_DJF.longitude,da_DJF.latitude, da_DJF, cmap=&#x27;Accent&#x27;)
gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color=&#x27;k&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;)
gl.xformatter = LONGITUDE_FORMATTER
gl.yformatter = LATITUDE_FORMATTER
cbar = plt.colorbar(pc, ax=ax, label=&#x27;Cluster&#x27;, pad=0.15, shrink=0.15)
cbar.set_ticks(np.arange(0,8,1))
ax.set_title(&#x27;DJF&#x27;, fontsize=16, weight=&#x27;bold&#x27;)


ax2 = fig.add_subplot(122, projection=ccrs.PlateCarree())
pc2 = ax2.pcolormesh(da_MAM.longitude,da_MAM.latitude,da_MAM, cmap=&#x27;Accent&#x27;, zorder=2)
ax2.coastlines(zorder=4)
ax2.add_feature(cfeature.LAKES, zorder=3)
ax2.add_feature(cfeature.RIVERS, zorder=3)
gl = ax2.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color=&#x27;k&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;)
gl.xformatter = LONGITUDE_FORMATTER
gl.yformatter = LATITUDE_FORMATTER
cbar = plt.colorbar(pc2, ax=ax2, label=&#x27;Cluster&#x27;, pad=0.15, shrink=0.15)
cbar.set_ticks(np.arange(0,8,1))
ax2.set_title(&#x27;MAM&#x27;, fontsize=16, weight=&#x27;bold&#x27;)
plt.tight_layout()
plt.savefig(&#x27;Seasonal_clustering_DJF-MAM.png&#x27;,bbox_inches=&#x27;tight&#x27;)
#plt.show()

fig = plt.figure(figsize=(15, 17))
ax = fig.add_subplot(121, projection=ccrs.PlateCarree())
ax.coastlines(zorder=4)
ax.add_feature(cfeature.LAKES, zorder=3)
ax.add_feature(cfeature.RIVERS, zorder=3)
pc = ax.pcolormesh(da_JJA.longitude,da_JJA.latitude, da_JJA, cmap=&#x27;Accent&#x27;)
gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color=&#x27;k&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;)
gl.xformatter = LONGITUDE_FORMATTER
gl.yformatter = LATITUDE_FORMATTER
cbar = plt.colorbar(pc, ax=ax, label=&#x27;Cluster&#x27;, pad=0.15, shrink=0.15)
cbar.set_ticks(np.arange(0,8,1))
ax.set_title(&#x27;JJA&#x27;, fontsize=16, weight=&#x27;bold&#x27;)

ax2 = fig.add_subplot(122, projection=ccrs.PlateCarree())
pc2 = ax2.pcolormesh(da_SON.longitude,da_SON.latitude,da_SON, cmap=&#x27;Accent&#x27;, zorder=2)
ax2.coastlines(zorder=4)
ax2.add_feature(cfeature.LAKES, zorder=3)
ax2.add_feature(cfeature.RIVERS, zorder=3)
gl = ax2.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color=&#x27;k&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;)
gl.xformatter = LONGITUDE_FORMATTER
gl.yformatter = LATITUDE_FORMATTER
cbar = plt.colorbar(pc2, ax=ax2, label=&#x27;Cluster&#x27;, pad=0.15, shrink=0.15)
cbar.set_ticks(np.arange(0,8,1))
ax2.set_title(&#x27;SON&#x27;, fontsize=16, weight=&#x27;bold&#x27;)
plt.tight_layout()
plt.savefig(&#x27;Seasonal_clustering_JJA-SON.png&#x27;,bbox_inches=&#x27;tight&#x27;)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ntBMq0-NWdC294AKvMrqp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/0b3f97014424dbb077655fa9ee814a37.png" alt="&lt;Figure size 1500x1700 with 4 Axes&gt;"/></div><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/a5eb3b3e601cbe9ab299d0fbcce63c08.png" alt="&lt;Figure size 1500x1700 with 4 Axes&gt;"/></div></div></div><div id="bg4Dia8baW" class="myst-jp-nb-block relative group/block"><ul><li><p>Cluster 1 (violet) - Eutrophic Water: - Colder waters - Eastward Winds - Medium Chlorophyll-a content</p></li><li><p>Cluster 2 (orange) - Coastal Water: - Very high Chlorophyll-a - Sea Surface Height</p></li><li><p>Cluster 7 (grey) - Oligotrophic Water: - Warmer waters - Northward wind and wind stress - Low Chlorophyll-a Conten</p></li></ul></div><div id="IZzkhBltQX" class="myst-jp-nb-block relative group/block"><h4 id="percentage-change-of-seasonal-clusters" class="relative group"><span class="heading-text">Percentage change of seasonal clusters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#percentage-change-of-seasonal-clusters" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="zwV1Omy821" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">DJF_1 = sum(sum(da_DJF == 1))
DJF_2 = sum(sum(da_DJF == 2))
DJF_7 = sum(sum(da_DJF == 7))

MAM_1 = sum(sum(da_MAM == 1))
MAM_2 = sum(sum(da_MAM == 2))
MAM_7 = sum(sum(da_MAM == 7))

JJA_1 = sum(sum(da_JJA == 1))
JJA_2 = sum(sum(da_JJA == 2))
JJA_7 = sum(sum(da_JJA == 7))

SON_1 = sum(sum(da_SON == 1))
SON_2 = sum(sum(da_SON == 2))
SON_7 = sum(sum(da_SON == 7))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="TcmDgqPFsdj8BLBgGgYmD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="uzHJGjT8is" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cluster_1 = [(JJA_1-JJA_1)/JJA_1, (SON_1-JJA_1)/JJA_1, (DJF_1-JJA_1)/JJA_1, (MAM_1-JJA_1)/JJA_1]
cluster_2 = [(JJA_2-JJA_2)/JJA_2, (SON_2-JJA_2)/JJA_2, (DJF_2-JJA_2)/JJA_2, (MAM_2-JJA_2)/JJA_2]
cluster_7 = [(JJA_7-JJA_7)/JJA_7, (SON_7-JJA_7)/JJA_7, (DJF_7-JJA_7)/JJA_7, (MAM_7-JJA_7)/JJA_7]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="dsa0WgbJ3phFdOoJXn-vU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="kX0XoJXZch" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Plotting results
fig = plt.figure(figsize = (12,4))
fig.suptitle(&#x27;Seasonal cycle of clusters\nPercentage Change&#x27;, y=1, fontsize=15)
plt.plot(cluster_1, label = &#x27;Cluster 1 - Eutrophic Water&#x27;, color = &#x27;tab:purple&#x27;)
plt.plot(cluster_2, label = &#x27;Cluster 2 - Coastal Water&#x27;, color = &#x27;tab:orange&#x27;)
plt.plot(cluster_7, label = &#x27;Cluster 7 - Oligotrophic Water&#x27;, color = &#x27;tab:gray&#x27;)
plt.xticks([0,1,2,3], [&#x27;Summer&#x27;,&#x27;Autumn&#x27;,&#x27;Winter&#x27;,&#x27;Spring&#x27;])
plt.ylabel(&#x27;Percentage Change&#x27;)
plt.legend(loc=&#x27;lower left&#x27;, fontsize=&#x27;small&#x27;)

plt.savefig(&#x27;SeasonalClusters_percentage-change.png&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="VhASwjFMpdtQ1yxkTYdIc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/eodashboard-notebooks/build/68fc7ceee0ff3b65ca4f202bb3be17e2.png" alt="&lt;Figure size 1200x400 with 1 Axes&gt;"/></div></div></div><div id="J12XBVgjsM" class="myst-jp-nb-block relative group/block"><p><a class="link" href="/eodashboard-notebooks#toc">Back to Table of Contents</a></p></div><div class="myst-backmatter-parts"></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/eodashboard-notebooks/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-G62B6HZR.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/root-PMP5BIHC.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-IX5KPAHP.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/routes/$-5ZLZ2O3Y.js"/><script>window.__remixContext = {"url":"/notebooks/oceanographic-patterns-clustering","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.8.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true,"style":"/eodashboard-notebooks/build/custom-372de37690cfb47f22816bb0c23eb657.css"},"nav":[],"actions":[],"projects":[{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-efdd7d7042b27d54684a1811fc755d02.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.oceanographic-patterns-clustering","title":"K-means clustering analysis of oceanographic patterns in the Mediterranean Sea","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-1d318eb5521a50ad6b7e4f73355e792b.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/eodashboard-notebooks"},"routes/$":{"config":{"version":3,"myst":"1.8.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true,"style":"/eodashboard-notebooks/build/custom-372de37690cfb47f22816bb0c23eb657.css"},"nav":[],"actions":[],"projects":[{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-efdd7d7042b27d54684a1811fc755d02.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.oceanographic-patterns-clustering","title":"K-means clustering analysis of oceanographic patterns in the Mediterranean Sea","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-1d318eb5521a50ad6b7e4f73355e792b.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"page":{"version":3,"kind":"Notebook","sha256":"64690791c468d8fb47ac01dac91bc4617ee425af4cbca934e2d80cb5d44478b3","slug":"notebooks.oceanographic-patterns-clustering","location":"/notebooks/Oceanographic patterns clustering.ipynb","dependencies":[],"frontmatter":{"title":"K-means clustering analysis of oceanographic patterns in the Mediterranean Sea","content_includes_title":false,"kernelspec":{"name":"conda-env-users-deepesdl-xcube-1.11.0-py","display_name":"users-deepesdl-xcube-1.11.0","language":"python"},"github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","subject":"Notebook examples","numbering":{"title":{"offset":1}},"source_url":"https://github.com/ESA-eodashboards/eodashboard-notebooks/blob/main/notebooks/Oceanographic patterns clustering.ipynb","edit_url":"https://github.com/ESA-eodashboards/eodashboard-notebooks/edit/main/notebooks/Oceanographic patterns clustering.ipynb","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","exports":[{"format":"ipynb","filename":"Oceanographic patterns clustering.ipynb","url":"/eodashboard-notebooks/build/Oceanographic patter-7b61572ddcff7ae6d826602a1a78a562.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","alt":"Sept-2025-Venice-Edinburgh-Leeds.jpg","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eqDsnkVX5I","urlSource":"data:image/jpeg;base64,/9j/4AAQSk...KKAP/2Q==\n"}],"key":"pEZylh45Ep"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dPlPtYUkgK"}],"key":"SpXFp6HzLq"},{"type":"break","key":"wAjtL9CW6b"},{"type":"text","value":"\nThis notebook has been developed and validated on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZReJYPcjNt"},{"type":"link","url":"https://deepesdl.readthedocs.io/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DeepESDL","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qlkVEvk0m4"}],"key":"OJXYDRvONF"}],"urlSource":"https://deepesdl.readthedocs.io/en/latest/","key":"CQKR06aXEz"},{"type":"text","value":" environment, where the necessary data, tools, and execution kernels are available. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IMaIGTM9Ip"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DeepESDL","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MzaYoqmst6"}],"key":"OOcHphroti"},{"type":"text","value":" is part of ESA’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LZqvJItCQh"},{"type":"link","url":"https://earthcode.esa.int","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EarthCODE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qdqDrVDevG"}],"key":"gNb20J7OrD"},{"type":"text","value":" initiative","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WuKhCyCyVv"}],"urlSource":"https://earthcode.esa.int","key":"vVYYK303vr"},{"type":"text","value":", enabling open and reproducible Earth Science. Sponsored access can be requested through ESA’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nDHOs8RK43"},{"type":"link","url":"https://nor-discover.org/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Network of Resources","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UjgUti2txI"}],"key":"Qp8beSROCj"}],"urlSource":"https://nor-discover.org/","key":"rdCAYXaC1r"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"imbopqRsrC"}],"key":"jcvDxA29Y7"}],"key":"DTl0bjL6kv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"OxI43eGmOw"}],"key":"A7GRZrDqu2"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Table of Contents","key":"VFq75OWLOo"}],"key":"rmLmX5VMHt"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aD3RywQHDJ"}],"identifier":"table-of-contents","label":"Table of Contents ","html_id":"table-of-contents","implicit":true,"key":"FwsrqyxZtA"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Title","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FRIDctEph1"}],"identifier":"title","label":"title","kind":"heading","template":"{name}","resolved":true,"html_id":"title","key":"aKjVpjUIRc"}],"key":"mJnogAdXNQ"}],"key":"bDYnX3JU9E"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IsIS8EHWKV"}],"identifier":"description","label":"description","kind":"heading","template":"{name}","resolved":true,"html_id":"description","key":"KO38H1oNH6"}],"key":"nFoimKOfg1"}],"key":"mhZUVXCTOw"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"axi0OLWQg2"}],"identifier":"references","label":"references","kind":"heading","template":"{name}","resolved":true,"html_id":"references","key":"N3cD166emp"}],"key":"hcpVb42aAJ"}],"key":"CDES3T0igf"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#conclusions","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Key Conclusions","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"s4uvXDLUxE"}],"urlSource":"#conclusions","key":"mUrUqx0v02"}],"key":"pskfZubrAo"}],"key":"IgziGc79vw"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#context","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Societal Context","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tWL5pUrYhB"}],"urlSource":"#context","key":"nidP4iXibv"}],"key":"HeDgdzEuTE"}],"key":"ePufrHIVLZ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#libraries","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Python Libraries","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XFdNaDlAsr"}],"urlSource":"#libraries","key":"qix7ggTfN7"}],"key":"Z9JS59fw6C"}],"key":"hOHGKI7gFw"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#inputs","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Data Sources","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OX8OKLHVIn"}],"urlSource":"#inputs","key":"ZBF6PWAyZv"}],"key":"uieywNpoPZ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#combo","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Combining input data","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ElQVWVzMQt"}],"urlSource":"#combo","key":"pE0M1TRcv5"}],"key":"tkxaFhAK8s"}],"key":"K2pyZZoqAq"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#visuals","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Visualizing input data","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Fwnlj23C4R"}],"urlSource":"#visuals","key":"Utn7eOXCKd"}],"key":"AFCkvlCP89"}],"key":"klIwTs9VxD"}],"key":"Zlg96PR6iv"}],"key":"zHarDmQFGC"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Analysis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"itSBvoo14M"}],"identifier":"analysis","label":"analysis","kind":"heading","template":"{name}","resolved":true,"html_id":"analysis","key":"z9zEY6w248"}],"key":"zaaO7MxTcx"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#utility","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Utility functions","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"IH3QASJv8G"}],"urlSource":"#utility","key":"JjmNoYoLlD"}],"key":"BsOerkqfq7"}],"key":"DvSRuNee2n"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#kmeans","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"K-means implementation","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"N23Npc0sQb"}],"urlSource":"#kmeans","key":"VH6t4xMngo"}],"key":"Ci7RSpfPlT"}],"key":"YPo1jsDcKV"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#monthly","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Monthly clustering","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"bQ1hE1VzND"}],"urlSource":"#monthly","key":"xAkxOiiw23"}],"key":"MgjVCybNke"}],"key":"YKc0mpEmn9"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#seasonal","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Seasonal clustering","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"G5n0BvDrwc"}],"urlSource":"#seasonal","key":"oA7uYqxgOQ"}],"key":"iEqcZcBAPn"}],"key":"n1Iaq6ClQe"}],"key":"BoN3PPLcvS"}],"key":"KavlCTAa74"}],"key":"KX5WwAgNbX"}],"key":"BeqvGY2uSn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"B8SKo2MlYe"}],"key":"UGjglPSSUY"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Title","key":"GPBS6BaDHM"}],"key":"JipKM0sDNP"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P3tByGXZEb"}],"identifier":"title","label":"Title ","html_id":"title","implicit":true,"key":"qqD7esINS3"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Challenge: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JaSLVFT5QW"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"K-means clustering analysis of oceanographic patterns in the Mediterranean Sea","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UVkcraL6MM"}],"key":"TUC9X0kwEC"}],"identifier":"challenge-k-means-clustering-analysis-of-oceanographic-patterns-in-the-mediterranean-sea","label":"Challenge: K-means clustering analysis of oceanographic patterns in the Mediterranean Sea","html_id":"challenge-k-means-clustering-analysis-of-oceanographic-patterns-in-the-mediterranean-sea","implicit":true,"key":"mTHmSBOdXs"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Authors:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LM0e8CWsJU"}],"key":"S7zldiewwl"}],"key":"cBS4CH8Fbk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Katie Lowery","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xe5EdTbwWu"}],"key":"SfMHCPFWa1"},{"type":"text","value":", British Antarctic Survey (BAS), Cambridge, United Kingdom of Great Britain","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RaP9rgQx8L"}],"key":"sMobPuBltG"}],"key":"TFfE2l8kmg"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"William Luty","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tLh0VzAeoi"}],"key":"QJBM2dr8tk"},{"type":"text","value":" , University of Leeds, Leeds, United Kingdom of Great Britain - England, Scotland, Wales","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ykcEdBwH4x"}],"key":"CvLekIiRHF"}],"key":"zZ11Cd3D03"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Enrico Biscaro","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TttzC5XBSX"}],"key":"RjFWNRy0Zx"},{"type":"text","value":", Ca’ Foscari University of Venice, Italy ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XGgBmC1kPd"},{"type":"break","key":"qCew6GQlw5"}],"key":"qVq5rkySRh"}],"key":"ZtZVYOCEDz"}],"key":"RBj7bAAyOf"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"NKjo4AORPT"}],"urlSource":"#toc","key":"YkwktcoEpU"}],"key":"jNCgKL60sL"}],"key":"MwgobFpXMR"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"gvys5aFcdU"}],"key":"irtViZVQPb"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Description","key":"wjEWsjJD2m"}],"key":"y60fimm9g8"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N1tAIAWZU0"}],"identifier":"description","label":"Description ","html_id":"description","implicit":true,"key":"zG22u80wgx"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Scientific problem","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ylZqAzRBlz"}],"identifier":"scientific-problem","label":"Scientific problem","html_id":"scientific-problem","implicit":true,"key":"djKkjux3bX"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Ocean water types - such as coastal, upwelling, oligotrophic, and eutrophic  waters - exhibit distinct spectral and biogeochemical characteristics. Classifying  these types is essential for understanding marine ecosystems, monitoring water  quality, and supporting climate and fisheries research. This challenge leverages ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zCvQ4ScaaB"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"EO data","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KBjYZO0KoN"}],"key":"uDEH05v9cB"},{"type":"text","value":" and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Fg5IdYce8S"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"unsupervised learning","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WuI1OR6Lln"}],"key":"RI05Nn8YyL"},{"type":"text","value":" to classify ocean water types based on spectral reflectance and derived indices.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"O8M0qKptdk"}],"key":"sRTKiUh9BG"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Objective","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DA9ffa3jUQ"}],"identifier":"objective","label":"Objective","html_id":"objective","implicit":true,"key":"OOqgxI8gLh"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ls688kecu4"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"clustering algorithms","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"C9MjUs7Jjt"}],"key":"QGLU0fJllC"},{"type":"text","value":" to classify ocean water types from EO spectral  bands and indices. Validate clusters against known oceanographic features or water classifications and produce a map of water types for a selected region.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"c67pa05Ons"}],"key":"R3jbqPfLTY"},{"type":"heading","depth":3,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Method","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"XhTfmjKImc"}],"identifier":"method","label":"Method","html_id":"method","implicit":true,"key":"lMtPIRi2qB"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"K-means clustering.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jHteIf1K8P"}],"key":"F8SJFh907o"},{"type":"heading","depth":4,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Clustering optimization technique","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"EdjK14LTq4"}],"identifier":"clustering-optimization-technique","label":"Clustering optimization technique","html_id":"clustering-optimization-technique","implicit":true,"key":"MduMfn7h6E"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Elbow method: to determine the optimal number of clusters to use.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"KxfTlGPmGR"}],"key":"Z4GPyi6VGx"}],"key":"NOvZMttgqZ"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Optimization metric: Inertia (Sum of Squared Errors)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"n4OOmUOykG"}],"key":"py94OyPnOB"}],"key":"eUXYQgsXou"}],"key":"AYL0l6nkgs"},{"type":"heading","depth":3,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Service used","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"jr3sE55jC7"}],"identifier":"service-used","label":"Service used","html_id":"service-used","implicit":true,"key":"GV7vUjHxaS"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"link","url":"https://marine.copernicus.eu/","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Copernicus Marine Service","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"svZEIpMjSW"}],"urlSource":"https://marine.copernicus.eu/","key":"YDzBmKByij"},{"type":"text","value":".","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"hjU1EFoJgU"}],"key":"LfYyiU1wiq"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Use case: Mediterranean Sea","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"h7MqE5ZkLZ"}],"identifier":"use-case-mediterranean-sea","label":"Use case: Mediterranean Sea","html_id":"use-case-mediterranean-sea","implicit":true,"key":"DFVm3VSoO5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Optimizing fish harvesting while preserving fish populations and  marine biodiversity in the Mediterranean","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"dfrk97YaTF"}],"key":"I8J0p50auL"}],"key":"M9sDhGrhHQ"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Monitoring physico-chemical parameters of the Mediterranean Sea in a climate change scenario also considering its contribution to the Atlantic Meridional Overturning Circulation (AMOC)","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"B8OsHZM5nZ"}],"key":"Rs6hql50Sk"}],"key":"MIPixGMCN5"}],"key":"cpCcq5lGAq"},{"type":"image","url":"/eodashboard-notebooks/build/5eae0210320dbf26b5e6545ec68c0514.jpeg","alt":"Clustering_use-case.JPG","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ezLWNhOH3Z","urlSource":"data:image/jpeg;base64,/9j/4AAQSk...AooooA/9k="},{"type":"heading","depth":3,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Processing workflow","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"EQmjRjm7TV"}],"identifier":"processing-workflow","label":"Processing workflow","html_id":"processing-workflow","implicit":true,"key":"zqD57xCodI"},{"type":"image","url":"/eodashboard-notebooks/build/f46649713c7cc868512dd6ec1895727f.jpeg","alt":"kmeans-clustering_cmems.JPG","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"Cv2z7h6CAl","urlSource":"data:image/jpeg;base64,/9j/4AAQSk...ooooA//9k="},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"Esm8i7VI0n"}],"urlSource":"#toc","key":"wbbsoAlvau"}],"key":"B5YisbtwyY"}],"visibility":"show","key":"vwLJzXX94H"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"ApA0HDX9n6"}],"key":"fB7HPAXqqe"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"References","key":"wWK8z7DLSY"}],"key":"V2ierhONAZ"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d65eYakEyP"}],"identifier":"references","label":"References ","html_id":"references","implicit":true,"key":"yfuyrfcbl5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Berthon, J.-F., Zibordi, G.: Bio-optical relationships for the northern Adriatic Sea. Int. J. Remote Sens., 25, 1527-1532, 2004","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"azRWt6knSl"}],"key":"JeLvQXE6BL"}],"key":"hSrz4cTlhI"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Buongiorno Nardelli, B., R. Droghei, and R. Santoleri, (2016): Multi-dimensional interpolation of SMOS sea\nsurface salinity with surface temperature and in situ salinity data. Rem. Sens. Environ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dCKgrThNbc"}],"key":"sBIIbJRZ7e"}],"key":"fIy0gQCnsd"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Droghei, R., B. Buongiorno Nardelli, and R. Santoleri, 2016: Combining in-situ and satellite observations to\nretrieve salinity and density at the ocean surface. J. Atmos. Oceanic Technol.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SBAUCNJKQr"}],"key":"nmz5InuQyq"}],"key":"iGkYWcy2eH"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Embury, O., Merchant, C.J., Good, S.A., Rayner, N.A., Høyer, J.L., Atkinson, C., Block, T., Alerskans, E.,\nPearson, K.J., Worsfold, M., McCarroll, N., Donlon, C., (2024). Satellite-based time-series of sea-surface\ntemperature since 1980 for climate applications. Sci Data 11, 326","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ir0LXdhhxF"}],"key":"dDx8dzfHDT"}],"key":"BO9GAz3pAF"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Pisano, A., Nardelli, B. B., Tronconi, C., \u0026 Santoleri, R. (2016). The new Mediterranean optimally interpolated pathfinder AVHRR SST Dataset (1982–2012). Remote Sensing of Environment, 176, 107-116","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Lccfzu4XVZ"}],"key":"ea9vZswhjG"}],"key":"qFDO82aCv9"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sammartino, Michela, Salvatore Aronica, Rosalia Santoleri, and Bruno Buongiorno Nardelli. (2022). Retrieving\nMediterranean Sea Surface Salinity Distribution and Interannual Trends from Multi-Sensor Satellite and In Situ\nData, Remote Sensing 14, 250","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Gr7gLdbnqg"}],"key":"ZbJZVDLWZ1"}],"key":"krmEzMmXLa"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Volpe, G., Buongiorno Nardelli, B., Colella, S., Pisano, A. and Santoleri, R. (2018). An Operational\nInterpolated Ocean Colour Product in the Mediterranean Sea, in New Frontiers in Operational Oceanography,\nedited by E. P. Chassignet, A. Pascual, J. Tintorè, and J. Verron, pp. 227–244z","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"S9qxS3jSKt"}],"key":"TCeTyf5I9u"}],"key":"jDmpR6MGoX"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Volpe, G., Colella, S., Brando, V. E., Forneris, V., Padula, F. L., Cicco, A. D., ... \u0026 Santoleri, R. (2019). Mediterranean ocean colour Level 3 operational multi-sensor processing. Ocean Science, 15(1), 127-146","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"jdo9r3bcfi"}],"key":"EGxTwZG8um"}],"key":"DHugqxq9tF"}],"key":"YmfQ5c3aPp"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"CF83JsBBv8"}],"urlSource":"#toc","key":"GhyLsEMD1i"}],"key":"VZRLqdfhBw"}],"key":"pw3ay5pTIR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"ZWDifORNCt"}],"key":"d9NqLandc1"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Key Conclusions","key":"HpuIOy9iNY"}],"key":"wUzXqwrems"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HMjm77kw2h"}],"identifier":"key-conclusions","label":"Key Conclusions ","html_id":"key-conclusions","implicit":true,"key":"l8zmTNGS0U"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This study demonstrates the effectiveness of unsupervised clustering for identifying and mapping ocean water types from multi-parameter satellite observations. Key findings include:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sFhnDhFDmA"}],"key":"pqWv1DJ5js"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Three distinct water types identified","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Y0Rtc5673J"}],"key":"aDdPRpp8ML"},{"type":"text","value":": Coastal (high productivity), eutrophic (moderate productivity), and oligotrophic (low productivity) waters distinguished by combined biological, physical, and atmospheric characteristics","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pmjrvUSu72"}],"key":"YfrXYErfYv"}],"key":"jYrvEb3xAp"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Geographic coherence","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vZfAYlzKE0"}],"key":"U2Png1MJIr"},{"type":"text","value":": Spatial patterns align with known Mediterranean oceanography, validating the clustering approach against established understanding","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hwPYSrTA71"}],"key":"vnkjxqhRrn"}],"key":"hw1rCvNpWW"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Seasonal dynamics captured","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"la24Paa0me"}],"key":"nevGI6lkYu"},{"type":"text","value":": Temporal analysis reveals expansion/contraction of water types consistent with seasonal stratification and mixing cycles","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"neYO9jZeGo"}],"key":"XoQrXo45iw"}],"key":"Am2v5ckLa4"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Multi-parameter synergy","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FM63E4N2QD"}],"key":"nxd5Ekruwe"},{"type":"text","value":": Integration of chlorophyll-a, SST, sea level height, and wind components provides richer characterization than single-parameter approaches","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"fBVJpeCsDf"}],"key":"aMUnHb6vl4"}],"key":"OHm1vJVijG"}],"key":"IUIDzeGwU3"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Study limitations and future directions:","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mQZZbvPZnm"}],"key":"QjOI2IfwWh"}],"key":"ImvOia4glU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Cluster number selection","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ivQVbQ3oIS"}],"key":"soskCiyB5Y"},{"type":"text","value":": Statistical optimum (5 clusters) provided insufficient detail, while chosen number (8) resulted in only 3 active clusters—suggesting need for adaptive cluster selection methods","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"CaIvKluG68"}],"key":"VdboogUHhN"}],"key":"ONGn0aTR9f"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Coastal water stability","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"frj853yFLW"}],"key":"fLnyFTt1mG"},{"type":"text","value":": Lack of seasonal variation in Cluster 2 (coastal waters) may indicate need for higher temporal resolution or separate coastal-specific analysis","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"tmfcCS9uBl"}],"key":"EbF8hJTkKD"}],"key":"kPxhqBffIX"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Validation needed","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ZeZPXgM4pP"}],"key":"FPp9PHRYvE"},{"type":"text","value":": No quantitative validation against in-situ measurements or existing water type classifications was performed","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ngrD10jKfa"}],"key":"Vk0JmBu6mT"}],"key":"KSIR29FInW"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Algorithm exploration","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"XPWnfwA7Np"}],"key":"NLvc2Le86y"},{"type":"text","value":": Testing alternative clustering methods (hierarchical, DBSCAN, Gaussian mixture models) could improve classification","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"rBOQ6jeby5"}],"key":"PBTKYUJMJ7"}],"key":"IMb3gq8Sih"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Additional parameters","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"uXWp0rlYyC"}],"key":"YJWE1FuT9Z"},{"type":"text","value":": Including sea surface salinity, turbidity, or fluorescence line height could enhance water type discrimination","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"hUfUN0kxsV"}],"key":"zsvcFItkGq"}],"key":"aNekHQKoXC"}],"key":"FW2PevC06V"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Future work priorities:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"yqBWanRkES"}],"key":"hpj0iNFKua"}],"key":"qppG1y9SA8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Extend analysis to other ocean basins for method generalization","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"y82mYLGOVy"}],"key":"VcgztRDNXk"}],"key":"Iy5TKIg8NK"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Incorporate in-situ validation data from research cruises and Argo floats","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"OyXQ6BHPZ1"}],"key":"CkjVJUQMQ5"}],"key":"lZm4FcdsU3"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Develop operational products for near-real-time water type mapping","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"hU3pudW7Dn"}],"key":"tiycUlJw6m"}],"key":"HI6wEbaYlr"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Investigate machine learning approaches for temporal prediction of water type transitions","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"JLQsCZ2xxb"}],"key":"KMX5fYAUxD"}],"key":"WSfMi8WbK3"}],"key":"ABl5XDzC5S"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"The framework established here provides a foundation for automated ocean water type classification from Earth observation data, with potential applications in operational oceanography, ecosystem monitoring, and climate change impact assessment.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"YApDwaGlpC"}],"key":"QbKvk6lwIr"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"BXqDiohGPq"}],"urlSource":"#toc","key":"PMq7vJUtd7"}],"key":"PXXVicLLjm"}],"key":"pLRqUli3Mb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"Eb8c9eRg0S"}],"key":"OFXVjQXsxQ"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Societal Context","key":"ManXDOKvE9"}],"key":"xzisIkdp8x"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jNXoLlm8yA"}],"identifier":"societal-context","label":"Societal Context ","html_id":"societal-context","implicit":true,"key":"Eke5NRfCfZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understanding marine ecosystems","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L1WUnlOsUV"}],"key":"LDXfp1Sqv3"}],"key":"q9WRgSfAcu"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Monitoring water quality","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GLLoqCgrRC"}],"key":"jLSmyrzTq0"}],"key":"VuxVNPEwRc"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Supporting climate and fisheries research by mapping productive zones","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Kn0E593zwt"}],"key":"AM1dNONNR9"}],"key":"R4s1X2Eps9"}],"key":"LjZi77dB9w"}],"key":"U8rRXwH2dQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"bFIwLxTIDI"}],"key":"HdDOpJZ7AI"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Import Libraries","key":"C2t4qnon8s"}],"key":"X83Rxmx9D9"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K6S6UpsW7p"}],"identifier":"import-libraries","label":"Import Libraries ","html_id":"import-libraries","implicit":true,"key":"JNWMMiK62e"}],"key":"ZPjuDzPylZ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom datetime import datetime\nimport os\nimport shapely.geometry\nimport xarray as xr\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler\nfrom IPython.display import JSON, display, HTML\nimport joblib\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\nfrom cartopy.mpl.gridliner import LONGITUDE_FORMATTER, LATITUDE_FORMATTER\nimport xcube_cmems\nfrom xcube.core.store import (\n    find_data_store_extensions,\n    get_data_store_params_schema,\n    new_data_store,\n)\nimport pandas as pd","visibility":"show","key":"to1xWQvlC9"},{"type":"outputs","id":"F3ysD7d2XrST4gFhAZyNN","children":[],"visibility":"show","key":"jnbMJs4Bzg"}],"visibility":"show","key":"muxsRZMwt3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gxXVYOWMka"}],"urlSource":"#toc","key":"qfXtFiwTTu"}],"key":"LrBPENU3cT"}],"key":"ZidNDpKOPE"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"HCWkiWLJ9K"}],"key":"icCYp2CxEf"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Data sources","key":"a6KkNDSlHe"}],"key":"MuJ5laylun"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IsF5ydnnCD"}],"identifier":"data-sources","label":"Data sources ","html_id":"data-sources","implicit":true,"key":"BD3TAboY8y"}],"visibility":"show","key":"GPyKAW7Qwg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The table below shows the data products used with links to description, access source and classification attributes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b8YCnXruo5"}],"key":"yCYFZk1NQk"}],"key":"IIX8oIKX3k"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"df = pd.DataFrame({\n    \"Datacube name\": ['CMEMS', 'CMEMS', 'CMEMS', 'CMEMS', 'CMEMS'],\n    \"Variable description\": [\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/OCEANCOLOUR_MED_BGC_L4_MY_009_144/description\"\u003eCHL\u003c/a\u003e',\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/MULTIOBS_GLO_PHY_S_SURFACE_MYNRT_015_013/description\"\u003eSOS\u003c/a\u003e',\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/SEALEVEL_EUR_PHY_L4_MY_008_068/description\"\u003eSLA\u003c/a\u003e',\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/SST_MED_SST_L4_REP_OBSERVATIONS_010_021/description\"\u003eSST\u003c/a\u003e',\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/WIND_GLO_PHY_CLIMATE_L4_MY_012_003/description\"\u003eWind\u003c/a\u003e',\n    ],\n    \"Data access\": [\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/OCEANCOLOUR_MED_BGC_L4_MY_009_144/services\"\u003esource\u003c/a\u003e',\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/MULTIOBS_GLO_PHY_S_SURFACE_MYNRT_015_013/services\"\u003esource\u003c/a\u003e',\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/SEALEVEL_EUR_PHY_L4_MY_008_068/services\"\u003esource\u003c/a\u003e',\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/SST_MED_SST_L4_REP_OBSERVATIONS_010_021/services\"\u003esource\u003c/a\u003e',\n        '\u003ca href=\"https://data.marine.copernicus.eu/product/WIND_GLO_PHY_CLIMATE_L4_MY_012_003/services\"\u003esource\u003c/a\u003e',\n    ],\n    \"Temporal extent\": ['Multi-year', 'Multi-year', 'Multi-year', 'Multi-year', 'Multi-year'],\n    \"Temporal resolution\": ['Daily,Monthly', 'Daily,Monthly', 'Daily,Monthly', 'Daily', 'Monthly'],\n    \"Spatial extent\": ['Mediterranean Sea','Global','Global','Mediterranean Sea','Global'],\n    \"Spatial resolution\": ['1 × 1 km','0.125° × 0.125°','0.0625° × 0.0625°','0.05° × 0.05°','0.25° × 0.25°'],\n})\n\ndisplay(HTML(df.to_html(escape=False, index=False)))","visibility":"show","key":"cZt5iYGd2S"},{"type":"outputs","id":"0nCnFRuOsHMRHsGvDwIgC","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003eDatacube name\u003c/th\u003e\n      \u003cth\u003eVariable description\u003c/th\u003e\n      \u003cth\u003eData access\u003c/th\u003e\n      \u003cth\u003eTemporal extent\u003c/th\u003e\n      \u003cth\u003eTemporal resolution\u003c/th\u003e\n      \u003cth\u003eSpatial extent\u003c/th\u003e\n      \u003cth\u003eSpatial resolution\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003eCMEMS\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/OCEANCOLOUR_MED_BGC_L4_MY_009_144/description\"\u003eCHL\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/OCEANCOLOUR_MED_BGC_L4_MY_009_144/services\"\u003esource\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003eMulti-year\u003c/td\u003e\n      \u003ctd\u003eDaily,Monthly\u003c/td\u003e\n      \u003ctd\u003eMediterranean Sea\u003c/td\u003e\n      \u003ctd\u003e1 × 1 km\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003eCMEMS\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/MULTIOBS_GLO_PHY_S_SURFACE_MYNRT_015_013/description\"\u003eSOS\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/MULTIOBS_GLO_PHY_S_SURFACE_MYNRT_015_013/services\"\u003esource\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003eMulti-year\u003c/td\u003e\n      \u003ctd\u003eDaily,Monthly\u003c/td\u003e\n      \u003ctd\u003eGlobal\u003c/td\u003e\n      \u003ctd\u003e0.125° × 0.125°\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003eCMEMS\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/SEALEVEL_EUR_PHY_L4_MY_008_068/description\"\u003eSLA\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/SEALEVEL_EUR_PHY_L4_MY_008_068/services\"\u003esource\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003eMulti-year\u003c/td\u003e\n      \u003ctd\u003eDaily,Monthly\u003c/td\u003e\n      \u003ctd\u003eGlobal\u003c/td\u003e\n      \u003ctd\u003e0.0625° × 0.0625°\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003eCMEMS\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/SST_MED_SST_L4_REP_OBSERVATIONS_010_021/description\"\u003eSST\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/SST_MED_SST_L4_REP_OBSERVATIONS_010_021/services\"\u003esource\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003eMulti-year\u003c/td\u003e\n      \u003ctd\u003eDaily\u003c/td\u003e\n      \u003ctd\u003eMediterranean Sea\u003c/td\u003e\n      \u003ctd\u003e0.05° × 0.05°\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003eCMEMS\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/WIND_GLO_PHY_CLIMATE_L4_MY_012_003/description\"\u003eWind\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003e\u003ca href=\"https://data.marine.copernicus.eu/product/WIND_GLO_PHY_CLIMATE_L4_MY_012_003/services\"\u003esource\u003c/a\u003e\u003c/td\u003e\n      \u003ctd\u003eMulti-year\u003c/td\u003e\n      \u003ctd\u003eMonthly\u003c/td\u003e\n      \u003ctd\u003eGlobal\u003c/td\u003e\n      \u003ctd\u003e0.25° × 0.25°\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"}}},"children":[],"key":"LIYydZrh9k"}],"visibility":"show","key":"ItcjSONTs7"}],"visibility":"show","key":"RQakqpoiwU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copernicus Marine Service data cubes ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BoOY4LW3WB"},{"type":"link","url":"https://data.marine.copernicus.eu/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"CMEMS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TMii3Lv2sH"}],"urlSource":"https://data.marine.copernicus.eu/","key":"i3Jp431JH0"},{"type":"text","value":" products have been accessed via xcube plugin from the CMEMS API. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YeJnhtSdzU"},{"type":"break","key":"qeR5ro6bHh"},{"type":"text","value":"Further information on the available data sources on DeepESDL with data access example notebooks can be found ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V1exQx6dDK"},{"type":"link","url":"https://earthsystemdatalab.net/data/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cggcQ9AgTs"}],"urlSource":"https://earthsystemdatalab.net/data/","key":"eUbKzGpw12"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XOd0xjj0aq"}],"key":"VQCuCI2pPr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QdvHGYoEmh"}],"urlSource":"#toc","key":"iOG1ni4h7l"}],"key":"P1X4Nnz61n"}],"key":"QBmaKP8H51"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"iCtICuYDGf"}],"key":"UYEaYhK8XB"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Combining input data","key":"h9BuQUHEXO"}],"key":"JTMQlkxsaW"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XFOjbBC4By"}],"identifier":"combining-input-data","label":"Combining input data ","html_id":"combining-input-data","implicit":true,"key":"yJ0rnaMKei"}],"key":"qRlSwA1a8S"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Loading and combining CMEMS oceanographic datasets","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KM2WasjO3F"}],"identifier":"loading-and-combining-cmems-oceanographic-datasets","label":"Loading and combining CMEMS oceanographic datasets","html_id":"loading-and-combining-cmems-oceanographic-datasets","implicit":true,"key":"P7ZOSPQ4N0"}],"visibility":"show","key":"tLk8bJjQIP"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def make_combined_dataset(time_selected = ['1998-01-01', '2023-11-01'], bounds = [-6,30,36.5,46], fill_nan_value = -9999, opt=False):\n    \n    cmems_store = new_data_store(\"cmems\")\n    ds_bgc = cmems_store.open_data('cmems_obs-oc_med_bgc-plankton_my_l4-multi-1km_P1M',\n                               variable_names = ['CHL'],\n                               time_range = time_selected,\n                               bbox = bounds)\n\n    ds_sal = cmems_store.open_data('cmems_obs-mob_glo_phy-sss_my_multi_P1M',\n                               variable_names = ['sos'],\n                               time_range = time_selected,\n                               bbox = bounds)\n\n    ds_ssh = cmems_store.open_data('cmems_obs-sl_eur_phy-ssh_my_allsat-l4-duacs-0.0625deg_P1M-m',\n                               variable_names = ['sla'],\n                               time_range = time_selected,\n                               bbox = bounds)\n\n    ds_sst = cmems_store.open_data('cmems_SST_MED_SST_L4_REP_OBSERVATIONS_010_021',\n                               variable_names = ['analysed_sst'],\n                               time_range = time_selected,\n                               bbox = bounds)\n    ds_sst = ds_sst.resample(time=\"MS\").mean()\n\n    ds_wind = cmems_store.open_data('cmems_obs-wind_glo_phy_my_l4_P1M',\n                               variable_names = ['eastward_wind', 'northward_wind', 'eastward_stress', 'northward_stress'],\n                               time_range = time_selected,\n                               bbox = bounds)\n    \n    ds_ssh = ds_ssh.interp(latitude = ds_sal['latitude'], longitude = ds_sal['longitude'])\n    ds_sst = ds_sst.interp(latitude = ds_sal['latitude'], longitude = ds_sal['longitude'])\n    ds_bgc = ds_bgc.interp(latitude = ds_sal['latitude'], longitude = ds_sal['longitude'])\n    ds_wind = ds_wind.interp(latitude = ds_sal['latitude'], longitude = ds_sal['longitude'])\n    \n    if opt:\n        ds_combined = xr.merge([ds_bgc, ds_ssh, ds_sst, ds_wind])\n    else:\n        ds_combined = xr.merge([ds_bgc, ds_ssh, ds_sal, ds_sst, ds_wind])\n    \n    return ds_combined","visibility":"show","key":"vVVy2aEeaH"},{"type":"outputs","id":"vE48DC1p6d72Vl21hzW3g","children":[],"visibility":"show","key":"GOJ0H3zFfc"}],"visibility":"show","key":"b8It0aIg3J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Defining input parameters for the combined dataset\ntime_selected = ['1998-01-01', '2023-11-01']\nbounds = [-6,30,36.5,46]\nfill_nan_value = -9999\nopt=True\n\nds_combined = make_combined_dataset(time_selected, bounds, fill_nan_value, opt)\nds_combined_m = ds_combined.where(~ds_combined['CHL'].isnull())","key":"QNeKy0Y6DH"},{"type":"outputs","id":"mU9kjMKhaKHnoKU-oeeBs","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"INFO - 2025-11-13T21:53:44Z - Selected dataset version: \"202311\"\nINFO - 2025-11-13T21:53:44Z - Selected dataset part: \"default\"\nWARNING - 2025-11-13T21:53:45Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.005064010620117, 45.994937896728516]\nWARNING - 2025-11-13T21:53:45Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-5.9935760498046875, 36.49357604980469]\nWARNING - 2025-11-13T21:53:45Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.005064010620117, 45.994937896728516]\nWARNING - 2025-11-13T21:53:45Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-5.9935760498046875, 36.49357604980469]\nINFO - 2025-11-13T21:53:46Z - Selected dataset version: \"202311\"\nINFO - 2025-11-13T21:53:46Z - Selected dataset part: \"default\"\nINFO - 2025-11-13T21:53:47Z - Selected dataset version: \"202411\"\nINFO - 2025-11-13T21:53:47Z - Selected dataset part: \"default\"\nINFO - 2025-11-13T21:53:48Z - Selected dataset version: \"202411\"\nINFO - 2025-11-13T21:53:48Z - Selected dataset part: \"default\"\nWARNING - 2025-11-13T21:53:48Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.125, 46.025001525878906]\nWARNING - 2025-11-13T21:53:48Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-18.125, 36.32500076293945]\nWARNING - 2025-11-13T21:53:48Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.125, 46.025001525878906]\nWARNING - 2025-11-13T21:53:48Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-18.125, 36.32500076293945]\nINFO - 2025-11-13T21:53:50Z - Selected dataset version: \"202411\"\nINFO - 2025-11-13T21:53:50Z - Selected dataset part: \"default\"\n"},"children":[],"key":"LpZqA0NMFh"}],"key":"EzRiTWVeUg"}],"key":"KWMZ7fGepQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YfoPrqcihX"}],"urlSource":"#toc","key":"CJcy80sbH8"}],"key":"vf8b0HD61v"}],"key":"LZp9ROWPz1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"lKbKIGbIgK"}],"key":"JPyre4il18"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Visualizing input data","key":"xRXlQd2Nye"}],"key":"Af66mpqKTo"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ijx0vUJnI3"}],"identifier":"visualizing-input-data","label":"Visualizing input data ","html_id":"visualizing-input-data","implicit":true,"key":"WZtUHYFiAg"}],"key":"Pfrg2DCnAh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualizing oceanographic input variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o7WwYj0IUl"}],"identifier":"visualizing-oceanographic-input-variables","label":"Visualizing oceanographic input variables","html_id":"visualizing-oceanographic-input-variables","implicit":true,"key":"UtxYvu0WY2"}],"key":"bZ2jVzNMOn"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_geo_input(\n    ax, lon, lat, data,\n    *,\n    projection=ccrs.PlateCarree(),\n    cmap=\"viridis\",\n    shading=\"auto\",\n    add_gridlines=True,\n    gridlines_kwargs=None,\n    coastline_kwargs=None,\n    colorbar=True,\n    cbar_label=\"\",\n    title=\"\",\n    vmin=None,\n    vmax=None,\n):\n    \n    # colormesh plot\n    pcm = ax.pcolormesh(\n        lon,\n        lat,\n        data,\n        transform=projection,\n        cmap=cmap,\n        shading=shading,\n        vmin=vmin,\n        vmax=vmax,\n    )\n\n    # coastlines\n    if coastline_kwargs is None:\n        ax.add_feature(cfeature.LAND)\n        ax.add_feature(cfeature.RIVERS)\n        ax.add_feature(cfeature.LAKES)\n        ax.coastlines()\n    else: \n        extra = coastline_kwargs.get(\"extra_features\", [])\n        for item in extra:\n            if isinstance(item, tuple):\n                feature, feat_kwargs = item\n            else:\n                feature, feat_kwargs = item, {}\n            ax.add_feature(feature, **feat_kwargs)\n            ax.coastlines(linewidth=0.7)\n\n    # gridlines\n    if add_gridlines:\n        if gridlines_kwargs is None:\n            gridlines_kwargs = dict(draw_labels=True, linestyle=\"--\", linewidth=0.5)\n        gl = ax.gridlines(crs=projection, **gridlines_kwargs)\n        gl.top_labels = False\n        gl.right_labels = False\n\n    # colorbar\n    cbar = None\n    if colorbar:\n        cbar = plt.colorbar(pcm, ax=ax, orientation=\"horizontal\", pad=0.1, aspect=50)\n        if cbar_label:\n            cbar.set_label(cbar_label)\n\n    # title\n    if title:\n        dt_ = datetime.strptime(title, \"%Y-%m-%d\")\n        ax.set_title(dt_.strftime(\"%B - %Y\"), weight='bold')\n\n    return pcm, cbar","visibility":"show","key":"KxfzpnWmsi"},{"type":"outputs","id":"rnnYOBJYwM_5tieE3TvZw","children":[],"visibility":"show","key":"LkN1PjgIde"}],"visibility":"show","key":"R2wehl2XIy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Inputs ---\nlon_ = ds_combined.longitude\nlat_ = ds_combined.latitude\ntime_1 = '2000-01-01' # January\ntime_2 = '2000-08-01' # August","key":"KMExyuht9f"},{"type":"outputs","id":"Bf1agwJ2izaajHoR7O22i","children":[],"key":"L0aGFe89up"}],"key":"YrSXgmMF2Y"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Chlorophyll-a concentrations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N21Ld2xE7j"}],"identifier":"chlorophyll-a-concentrations","label":"Chlorophyll-a concentrations","html_id":"chlorophyll-a-concentrations","implicit":true,"key":"SIsHPPXO1T"}],"key":"ALiHoOFCzg"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))\n\n# Inputs\nvar_ = ds_combined['CHL']\nvmax = .5\ncbar_label = r\"Concentration of Chlorophyll-a [$\\mathrm{mg}\\,\\cdot\\,\\mathrm{m}^{-3}$]\"\n# ---\n\nplot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1), title=time_1,cbar_label=cbar_label,vmax=vmax)\nplot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2), title=time_2,cbar_label=cbar_label,vmax=vmax)\n\nplt.savefig('Chl-a_concentrations.png', dpi=300, bbox_inches=\"tight\")\nplt.show()","visibility":"show","key":"OFrQ9DVwO1"},{"type":"outputs","id":"NtkDGFM2R2nIxMwuDVM7V","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"acc0f55d084b42e81e0b7a0c290f8652","path":"/eodashboard-notebooks/build/acc0f55d084b42e81e0b7a0c290f8652.png"},"text/plain":{"content":"\u003cFigure size 1500x800 with 4 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"wnLmwfTPUv"}],"visibility":"show","key":"lkIFi192yE"}],"visibility":"show","key":"d2DFPFpJ1V"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sea Surface Height (SSH)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kUh7qnnf0J"}],"identifier":"sea-surface-height-ssh","label":"Sea Surface Height (SSH)","html_id":"sea-surface-height-ssh","implicit":true,"key":"nK6I1Fx6I0"}],"key":"oLGoFXbXf5"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))\n\n# Inputs\nvar_ = ds_combined['sla']\nvmin = min(var_.sel(time=time_1).min().compute().item(), var_.sel(time=time_2).min().compute().item())\nvmax = max(var_.sel(time=time_1).max().compute().item(), var_.sel(time=time_2).max().compute().item())\ncmap='magma'\ncbar_label = r\"Sea Surface Height [m]\"\n# ---\n\nplot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1),cmap=cmap,title=time_1,cbar_label=cbar_label,vmin=vmin,vmax=vmax)\nplot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2), cmap=cmap,title=time_2,cbar_label=cbar_label,vmin=vmin,vmax=vmax)\n\nplt.savefig('Sea_Surface_Height.png', dpi=300, bbox_inches=\"tight\")\nplt.show()","visibility":"show","key":"n6fkspqjGt"},{"type":"outputs","id":"DlWU24rb9Ol2mBGTp9FUn","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ea6f917654993a2d25e2a2032a7aa1d2","path":"/eodashboard-notebooks/build/ea6f917654993a2d25e2a2032a7aa1d2.png"},"text/plain":{"content":"\u003cFigure size 1500x800 with 4 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"i3igTjTYJG"}],"visibility":"show","key":"bksTGD6AXy"}],"visibility":"show","key":"xmLsqnbctb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sea Surface Temperature (SST)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o8SKuOXT7M"}],"identifier":"sea-surface-temperature-sst","label":"Sea Surface Temperature (SST)","html_id":"sea-surface-temperature-sst","implicit":true,"key":"nzjYcFZ34q"}],"key":"eHrmjhrflp"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))\n\n# Inputs\nvar_ = ds_combined['analysed_sst']\nvmin = min(var_.sel(time=time_1).min().compute().item(), var_.sel(time=time_2).min().compute().item())\nvmax = max(var_.sel(time=time_1).max().compute().item(), var_.sel(time=time_2).max().compute().item())\ncmap='coolwarm'\ncbar_label = r\"Sea Surface Temperature [K]\"\n# ---\n\nplot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1),cmap=cmap,title=time_1,cbar_label=cbar_label,vmin=vmin,vmax=vmax)\nplot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2), cmap=cmap,title=time_2,cbar_label=cbar_label,vmin=vmin,vmax=vmax)\n\nplt.savefig('Sea_Surface_Temperature.png', dpi=300, bbox_inches=\"tight\")\nplt.show()","visibility":"show","key":"LIDloF71Me"},{"type":"outputs","id":"o9IqLPDW4MpvjPe-9l6lB","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"21cd8b9d533725aed35042bce3bd9a47","path":"/eodashboard-notebooks/build/21cd8b9d533725aed35042bce3bd9a47.png"},"text/plain":{"content":"\u003cFigure size 1500x800 with 4 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"iql925ElF6"}],"visibility":"show","key":"eqbuYsoz81"}],"visibility":"show","key":"MLGKpRAZdY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Eastward Wind component","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"InWWIK0twP"}],"identifier":"eastward-wind-component","label":"Eastward Wind component","html_id":"eastward-wind-component","implicit":true,"key":"j43x4S8qX9"}],"key":"SjeH2AcWHa"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))\n\n# Inputs\nvar_ = ds_combined['eastward_wind']\nfeat_ = {\"extra_features\": [(cfeature.LAND, {\"zorder\": 1}),(cfeature.RIVERS),(cfeature.LAKES)]}\nvmin = min(var_.sel(time=time_1).min().compute().item(), var_.sel(time=time_2).min().compute().item())\nvmax = max(var_.sel(time=time_1).max().compute().item(), var_.sel(time=time_2).max().compute().item())\ncmap='PiYG'\ncbar_label = r\"Eastward wind at 10 m [$\\mathrm{m}\\,\\cdot\\,\\mathrm{s}^{-1}$]\"\n# ---\n\nplot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1),cmap=cmap,coastline_kwargs=feat_,title=time_1,cbar_label=cbar_label,vmin=vmin,vmax=vmax)\nplot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2),cmap=cmap,coastline_kwargs=feat_,title=time_2,cbar_label=cbar_label,vmin=vmin,vmax=vmax)\n\nplt.savefig('EastwardWind.png', dpi=300, bbox_inches=\"tight\")\nplt.show()","visibility":"show","key":"roHZzSP6TY"},{"type":"outputs","id":"0-L7roqSVhHg2rWThnyaC","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9bc08f5cb315bc6b0692c914610ac232","path":"/eodashboard-notebooks/build/9bc08f5cb315bc6b0692c914610ac232.png"},"text/plain":{"content":"\u003cFigure size 1500x800 with 4 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"wTfdwcbCnD"}],"visibility":"show","key":"SUXwc4IQQB"}],"visibility":"show","key":"jMG1DRCgSx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Northward Wind component","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OqlGIrJypX"}],"identifier":"northward-wind-component","label":"Northward Wind component","html_id":"northward-wind-component","implicit":true,"key":"uutKqKmL3Z"}],"key":"eqfvxkMR2r"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 2, figsize=(15, 8),subplot_kw=dict(projection=ccrs.Mercator()))\n\n# Inputs\nvar_ = ds_combined['northward_wind']\nfeat_ = {\"extra_features\": [(cfeature.LAND, {\"zorder\": 1}),(cfeature.RIVERS),(cfeature.LAKES)]}\nvmin = min(var_.sel(time=time_1).min().compute().item(), var_.sel(time=time_2).min().compute().item())\nvmax = max(var_.sel(time=time_1).max().compute().item(), var_.sel(time=time_2).max().compute().item())\ncmap='PiYG'\ncbar_label = r\"Northward wind at 10 m [$\\mathrm{m}\\,\\cdot\\,\\mathrm{s}^{-1}$]\"\n# ---\n\nplot_geo_input(axes[0],lon_, lat_,var_.sel(time=time_1),cmap=cmap,coastline_kwargs=feat_,title=time_1,cbar_label=cbar_label,vmin=vmin,vmax=vmax)\nplot_geo_input(axes[1],lon_, lat_,var_.sel(time=time_2),cmap=cmap,coastline_kwargs=feat_,title=time_2,cbar_label=cbar_label,vmin=vmin,vmax=vmax)\n\nplt.savefig('NorthwardWind.png', dpi=300, bbox_inches=\"tight\")\nplt.show()","visibility":"show","key":"P3sidGBDg4"},{"type":"outputs","id":"BHrJom064oen0OYGgPCxl","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3444e72cf2a73d28f4abe960931406ec","path":"/eodashboard-notebooks/build/3444e72cf2a73d28f4abe960931406ec.png"},"text/plain":{"content":"\u003cFigure size 1500x800 with 4 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"J4DvocDed4"}],"visibility":"show","key":"VS8ILDY4X3"}],"visibility":"show","key":"iXRZcgYqdr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tpVOm8d00w"}],"urlSource":"#toc","key":"PZgCsJHbiX"}],"key":"jBE5O7JS1Z"}],"key":"rOVNYYCC3a"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"q7Qa9hURhZ"}],"key":"kO1NWVcNyz"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Analysis","key":"ShBb3zPG6d"}],"key":"rfFBvhJ0VD"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OIWckUINHu"}],"identifier":"analysis","label":"Analysis ","html_id":"analysis","implicit":true,"key":"ZXYrGmyR49"}],"visibility":"show","key":"c1XUpwOjDl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"aKe51cFwWs"}],"key":"JwyUH5QmLY"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Utility functions","key":"oCIk71xqFP"}],"key":"vmuAlYHtB3"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D0t2C1fqN8"}],"identifier":"utility-functions","label":"Utility functions ","html_id":"utility-functions","implicit":true,"key":"ryEwowW6Yj"}],"key":"aOC8odiixF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Normalizing input variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gYiZm50kBF"}],"identifier":"normalizing-input-variables","label":"Normalizing input variables","html_id":"normalizing-input-variables","implicit":true,"key":"GZLaJocqU9"}],"key":"EzOewkaaz0"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def normalise(variable_array):\n    \n    scaler = StandardScaler()\n    scaler.fit(variable_array)\n    norm_data = scaler.transform(variable_array)\n    \n    return norm_data","visibility":"show","key":"dsgmE3Dpjc"},{"type":"outputs","id":"8nQDRQZf1y1Cng529Ux6R","children":[],"visibility":"show","key":"WyGtuTI81g"}],"visibility":"show","key":"ZlyiWdZrc4"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Extracting and normalizing monthly oceanographic variable","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QbgzahOufh"}],"identifier":"extracting-and-normalizing-monthly-oceanographic-variable","label":"Extracting and normalizing monthly oceanographic variable","html_id":"extracting-and-normalizing-monthly-oceanographic-variable","implicit":true,"key":"bcucy31Mfy"}],"visibility":"show","key":"vC9rqud7Ri"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_month_variables(ds_combined, mth, fill_nan_value = -9999):\n    \n    #ds_combined= ds_combined.sel(depth=0)\n    ds_months = ds_combined.groupby('time.month').mean()\n    ds_m = ds_months.sel(month=mth)\n    ds_vars = [i for i in ds_months.data_vars] \n\n    for i,var in enumerate(ds_vars):\n        var_2d = ds_m[f'{var}'].values\n        var_2d_n = normalise(var_2d)\n        var_f = var_2d_n[5:-5,5:-5].flatten()\n\n        if i ==0:\n            var_all = var_f\n        else:\n            var_all = np.vstack((var_all, var_f))\n        \n    var_all_t = np.transpose(var_all)\n    var_all_t_mask = np.where(np.isfinite(var_all_t), var_all_t, fill_nan_value)\n    \n    return var_all_t_mask","visibility":"show","key":"V49ZgzGKqd"},{"type":"outputs","id":"Nn4sEa7dLTt27sG8f52q6","children":[],"visibility":"show","key":"LzWKOD8J9v"}],"visibility":"show","key":"vqj4itcw1w"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Averaging and normalizing oceanographic variable","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YUO1qyBKCM"}],"identifier":"averaging-and-normalizing-oceanographic-variable","label":"Averaging and normalizing oceanographic variable","html_id":"averaging-and-normalizing-oceanographic-variable","implicit":true,"key":"u1zT1Fh3Ra"}],"visibility":"show","key":"Y52L6rtRF2"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_average_variables(ds_combined, fill_nan_value = -9999, opt = False):\n    \n    if opt:\n        ds_av = ds_combined.groupby('time.day').mean()\n        ds_av = ds_av.sel(day=1)\n    else:\n        ds_combined= ds_combined.sel(depth=0)\n        ds_av = ds_combined.mean()\n        \n    ds_vars = [i for i in ds_av.data_vars] \n\n    for i,var in enumerate(ds_vars):\n        var_2d = ds_av[f'{var}'].values\n        var_2d_n = normalise(var_2d)\n        var_f = var_2d_n[5:-5,5:-5].flatten()\n\n        if i ==0:\n            var_all = var_f\n        else:\n            var_all = np.vstack((var_all, var_f))\n        \n    var_all_t = np.transpose(var_all)\n    var_all_t_mask = np.where(np.isfinite(var_all_t), var_all_t, fill_nan_value)\n    \n    return var_all_t_mask","visibility":"show","key":"K9IUlqf2ZN"},{"type":"outputs","id":"_iafADdY41Dk8l696xtrb","children":[],"visibility":"show","key":"SWQf6fcXlW"}],"visibility":"show","key":"YxnCiPFJF9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finding the optimal number of clusters (optimization technique: Elbow Method)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XqefEWQ56O"}],"identifier":"finding-the-optimal-number-of-clusters-optimization-technique-elbow-method","label":"Finding the optimal number of clusters (optimization technique: Elbow Method)","html_id":"finding-the-optimal-number-of-clusters-optimization-technique-elbow-method","implicit":true,"key":"MATOIaOCF6"}],"key":"dTZiJUiOnY"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def test_number_of_clusters(variables, n_max, random_state):\n    out = []\n    \n    for i in range(3,n_max):\n        kmeans = KMeans(n_clusters=i, random_state=random_state)\n        labels = kmeans.fit_predict(variables)\n        out.append(kmeans.inertia_)\n        \n    plt.plot(np.arange(3, n_max), out)\n    plt.xlabel('Number of clusters')\n    plt.ylabel('Inertia')\n    plt.title('Optimal number of clusters\\nElbow method')\n    \n    return out","visibility":"show","key":"Un23qLwFjR"},{"type":"outputs","id":"VkgrtIh-1ThdCVNAmh9so","children":[],"visibility":"show","key":"ke78JSO9pa"}],"visibility":"show","key":"hFBP1oEYwA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Converting cluster assignments to Geo-DataArray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jNlKmyu8ch"}],"identifier":"converting-cluster-assignments-to-geo-dataarray","label":"Converting cluster assignments to Geo-DataArray","html_id":"converting-cluster-assignments-to-geo-dataarray","implicit":true,"key":"IZfASPdeMh"}],"key":"KAaDwAzfl0"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def masking_labels(labels):\n\n    cluster_map = labels\n    cluster_map = cluster_map.reshape(len(ds_combined_m.latitude[5:-5]), len(ds_combined_m.longitude[5:-5]))\n    da_clusters = xr.DataArray(\n        cluster_map,\n        coords={\"latitude\": ds_combined_m.latitude[5:-5], \"longitude\": ds_combined_m.longitude[5:-5]},\n        dims=(\"latitude\", \"longitude\")\n    )\n    \n    return da_clusters","visibility":"show","key":"toVonYClZj"},{"type":"outputs","id":"lQhbZCNcNTFNsfpx3Ioxz","children":[],"visibility":"show","key":"tZj7vLzifw"}],"visibility":"show","key":"QGWcqNrlAq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Processing seasonal climatology variables by month","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ifT5IBRsx9"}],"identifier":"processing-seasonal-climatology-variables-by-month","label":"Processing seasonal climatology variables by month","html_id":"processing-seasonal-climatology-variables-by-month","implicit":true,"key":"Bw6AFnW0hS"}],"key":"iCBLgQaKIf"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, mth, fill_nan_value = -9999):\n    \n    ds_combined_seasonally_all_yrs_avg = ds_combined_seasonally_all_yrs_avg.sel(depth=0)\n    ds_months = ds_combined_seasonally_all_yrs_avg\n    ds_m = ds_months.sel(month=mth)\n    ds_vars = [i for i in ds_months.data_vars] \n\n    for i,var in enumerate(ds_vars):\n        \n        var_2d = ds_m[f'{var}'].values\n        var_2d_n = normalise(var_2d)\n        var_f = var_2d_n[5:-5,5:-5].flatten() # remove the border because getting weird edge effects, then flatten\n        \n        if i ==0:\n            var_all = var_f\n        else:\n            var_all = np.vstack((var_all, var_f))\n        \n    var_all_t = np.transpose(var_all)\n    var_all_t_mask = np.where(np.isfinite(var_all_t), var_all_t, fill_nan_value)\n    \n    return var_all_t_mask","visibility":"show","key":"XEjh6veURf"},{"type":"outputs","id":"nflNnzLEJEklEFfjd_zXP","children":[],"visibility":"show","key":"JXoqjVqMiS"}],"visibility":"show","key":"sKHNyjz748"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Converting Geo-DataArray to csv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W6QJO3LHoc"}],"identifier":"converting-geo-dataarray-to-csv","label":"Converting Geo-DataArray to csv","html_id":"converting-geo-dataarray-to-csv","implicit":true,"key":"xlea6viMw1"}],"key":"NZt4LU8Ff4"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def xarr_to_csv(xarray_name, xarray_ds):\n    df_ = xarray_ds.to_dataframe(name=xarray_name).reset_index()\n    csv_path = f\"{xarray_name}.csv\"\n    df_.to_csv(csv_path, index=False)\n    return csv_path\n\ndef csv_to_xarray(csv_path, xarray_name):\n    df_ = pd.read_csv(csv_path)\n    xarray_ = (df_.set_index([\"latitude\", \"longitude\"]).to_xarray()[xarray_name])\n    return xarray_","visibility":"show","key":"caQ1d0efXh"},{"type":"outputs","id":"znBM75Kq5WYIspqfjYt9M","children":[],"visibility":"show","key":"zhLaXN2Dw4"}],"visibility":"show","key":"qY0xBaJ41p"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Asp6aaZhcG"}],"urlSource":"#toc","key":"HLNsr8zHDS"}],"key":"SmDzg0lHkM"}],"key":"DU5YFW96ae"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"VNbYjipJAH"}],"key":"B7MABRhUwX"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"K-means implementation","key":"FGJYagw2HO"}],"key":"T0bSMfdPeg"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sdSihB2trC"}],"identifier":"k-means-implementation","label":"K-means implementation ","html_id":"k-means-implementation","implicit":true,"key":"wEGD1QIzDm"}],"key":"jDfRMsERbM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finding the optimal number of clusters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iusNLLU9Ff"}],"identifier":"finding-the-optimal-number-of-clusters","label":"Finding the optimal number of clusters","html_id":"finding-the-optimal-number-of-clusters","implicit":true,"key":"jCR9NUxBe0"}],"key":"XCLWNblJiF"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"variables_av = get_average_variables(ds_combined_m, fill_nan_value, opt)\nnp.savetxt('variables_all_masked.txt', variables_av)\nvariables_av = np.loadtxt('variables_all_masked.txt')\n\n# Plotting Inertia against the number of clusters to find the optimal value\nmax_clusters = 15 # maximum number of clusters to be tested\nrandom_state = 10 # setting \u003crandom state\u003e for results reproducibility\nelbow = test_number_of_clusters(variables_av, max_clusters, random_state)","visibility":"show","key":"QyW4k6X0kk"},{"type":"outputs","id":"Ve_X4ySAdCZ4gxoQM-IMl","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n"},"children":[],"key":"nOpRuguHWn"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f51ce903a6d19994a58a116b7e88599","path":"/eodashboard-notebooks/build/9f51ce903a6d19994a58a116b7e88599.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"hdFkYqpVOw"}],"visibility":"show","key":"z9go4vsTL7"}],"visibility":"show","key":"WHaM0FtAXJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"By looking at the graph, the Elbow point is at 5. However, 8 has been chosen since 5, 6 and 7 clusters led to only two water types (coastal and open).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JQSGZ5O4gn"}],"key":"jiriJx2mgd"}],"key":"PGzveF2cid"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"opt_clusters = 8 # optimal number of clusters \nrandom_state = 10 # setting \u003crandom state\u003e for results reproducibility\nkmeans = KMeans(n_clusters=opt_clusters, random_state=random_state) \nlabels = kmeans.fit_predict(variables_av)\n\njoblib.dump(kmeans, 'kmeans.joblib')\njoblib.dump(labels, 'labels.joblib')","visibility":"show","key":"EJxIZSLxts"},{"type":"outputs","id":"6ENlAcSz7ciDEZRm2ta0l","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"['labels.joblib']","content_type":"text/plain"}}},"children":[],"key":"LQYonpHtPp"}],"visibility":"show","key":"aX5xHWhzeR"}],"visibility":"show","key":"m4fnqYRBmp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lc8mmkjs1f"}],"urlSource":"#toc","key":"rrIrs6XvWr"}],"key":"Rs47S3hnEz"}],"key":"hjdMirMwoN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"TzWP19Q6Gt"}],"key":"QCaamAEBAe"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Monthly clustering","key":"s69dwIQfWd"}],"key":"vgEcC5jTtn"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sY3kcCe5vj"}],"identifier":"monthly-clustering","label":"Monthly clustering ","html_id":"monthly-clustering","implicit":true,"key":"LbvE10R5Bc"}],"key":"RtJtGJ7UwX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Extracting monthly variables from the combined dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Cz3wyLBGS8"}],"identifier":"extracting-monthly-variables-from-the-combined-dataset","label":"Extracting monthly variables from the combined dataset","html_id":"extracting-monthly-variables-from-the-combined-dataset","implicit":true,"key":"Xy3rQmYdwP"}],"key":"Ay5lKS7btZ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"variables_8 = get_month_variables(ds_combined_m, 8) # August\nvariables_1 = get_month_variables(ds_combined_m, 1) # January","visibility":"show","key":"tZe08YiYEf"},{"type":"outputs","id":"756iJXiYQFBYAuyEji-tR","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n"},"children":[],"key":"UEvlDd43iu"}],"visibility":"show","key":"y393KdO6y6"}],"visibility":"show","key":"cZsgVrKgKf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Applying K-means clustering to monthly variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xVhfHV1AoX"}],"identifier":"applying-k-means-clustering-to-monthly-variables","label":"Applying K-means clustering to monthly variables","html_id":"applying-k-means-clustering-to-monthly-variables","implicit":true,"key":"MBt0E6Ymia"}],"key":"UNK53fZZqh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Loading clusters centroids and labels\nkmeans = joblib.load('kmeans.joblib')\nlabels = joblib.load('labels.joblib')\n\nlabels_8 = kmeans.predict(variables_8)\nlabels_1 = kmeans.predict(variables_1)\n\nda_8 = masking_labels(labels_8)\nda_1 = masking_labels(labels_1)\n\njan = da_1.values\naug = da_8.values","key":"eeDX6wQFS6"},{"type":"outputs","id":"4yG3Pv4-X6m7PJr1j-bt_","children":[],"key":"eWXFaP3bx1"}],"key":"QphiOwMi76"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualization of monthly clusters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FCDrv0QKEk"}],"identifier":"visualization-of-monthly-clusters","label":"Visualization of monthly clusters","html_id":"visualization-of-monthly-clusters","implicit":true,"key":"kR2ar5nE1g"}],"key":"WDlfczzjiB"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(15, 17))\nax = fig.add_subplot(121, projection=ccrs.PlateCarree())\nax.coastlines(zorder=4)\nax.add_feature(cfeature.LAKES, zorder=3)\nax.add_feature(cfeature.RIVERS, zorder=3)\npc = ax.pcolormesh(da_1.longitude,da_1.latitude, da_1, cmap='Accent')\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color='k', alpha=0.5, linestyle='--')\ngl.xformatter = LONGITUDE_FORMATTER\ngl.yformatter = LATITUDE_FORMATTER\ncbar = plt.colorbar(pc, ax=ax, label='Cluster', pad=0.15, shrink=0.15)\ncbar.set_ticks(np.arange(0,8,1))\nax.set_title('January', fontsize=16, weight='bold')\n\nax = fig.add_subplot(122, projection=ccrs.PlateCarree())\npc2 = ax.pcolormesh(da_8.longitude,da_8.latitude,da_8, cmap='Accent', zorder=2)\nax.coastlines(zorder=4)\nax.add_feature(cfeature.LAKES, zorder=3)\nax.add_feature(cfeature.RIVERS, zorder=3)\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color='k', alpha=0.5, linestyle='--')\ngl.xformatter = LONGITUDE_FORMATTER\ngl.yformatter = LATITUDE_FORMATTER\ncbar = plt.colorbar(pc2, ax=ax, label='Cluster', pad=0.15, shrink=0.15)\ncbar.set_ticks(np.arange(0,8,1))\nax.set_title('August', fontsize=16, weight='bold')\nplt.tight_layout()\nplt.savefig('JanuaryAugust_clustering.png',bbox_inches='tight')\nplt.show()\n\nfig = plt.figure(figsize=(15,6))\nax = plt.axes(projection = ccrs.PlateCarree())\nax.coastlines(zorder=4)\nax.add_feature(cfeature.LAND, zorder=2)\nax.add_feature(cfeature.LAKES, zorder=3)\nax.add_feature(cfeature.RIVERS, zorder=3)\nax.add_feature(cfeature.OCEAN)\npc3 = ax.pcolormesh(da_8.longitude, da_8.latitude, da_8 - da_1, cmap='bwr', zorder=1)\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color='k', alpha=0.5, linestyle='--', zorder=5)\ngl.xformatter = LONGITUDE_FORMATTER\ngl.yformatter = LATITUDE_FORMATTER\nplt.colorbar(pc3, ax=ax, label = 'Cluster Difference', pad=0.10, shrink=0.8, )\nax.set_title('Cluster differences', fontsize=16, weight='bold')\nplt.tight_layout()\nplt.savefig('JanuaryAugust_ClusterDifferences.png',bbox_inches='tight')\nplt.show()","visibility":"show","key":"utm0EmkLyE"},{"type":"outputs","id":"JqDvYi7ugXkamU3IQ8G7I","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bcf72160332e60beb964ca027c00511b","path":"/eodashboard-notebooks/build/bcf72160332e60beb964ca027c00511b.png"},"text/plain":{"content":"\u003cFigure size 1500x1700 with 4 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"QLNzezwniA"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c135a217b1504c636c6092d998f51024","path":"/eodashboard-notebooks/build/c135a217b1504c636c6092d998f51024.png"},"text/plain":{"content":"\u003cFigure size 1500x600 with 2 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"OapBVxLQrP"}],"visibility":"show","key":"i64YFsevpy"}],"visibility":"show","key":"E5meQF7lBI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o5JLgxiqM3"}],"urlSource":"#toc","key":"AAYRHTAHOC"}],"key":"gqwtCmxP2F"}],"key":"lWMLpOWwT0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"","children":[],"urlSource":"","key":"kyzob54MAD"}],"key":"lf7jsYPjGo"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"Seasonal clustering","key":"SlnZkt5ydx"}],"key":"V6GzoLXl5g"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c7sT7CzTJV"}],"identifier":"seasonal-clustering","label":"Seasonal clustering ","html_id":"seasonal-clustering","implicit":true,"key":"fUeqa1V4vL"}],"key":"DSbCqieshx"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Extracting seasonal variables from the combined dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CBqIAvrDEM"}],"identifier":"extracting-seasonal-variables-from-the-combined-dataset","label":"Extracting seasonal variables from the combined dataset","html_id":"extracting-seasonal-variables-from-the-combined-dataset","implicit":true,"key":"vt6x87xx5b"}],"visibility":"show","key":"BhCGxGYtEK"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Input parameters\ntime_selected = ['1998-01-01', '2023-11-01']\nbounds = [-6,30,36.5,46]\nfill_nan_value = -9999\nopt = False\n\n# Extracting seasonal values from the combined dataset\nds_combined = make_combined_dataset(time_selected, bounds, fill_nan_value, opt)\nds_combined_m = ds_combined.where(~ds_combined['CHL'].isnull())\nds_combined_seasonally = ds_combined_m.resample(time=\"QS-DEC\").mean() \nds_combined_seasonally_all_yrs_avg = ds_combined_seasonally.groupby('time.month').mean()\n\nds_combined_seasonally_all_yrs_avg = ds_combined_seasonally_all_yrs_avg.drop_vars('sos')\n\nvariables_DJF = get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, 12)\nvariables_MAM = get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, 3)\nvariables_JJA = get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, 6)\nvariables_SON = get_month_variables_seasonal_avg(ds_combined_seasonally_all_yrs_avg, 9)","visibility":"show","key":"D45Pdc2grL"},{"type":"outputs","id":"vEKsQdHUYTUTBuiQcGYaQ","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"INFO - 2025-11-11T14:49:33Z - Selected dataset version: \"202311\"\nINFO - 2025-11-11T14:49:33Z - Selected dataset part: \"default\"\nWARNING - 2025-11-11T14:49:34Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.005064010620117, 45.994937896728516]\nWARNING - 2025-11-11T14:49:34Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-5.9935760498046875, 36.49357604980469]\nWARNING - 2025-11-11T14:49:34Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.005064010620117, 45.994937896728516]\nWARNING - 2025-11-11T14:49:34Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-5.9935760498046875, 36.49357604980469]\nINFO - 2025-11-11T14:49:35Z - Selected dataset version: \"202311\"\nINFO - 2025-11-11T14:49:35Z - Selected dataset part: \"default\"\nINFO - 2025-11-11T14:49:36Z - Selected dataset version: \"202411\"\nINFO - 2025-11-11T14:49:36Z - Selected dataset part: \"default\"\nINFO - 2025-11-11T14:49:37Z - Selected dataset version: \"202411\"\nINFO - 2025-11-11T14:49:37Z - Selected dataset part: \"default\"\nWARNING - 2025-11-11T14:49:37Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.125, 46.025001525878906]\nWARNING - 2025-11-11T14:49:37Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-18.125, 36.32500076293945]\nWARNING - 2025-11-11T14:49:37Z - Some of your subset selection [30, 46] for the latitude dimension exceed the dataset coordinates [30.125, 46.025001525878906]\nWARNING - 2025-11-11T14:49:37Z - Some of your subset selection [-6.0, 36.5] for the longitude dimension exceed the dataset coordinates [-18.125, 36.32500076293945]\nINFO - 2025-11-11T14:49:38Z - Selected dataset version: \"202411\"\nINFO - 2025-11-11T14:49:38Z - Selected dataset part: \"default\"\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1144: RuntimeWarning: invalid value encountered in divide\n  updated_mean = (last_sum + new_sum) / updated_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1149: RuntimeWarning: invalid value encountered in divide\n  T = new_sum / new_sample_count\n/home/conda/users/03ab8823-1758107623-131-deepesdl-xcube-1.11.0/lib/python3.13/site-packages/sklearn/utils/extmath.py:1169: RuntimeWarning: invalid value encountered in divide\n  new_unnormalized_variance -= correction**2 / new_sample_count\n"},"children":[],"key":"T4JAcU0p9S"}],"visibility":"show","key":"C1MgIIImyM"}],"visibility":"show","key":"Q0h9WwYMjR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Applying K-means clustering to seasonal variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bPd2QkhLtP"}],"identifier":"applying-k-means-clustering-to-seasonal-variables","label":"Applying K-means clustering to seasonal variables","html_id":"applying-k-means-clustering-to-seasonal-variables","implicit":true,"key":"h2sinEpiFy"}],"key":"aRbIro2FXg"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Loading clusters centroids and labels\nkmeans = joblib.load('kmeans.joblib')\nlabels = joblib.load('labels.joblib')\n\n# Clusters prediction\nlabels_DJF = kmeans.predict(variables_DJF)\nlabels_MAM = kmeans.predict(variables_MAM)\nlabels_JJA = kmeans.predict(variables_JJA)\nlabels_SON = kmeans.predict(variables_SON)\n\nda_DJF = masking_labels(labels_DJF)\nda_MAM = masking_labels(labels_MAM)\nda_JJA = masking_labels(labels_JJA)\nda_SON = masking_labels(labels_SON)","visibility":"show","key":"ktU2tajrkO"},{"type":"outputs","id":"vgtHpJUAm3X7QMbW2cl1U","children":[],"visibility":"show","key":"FMYSLfEO2x"}],"visibility":"show","key":"Avv0GWxrm5"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Dumping to csv\ndjf_path = xarr_to_csv('DJF_clusters', da_DJF)\nmam_path = xarr_to_csv('MAM_clusters', da_MAM)\njja_path = xarr_to_csv('JJA_clusters', da_JJA)\nson_path = xarr_to_csv('SON_clusters', da_SON)","visibility":"show","key":"yYBF3Wntwl"},{"type":"outputs","id":"bR1ADazZktG9xNHepPkhg","children":[],"visibility":"show","key":"s82zHC5Js4"}],"visibility":"show","key":"qAPpLKp52E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualization of seasonal clusters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FW9UKgg374"}],"identifier":"visualization-of-seasonal-clusters","label":"Visualization of seasonal clusters","html_id":"visualization-of-seasonal-clusters","implicit":true,"key":"NkhNmRFW84"}],"key":"XsR1AWxTkv"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Loading seasonal clusters\nda_DJF = csv_to_xarray(djf_path, 'DJF_clusters')\nda_MAM = csv_to_xarray(mam_path, 'MAM_clusters')\nda_JJA = csv_to_xarray(jja_path, 'JJA_clusters')\nda_SON = csv_to_xarray(son_path, 'SON_clusters')\n\n# Plotting\nfig = plt.figure(figsize=(15, 17))\n#fig.suptitle('Seasonal cycle of clusters', y=0.6, fontsize=23)\n\nax = fig.add_subplot(121, projection=ccrs.PlateCarree())\nax.coastlines(zorder=4)\nax.add_feature(cfeature.LAKES, zorder=3)\nax.add_feature(cfeature.RIVERS, zorder=3)\npc = ax.pcolormesh(da_DJF.longitude,da_DJF.latitude, da_DJF, cmap='Accent')\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color='k', alpha=0.5, linestyle='--')\ngl.xformatter = LONGITUDE_FORMATTER\ngl.yformatter = LATITUDE_FORMATTER\ncbar = plt.colorbar(pc, ax=ax, label='Cluster', pad=0.15, shrink=0.15)\ncbar.set_ticks(np.arange(0,8,1))\nax.set_title('DJF', fontsize=16, weight='bold')\n\n\nax2 = fig.add_subplot(122, projection=ccrs.PlateCarree())\npc2 = ax2.pcolormesh(da_MAM.longitude,da_MAM.latitude,da_MAM, cmap='Accent', zorder=2)\nax2.coastlines(zorder=4)\nax2.add_feature(cfeature.LAKES, zorder=3)\nax2.add_feature(cfeature.RIVERS, zorder=3)\ngl = ax2.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color='k', alpha=0.5, linestyle='--')\ngl.xformatter = LONGITUDE_FORMATTER\ngl.yformatter = LATITUDE_FORMATTER\ncbar = plt.colorbar(pc2, ax=ax2, label='Cluster', pad=0.15, shrink=0.15)\ncbar.set_ticks(np.arange(0,8,1))\nax2.set_title('MAM', fontsize=16, weight='bold')\nplt.tight_layout()\nplt.savefig('Seasonal_clustering_DJF-MAM.png',bbox_inches='tight')\n#plt.show()\n\nfig = plt.figure(figsize=(15, 17))\nax = fig.add_subplot(121, projection=ccrs.PlateCarree())\nax.coastlines(zorder=4)\nax.add_feature(cfeature.LAKES, zorder=3)\nax.add_feature(cfeature.RIVERS, zorder=3)\npc = ax.pcolormesh(da_JJA.longitude,da_JJA.latitude, da_JJA, cmap='Accent')\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color='k', alpha=0.5, linestyle='--')\ngl.xformatter = LONGITUDE_FORMATTER\ngl.yformatter = LATITUDE_FORMATTER\ncbar = plt.colorbar(pc, ax=ax, label='Cluster', pad=0.15, shrink=0.15)\ncbar.set_ticks(np.arange(0,8,1))\nax.set_title('JJA', fontsize=16, weight='bold')\n\nax2 = fig.add_subplot(122, projection=ccrs.PlateCarree())\npc2 = ax2.pcolormesh(da_SON.longitude,da_SON.latitude,da_SON, cmap='Accent', zorder=2)\nax2.coastlines(zorder=4)\nax2.add_feature(cfeature.LAKES, zorder=3)\nax2.add_feature(cfeature.RIVERS, zorder=3)\ngl = ax2.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, linewidth=1, color='k', alpha=0.5, linestyle='--')\ngl.xformatter = LONGITUDE_FORMATTER\ngl.yformatter = LATITUDE_FORMATTER\ncbar = plt.colorbar(pc2, ax=ax2, label='Cluster', pad=0.15, shrink=0.15)\ncbar.set_ticks(np.arange(0,8,1))\nax2.set_title('SON', fontsize=16, weight='bold')\nplt.tight_layout()\nplt.savefig('Seasonal_clustering_JJA-SON.png',bbox_inches='tight')\n\nplt.show()","visibility":"show","key":"SpIIQZr9qs"},{"type":"outputs","id":"ntBMq0-NWdC294AKvMrqp","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0b3f97014424dbb077655fa9ee814a37","path":"/eodashboard-notebooks/build/0b3f97014424dbb077655fa9ee814a37.png"},"text/plain":{"content":"\u003cFigure size 1500x1700 with 4 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"XbUrr0rSKE"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a5eb3b3e601cbe9ab299d0fbcce63c08","path":"/eodashboard-notebooks/build/a5eb3b3e601cbe9ab299d0fbcce63c08.png"},"text/plain":{"content":"\u003cFigure size 1500x1700 with 4 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"oo2ytktrsg"}],"visibility":"show","key":"mSAofS2irq"}],"visibility":"show","key":"TFQciB1rsf"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Cluster 1 (violet) - Eutrophic Water: - Colder waters - Eastward Winds - Medium Chlorophyll-a content","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"anhM6SiIRy"}],"key":"aJhyJd9UGx"}],"key":"Fnngp3414N"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Cluster 2 (orange) - Coastal Water: - Very high Chlorophyll-a - Sea Surface Height","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DUV4jjwYW4"}],"key":"gtob8effOU"}],"key":"ljWbZovM9b"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Cluster 7 (grey) - Oligotrophic Water: - Warmer waters - Northward wind and wind stress - Low Chlorophyll-a Conten","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HjSIgRN6C3"}],"key":"DgGsktcIQ9"}],"key":"gwaDnpNGOy"}],"key":"spW5pfPqNX"}],"key":"bg4Dia8baW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Percentage change of seasonal clusters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CjgaulVXrY"}],"identifier":"percentage-change-of-seasonal-clusters","label":"Percentage change of seasonal clusters","html_id":"percentage-change-of-seasonal-clusters","implicit":true,"key":"JS8Sox13NL"}],"key":"IZzkhBltQX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"DJF_1 = sum(sum(da_DJF == 1))\nDJF_2 = sum(sum(da_DJF == 2))\nDJF_7 = sum(sum(da_DJF == 7))\n\nMAM_1 = sum(sum(da_MAM == 1))\nMAM_2 = sum(sum(da_MAM == 2))\nMAM_7 = sum(sum(da_MAM == 7))\n\nJJA_1 = sum(sum(da_JJA == 1))\nJJA_2 = sum(sum(da_JJA == 2))\nJJA_7 = sum(sum(da_JJA == 7))\n\nSON_1 = sum(sum(da_SON == 1))\nSON_2 = sum(sum(da_SON == 2))\nSON_7 = sum(sum(da_SON == 7))","key":"LAZoGjf3AM"},{"type":"outputs","id":"TcmDgqPFsdj8BLBgGgYmD","children":[],"key":"vtXlv9uiwm"}],"key":"zwV1Omy821"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cluster_1 = [(JJA_1-JJA_1)/JJA_1, (SON_1-JJA_1)/JJA_1, (DJF_1-JJA_1)/JJA_1, (MAM_1-JJA_1)/JJA_1]\ncluster_2 = [(JJA_2-JJA_2)/JJA_2, (SON_2-JJA_2)/JJA_2, (DJF_2-JJA_2)/JJA_2, (MAM_2-JJA_2)/JJA_2]\ncluster_7 = [(JJA_7-JJA_7)/JJA_7, (SON_7-JJA_7)/JJA_7, (DJF_7-JJA_7)/JJA_7, (MAM_7-JJA_7)/JJA_7]","key":"eZHh4Aqb7Z"},{"type":"outputs","id":"dsa0WgbJ3phFdOoJXn-vU","children":[],"key":"tKGam0cMeu"}],"key":"uzHJGjT8is"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plotting results\nfig = plt.figure(figsize = (12,4))\nfig.suptitle('Seasonal cycle of clusters\\nPercentage Change', y=1, fontsize=15)\nplt.plot(cluster_1, label = 'Cluster 1 - Eutrophic Water', color = 'tab:purple')\nplt.plot(cluster_2, label = 'Cluster 2 - Coastal Water', color = 'tab:orange')\nplt.plot(cluster_7, label = 'Cluster 7 - Oligotrophic Water', color = 'tab:gray')\nplt.xticks([0,1,2,3], ['Summer','Autumn','Winter','Spring'])\nplt.ylabel('Percentage Change')\nplt.legend(loc='lower left', fontsize='small')\n\nplt.savefig('SeasonalClusters_percentage-change.png')\nplt.show()","visibility":"show","key":"MUDHPHweq7"},{"type":"outputs","id":"VhASwjFMpdtQ1yxkTYdIc","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"68fc7ceee0ff3b65ca4f202bb3be17e2","path":"/eodashboard-notebooks/build/68fc7ceee0ff3b65ca4f202bb3be17e2.png"},"text/plain":{"content":"\u003cFigure size 1200x400 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"gq84ZDjUmk"}],"visibility":"show","key":"BVJulsYkjc"}],"visibility":"show","key":"kX0XoJXZch"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#toc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Back to Table of Contents","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PmzVj3Wb2j"}],"urlSource":"#toc","key":"rbRxhMIQ1W"}],"key":"AjJFhYodSi"}],"key":"J12XBVgjsM"}],"key":"ERqIxiDdmf"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","url":"/notebooks/inland-water-with-edc","group":"Notebooks"},"next":{"title":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","url":"/notebooks/openchallangenotebook-team-5-challenge-3-timeserie","group":"Notebooks"}}},"domain":"http://localhost:3000"},"project":{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-efdd7d7042b27d54684a1811fc755d02.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.oceanographic-patterns-clustering","title":"K-means clustering analysis of oceanographic patterns in the Mediterranean Sea","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-1d318eb5521a50ad6b7e4f73355e792b.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/eodashboard-notebooks/build/manifest-54BD5942.js";
import * as route0 from "/eodashboard-notebooks/build/root-PMP5BIHC.js";
import * as route1 from "/eodashboard-notebooks/build/routes/$-5ZLZ2O3Y.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/eodashboard-notebooks/build/entry.client-PCJPW7TK.js");</script></body></html>