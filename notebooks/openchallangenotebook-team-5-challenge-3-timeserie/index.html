<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae - EO Dashboard Notebooks</title><meta property="og:title" content="Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae - EO Dashboard Notebooks"/><meta name="generator" content="mystmd"/><meta name="description" content="Collection of examples relevant to the EO Dashboard project"/><meta property="og:description" content="Collection of examples relevant to the EO Dashboard project"/><meta name="keywords" content=""/><meta name="image" content="/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg"/><meta property="og:image" content="/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg"/><link rel="stylesheet" href="/eodashboard-notebooks/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/eodashboard-notebooks/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/eodashboard-notebooks/favicon.ico"/><link rel="stylesheet" href="/eodashboard-notebooks/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block lg:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/eodashboard-notebooks/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] lg:hidden hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">Notebook examples</div><div class="flex-grow"></div><a href="https://github.com/ESA-eodashboards/eodashboard-notebooks" title="GitHub Repository: ESA-eodashboards/eodashboard-notebooks" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/ESA-eodashboards/eodashboard-notebooks/blob/main/notebooks/OpenChallangeNotebook-TEAM-5_CHALLENGE-3_Timeseries-Interpolation_UPDATED.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="VYcM5XbRKg" class="relative group/block"><img id="rMs6zEBYPC" style="margin:0 auto" src="/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg" alt="Sept-2025-Venice-Edinburgh-Leeds.jpg" data-canonical-url="data:image/jpeg;base64,/9j/4AAQSk...KKAP/2Q==
" class=""/></div><div id="JbJObIjib2" class="relative group/block"><div class="alert alert-info">This concise notebook demonstrates guidelines for submission of your projects developed under the <strong>Earth System Science Open Challenge!</strong><br/> Please use this notebook as a template for delivering your workflow with the code you used to produce the results! <br/>For more information, refer to Open Challenge website: <a target="_blank" rel="noreferrer" href="https://eo4society.esa.int/event/sciencehubchallengefeb2024/" class="">https://<wbr/>eo4society<wbr/>.esa<wbr/>.int<wbr/>/event<wbr/>/sciencehubchallengefeb2024/</a><br/></div></div><div id="Bq7v9sGIFc" class="relative group/block"><h1 id="earth-system-science-hub-challenge-3-time-series-interpolation-techniques-for-remote-sensing-fran-denise-mae" class="relative group"><span class="heading-text">Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#earth-system-science-hub-challenge-3-time-series-interpolation-techniques-for-remote-sensing-fran-denise-mae" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><hr class="py-2 my-5 translate-y-2"/></div><div id="oFqpRvUCdk" class="relative group/block"><h1 id="id-1-title" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">1. Title</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-title" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p><strong>Author(s):</strong>  Fran, Denise, Mae <br/>
<strong>Group name:</strong> “Team 5” <br/>
<strong>Challenge:</strong> Challenge 3: Time series interpolation techniques for remote sensing. From: <a target="_blank" rel="noreferrer" href="https://eo4society.esa.int/wp-content/uploads/2024/02/Earth-System-Science-Hub-Challenges-February-2024-PREVIEW.pdf" class="">link to challenges</a> <br/></p><p><strong>Submission date:</strong> 06 Oct 2025 <br/>
<br/></p></div><div id="HyocJnzLgl" class="relative group/block"><h1 id="id-2-description" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">2. Description</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-description" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><h2 id="scientific-problem" class="relative group"><span class="heading-text">Scientific problem:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#scientific-problem" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Vegetation EO time series are crucial for monitoring ecosystem health, agricultural productivity and climate impacts.
NDVI (Normalised Difference Vegetation Index) time series often suffer from residual cloud presence, even after data pre-processing.</p><p>Depending on land cover type, NDVI time series reconstructions may perform differently due to varying periodicity, amplitude or steepness of transitions (Julien and Sobrino, 2019).</p><p>Accurate interpolation is essential to ensure reliable analysis of vegetation dynamics !</p><h2 id="objective" class="relative group"><span class="heading-text">Objective:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#objective" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Design and implement a reproducible framework to compare multiple time series interpolation techniques on vegetation EO datasets with artificially introduced temporal gaps.</p><h2 id="methods" class="relative group"><span class="heading-text">Methods:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#methods" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="location-selection" class="relative group"><span class="heading-text">Location selection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#location-selection" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We select 5 points:</p><ul><li><p>one in Amazon (Low seasonality, High precipitation, 123 billion tonnes of carbon (NOAA, 2021))</p></li><li><p>one in Caatinga (High Seasonality, High precipitation, Nearly 100,000 km2 and large flux of carbon, water, and other compounds with the atmosphere with seasons)</p></li><li><p>one in Elmstein, Germany (High seasonality, Medium precipitation)</p></li><li><p>one in Muara, Indonesia (High Seasonality - monsoonal pattern, High precipitation)</p></li><li><p>one in the Canadian Rockies (High seasonality, medium precipitation, boreal)</p></li></ul><p>Then:</p><ol start="1"><li>Extract timeseries over each point for the period 2017-2022</li><li>introduce artifical gaps</li><li>Interpolate using various techniques</li><li>measure metrics (R2, RMSE, processing time)</li></ol><h3 id="data-used" class="relative group"><span class="heading-text">Data used:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-used" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>ndvi timeseries from DeepESDL Earth System Datacube (ESDC) v.3.0.1</p><ul><li>Temporal resolution: 8 days</li><li>spatial resolution: 0.25° (~28 km)</li><li>Derived from MODIS Terra + Aqua BRDF corrected daily reflectance data</li></ul><h3 id="interpolation-techniques-tested" class="relative group"><span class="heading-text">Interpolation techniques tested:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#interpolation-techniques-tested" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li>Linear interpolation: fit a line through the points.</li><li>Cubic Spline: uses piecewise cubic polynomials to create a smooth curve passing through a set of points.</li><li>Gaussian Process Regression: Bayesian ML method that models data as a smooth curve with uncertainty. Smooth trend, seasonality noise accounted for using custom kernels.</li><li>Climatology Fill (seasonal): uses average values from previous 4 years to deduce pattern at missing time.</li></ul></div><div id="jHL4tgzi1l" class="relative group/block"><h1 id="id-3-table-of-contents" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">3. Table of Contents</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-table-of-contents" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><ol start="1"><li><a target="_blank" rel="noreferrer" href="#section1" class="">Title</a></li><li><a target="_blank" rel="noreferrer" href="#section2" class="">Description</a></li><li><a target="_blank" rel="noreferrer" href="#section3" class="">Table of Contents</a></li><li><a target="_blank" rel="noreferrer" href="#section4" class="">References</a></li><li><a target="_blank" rel="noreferrer" href="#section5" class="">Key Conclusions</a></li><li><a target="_blank" rel="noreferrer" href="#section6" class="">Societal Context</a></li><li><a target="_blank" rel="noreferrer" href="#section7" class="">Import libraries</a></li><li><a target="_blank" rel="noreferrer" href="#section8" class="">Access dataset</a></li><li><a target="_blank" rel="noreferrer" href="#section9" class="">Analysis cells</a></li></ol></div><div id="CoVYaNksVX" class="relative group/block"><h1 id="id-4-references" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">4. References</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-references" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><ul><li><p>Julien, Y. and Sobrino, J.A. (2019). Optimizing and comparing gap-filling techniques using simulated NDVI time series from remotely sensed global data. International Journal of Applied Earth Observation and Geoinformation, 76, pp.93-111.</p></li><li><p>de Oliveira, M.L.; dos Santos, C.A.C.; Santos, F.A.C.; de Oliveira, G.; Santos, C.A.G.; Bezerra, U.A.; de B. L. Cunha, J.E.; da Silva, R.M. (2023). Evaluation of Water and Carbon Estimation Models in the Caatinga Biome Based on Remote Sensing. Forests, 14, 828. <cite class="" data-state="closed"><a href="https://doi.org/10.3390/f14040828" target="_blank" rel="noreferrer" class="hover-link">Oliveira <em>et al.</em> (2023)</a></cite>.</p></li></ul></div><div id="zllLhQXBLP" class="relative group/block"><h1 id="id-5-key-conclusions" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">5. Key Conclusions</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-key-conclusions" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>Best interpolation teechnique depends on land cover being observed + length of missing data gap.</p><ul><li>short window →  better interpolation</li><li>GPR processing time takes almost 2x as much</li><li>Best interpolation technique for seasonal pattern:<ul><li>SHORT missing gap: linear, cubicSpline</li><li>LONG missing gap: Seasonal (but may be affected by climate change), GPR (but slightly more time-intensive)</li></ul></li><li>Best interpolation technique for non-seasonal: linear</li></ul><p>Note: when no data available over long periods, or when the missing data is at the end of the timeseries --&gt; cubic spline overshoots!</p><p>Disclaimer: Due to the coarse spatial resolution of this dataset (~28 km), certain land cover classes (e.g., cropland) could not be monitored in this case study. This framework however could be easily applied to ndvi timeseries acquired from other platforms (e.g. Sentinel-2) which would provide finer spatial resolution, allowing for field-scale monitoring.</p></div><div id="uRLtg90NFM" class="relative group/block"><h1 id="id-6-societal-context" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">6. Societal Context</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-societal-context" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>This is important for society because reliable, gap-free vegetation timeseries are useful for...</p><ul><li>tracking carbon dynamics in forests &amp; forest health</li><li>tracking crop phenological stages and agricultural management</li><li>wider applicability outside of vegetation domain i.e. interpolating climatic data or data acquired by other sensors</li></ul></div><div id="eOc50jTBDp" class="relative group/block"><h1 id="part-2-scientific-exploitation-and-analysis" class="relative group"><span class="heading-text">PART 2: SCIENTIFIC EXPLOITATION AND ANALYSIS</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-2-scientific-exploitation-and-analysis" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><hr class="py-2 my-5 translate-y-2"/></div><div id="I6gx1XGsQl" class="relative group/block"><h1 id="id-7-import-libraries" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">7. Import Libraries</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-import-libraries" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p><strong>This notebook runs with the python environment <code>deepesdl-xcube-1.1.2</code>, please checkout the documentation for <a target="_blank" rel="noreferrer" href="https://deepesdl.readthedocs.io/en/latest/guide/jupyterlab/#python-environment-selection-of-the-jupyter-kerne" class="">help on changing the environment</a>.</strong></p></div><div id="onAudGwl47" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Here is all the imports needed:
import xcube
import matplotlib.pyplot as plt
import xarray as xr
from xcube.core.store import new_data_store, get_data_store_params_schema
from xcube_stac.utils import reproject_bbox
import pandas as pd 
import numpy as np
import time
from sklearn.gaussian_process import GaussianProcessRegressor
from sklearn.metrics.pairwise import polynomial_kernel
from sklearn.gaussian_process.kernels import ConstantKernel, RBF,ExpSineSquared, WhiteKernel
from sklearn.metrics.pairwise import polynomial_kernel
import random

from sklearn.metrics import r2_score, mean_absolute_error, root_mean_squared_error, mean_absolute_percentage_error
import matplotlib.dates as mdates

# If one wants to try some more interpolation techniques....
from scipy.interpolate import (
    CubicHermiteSpline,
    lagrange,
    BarycentricInterpolator,
    interp1d,
    UnivariateSpline,
    splrep,
    splev,
    Rbf,
    CubicSpline,
    BSpline,
    PchipInterpolator,
    NearestNDInterpolator
)

</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3WZy_vPxDbL4hkBy2PL0P" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LY7QGtiASr" class="relative group/block"><h1 id="id-8-data-sources" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">8. Data sources</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-8-data-sources" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><br/><table class=""><tbody><tr class=""><th class="text-center">Datacube name</th><th class="text-center">Variable name</th><th class="text-center">Description</th><th class="text-center">Reference*</th><th class="text-center">Region</th><th class="text-center">Time range</th><th class="text-center">Resolution</th></tr><tr class=""><td class="text-center">(ESDC) v3.0.1</td><td class="text-center">ndvi</td><td class="text-center"><a target="_blank" rel="noreferrer" href="https://deepesdl.readthedocs.io/en/latest/datasets/ESDC/#air_temperature_2m" class="">metadata description</a></td><td class="text-center"><a target="_blank" rel="noreferrer" href="https://www.earthdata.nasa.gov/data/catalog/lpcloud-mcd43c4-061" class="">link to source</a></td><td class="text-center">World</td><td class="text-center">8 days</td><td class="text-center">0.25° (~28 km)</td></tr></tbody></table><p>Here you can start with accessing the relevant data:</p></div><div id="rT3oNbwGFp" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Access the data:
store = new_data_store(&quot;s3&quot;, root=&quot;deep-esdl-public&quot;)
store.list_data_ids()

#Earth System Data Cube (ESDC) v3.0.1
#-------------------------------------
data_store = new_data_store(&quot;s3&quot;, root=&quot;deep-esdl-public&quot;)
dataset    = data_store.open_data( &#x27;esdc-8d-0.25deg-256x128x128-3.0.1.zarr&#x27;)
ds         = dataset[[&quot;ndvi&quot;]]
ds

## SELECT OUR POINTS 
#-------------------------
AMAZON = [-63.80931839570286, -2.1399049279461497]
CAATINGA = [-40.091161552570036, -7.926450359938729]
ELMSTEIN = [7.918474, 49.377749] #Germany
MUARA = [113.868742, -0.095807] #Indonesia
ROCKIES =[-123.747338,59.156882] # Canada



# Visualise our data on a map:
ds.ndvi.isel(time=-1)[::10, ::10].plot(alpha=0.6, vmin=0, vmax=0.8)
plt.scatter(AMAZON[0], AMAZON[1], label=&quot;AMAZON&quot;,s=50,edgecolors=&#x27;black&#x27;,
    linewidths=1,)
plt.scatter(CAATINGA[0], CAATINGA[1], label=&quot;CAATINGA&quot;,s=50,edgecolors=&#x27;black&#x27;,
    linewidths=1,)
plt.scatter(ELMSTEIN[0], ELMSTEIN[1], label=&quot;ELMSTEIN&quot;, s=50, edgecolors=&#x27;black&#x27;,
    linewidths=1, color=&quot;purple&quot;)
plt.scatter(MUARA[0], MUARA[1], label=&quot;MUARA&quot;, color=&quot;pink&quot;,s=50,edgecolors=&#x27;black&#x27;,
    linewidths=1,)
plt.scatter(ROCKIES[0], ROCKIES[1], label=&quot;ROCKIES&quot;, color=&quot;red&quot;,s=50,edgecolors=&#x27;black&#x27;,
    linewidths=1,)

plt.title(&quot;ndvi&quot;)
plt.legend()

plt.show()
plt.close()

# Let&#x27;s visualise two timeseries (2017-2022) for these points:
#plt.figure()

fig, axs = plt.subplots(5, figsize=(10,12))

start_date= pd.to_datetime(&quot;2017-01-01&quot;)
end_date= pd.to_datetime(&quot;2022-01-01&quot;)


start_date = pd.to_datetime(start_date)
end_date = pd.to_datetime(end_date)

# Subset by time:
time_subsetA = ds.ndvi.sel(time=slice(start_date, end_date))



# Create Amazon timeseries
ds1dA = time_subsetA.sel(lat=AMAZON[1], lon=AMAZON[0], method=&quot;nearest&quot;)
# Plot Amazon timeseries
ds1dA.plot(label=&quot;AMAZON&quot;,color=&quot;tab:blue&quot;,marker=&quot;o&quot;,ax=axs[0])
axs[0].set_title(&quot;AMAZON&quot;)


# Create Caatinga timeseries
ds1dCA = time_subsetA.sel(lat=CAATINGA[1], lon=CAATINGA[0],method=&quot;nearest&quot;,)
# Plot Caatinga timeseries
ds1dCA.plot(label= &quot;CAATINGA&quot;, color = &quot;orange&quot;,marker=&quot;o&quot;,ax=axs[1])
axs[1].set_title(&quot;CAATINGA&quot;)



# Create Caatinga timeseries
ds1dE = time_subsetA.sel(lat=ELMSTEIN[1], lon=ELMSTEIN[0],method=&quot;nearest&quot;,)
# Plot Caatinga timeseries
ds1dE.plot(label= &quot;ELMSTEIN&quot;, color = &quot;purple&quot;,marker=&quot;o&quot;,ax=axs[2])
axs[2].set_title(&quot;ELMSTEIN&quot;)


# Create Caatinga timeseries
ds1dM = time_subsetA.sel(lat=MUARA[1], lon=MUARA[0],method=&quot;nearest&quot;,)
# Plot Caatinga timeseries
ds1dM.plot(label= &quot;MUARA&quot;, color = &quot;pink&quot;, marker=&quot;o&quot;,ax=axs[3])
axs[3].set_title(&quot;MUARA&quot;)


# Create Caatinga timeseries
ds1dR = time_subsetA.sel(lat=ROCKIES[1], lon=ROCKIES[0],method=&quot;nearest&quot;,)
# Plot Caatinga timeseries
ds1dR.plot(label= &quot;ROCKIES&quot;, color = &quot;red&quot;, marker=&quot;o&quot;,ax=axs[4])
axs[4].set_title(&quot;ROCKIES&quot;)


fig.tight_layout()
plt.show()
plt.close()

</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tEi_QwRefALXqFI9fOjxl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/c906187e1d530f252ca088d156ceecbe.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/eodashboard-notebooks/build/8ef9c61eba61c1f078c4eb7887f17e1b.png" alt="&lt;Figure size 1000x1200 with 5 Axes&gt;"/></div></div><div id="nXd8VVk0V5" class="relative group/block"><h1 id="id-9-analysis-cells" class="relative group"><span class="heading-text"><p><a target="_blank" rel="noreferrer" href="" class=""></a></p><span class="" style="color:DarkCyan">9. Analysis cells</span> </span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-9-analysis-cells" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>Please comment your code, describe the functions, remove dead and unreachable code.</p></div><div id="ZRPDflptcF" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">
def generate_gaps(time_values, gap_length, unit=&quot;days&quot;, n_gaps=2, seed=42, min_spacing=0):
    &quot;&quot;&quot;
    Generate gaps in a timeseries without overlaps and with minimum spacing.
    
    Parameters:
    - time_values: list of datetime values
    - gap_length: length of each gap
    - unit: &quot;days&quot;, &quot;weeks&quot;, &quot;months&quot;
    - n_gaps: number of gaps to generate
    - seed: random seed
    - min_spacing: minimum spacing between gaps (in same units as `unit`)
    
    Returns:
    - gaps: list of (start, end) tuples
    - actual_gap_length: length of each gap in days
    &quot;&quot;&quot;
    rng = random.Random(seed)
    gaps = []

    # Convert time_values to sorted pandas Series
    time_series = pd.Series(pd.to_datetime(time_values)).sort_values().reset_index(drop=True)

    # Convert min_spacing to DateOffset
    if unit == &quot;weeks&quot;:
        spacing_offset = pd.DateOffset(weeks=min_spacing)
        gap_offset = pd.DateOffset(weeks=gap_length)
        actual_gap_length = gap_length * 7
    elif unit == &quot;months&quot;:
        spacing_offset = pd.DateOffset(months=min_spacing)
        gap_offset = pd.DateOffset(months=gap_length)
        actual_gap_length = gap_length * 30  # approximate
    else:  # days
        spacing_offset = pd.DateOffset(days=min_spacing)
        gap_offset = pd.DateOffset(days=gap_length)
        actual_gap_length = gap_length

    attempts = 0
    max_attempts = n_gaps * 20  # safety to avoid infinite loops

    while len(gaps) &lt; n_gaps and attempts &lt; max_attempts:
        attempts += 1
        random_start = rng.choice(time_series)
        random_end = random_start + gap_offset

        # Check for overlap with existing gaps + min_spacing
        overlap = False
        for s, e in gaps:
            buffer_start = s - spacing_offset
            buffer_end = e + spacing_offset
            if (random_start &lt;= buffer_end) and (random_end &gt;= buffer_start):
                overlap = True
                break

        if not overlap:
            gaps.append((random_start, random_end))

    return gaps, actual_gap_length


def subset_data_with_gaps(ds, gaps, data_name=&quot;DATASET&quot;):
    &quot;&quot;&quot;
    Apply gaps to a dataset and plot.

    Parameters:
    - ds: xarray dataset with time dimension
    - gaps: list of (start, end) tuples
    - data_name: string for labeling

    Returns:
    - train_set: dataset excluding gap periods
    - test_set: dataset (gap periods)
    &quot;&quot;&quot;
    # Concatenate all gap periods into test_set
    test_sets = [ds.sel(time=slice(start, end)) for start, end in gaps]
    if test_sets:
        test_set = xr.concat(test_sets, dim=&quot;time&quot;).sortby(&quot;time&quot;)
    else:
        test_set = ds.isel(time=[])

    # Train set is everything else
    train_set = ds.sel(time=~ds[&#x27;time&#x27;].isin(test_set[&#x27;time&#x27;].values))

    # Compute duration of the first gap in days
    if gaps:
        first_gap_length = (gaps[0][1] - gaps[0][0]).days + 1  # +1 to include both start and end
    else:
        first_gap_length = 0

    # Plot
    plt.figure(figsize=(5, 4))
    train_set.plot.scatter(x=&#x27;time&#x27;, y=&#x27;ndvi&#x27;, color=&#x27;tab:blue&#x27;, label=f&#x27;Train - {data_name}&#x27;)
    if len(test_set.time) &gt; 0:
        test_set.plot.scatter(x=&#x27;time&#x27;, y=&#x27;ndvi&#x27;, color=&#x27;tab:green&#x27;, label=f&#x27;Test (gap) - {data_name}&#x27;)
    plt.legend()
    plt.ylim(0, 1)
    plt.title(f&quot;{data_name} with gap length: {first_gap_length} days&quot;)

    return train_set, test_set


# Choose a reference timeline (e.g., Amazon dataset)
ref_time = pd.to_datetime(ds1dA[&#x27;time&#x27;].values)

# Generate shared gaps once
gaps, days = generate_gaps(ref_time, gap_length=6, unit=&quot;months&quot;, n_gaps=4, seed=18, min_spacing=2)

# Apply same gaps to all datasets
train_setA, test_setA = subset_data_with_gaps(ds1dA, gaps, &quot;AMAZON&quot;)
train_setC, test_setC = subset_data_with_gaps(ds1dCA, gaps, &quot;CAATINGA&quot;)
train_setE, test_setE = subset_data_with_gaps(ds1dE, gaps, &quot;ELMSTEIN&quot;)
train_setM, test_setM = subset_data_with_gaps(ds1dM, gaps, &quot;MUARA&quot;)
train_setR, test_setR = subset_data_with_gaps(ds1dR, gaps, &quot;ROCKIES&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="00bfJLeOszIvEVBn36i_B" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/ad8f57ca41d12693bed012438bc2062f.png" alt="&lt;Figure size 500x400 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/c7b78142634694b151e5b1d22205ba0e.png" alt="&lt;Figure size 500x400 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/f7a5cb0294fc2f6a4e142a72c2010d57.png" alt="&lt;Figure size 500x400 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/c01aaa0c5ee94840c0c6d14681811277.png" alt="&lt;Figure size 500x400 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/d59529eff787be10220df84b05058b4d.png" alt="&lt;Figure size 500x400 with 1 Axes&gt;"/></div></div><div id="jGKfVgigMs" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># We define a function to calculate processing time:

def exec_time(start, end):
    &quot;&quot;&quot;
    This function calculates process execution time
    -----------------------------------------------
    
    input:
    - start time: start time. call with time.time()
    - end time: end of processing time. call time.time() again.

    output:
    - diff_time: time it took to run the process
    &quot;&quot;&quot;
    
    diff_time = end - start
    m, s = divmod(diff_time, 60)
    h, m = divmod(m, 60)
    s,m,h = int(round(s, 0)), int(round(m, 0)), int(round(h, 0))
    print(&quot;Execution Time: &quot;, diff_time )#+ &quot;{0:06d}:{1:06d}:{2:06d}&quot;.format(h, m, s)

    return diff_time
    
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="j1-pFtUEZ_6Lw7K935QrI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xJxSP2RL2M" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Start time counter
start = time.time()

def interpolation(TYPE, location):
    start = time.time()
    
    &quot;&quot;&quot;
    A function that interpolates our timeseries data.
    Input:
    - TYPE: choose among &quot;linear&quot;, 
    - location: pick our location

    output:
    - dfmetrics: a dataframe of accuracy metrics
    
    &quot;&quot;&quot;
    if location == &quot;Amazon&quot;:
        train_set = train_setA
        test_set = test_setA
        
    elif location == &quot;Caatinga&quot;:
        train_set = train_setC
        test_set = test_setC
            
    elif location == &quot;Elmstein&quot;:
        train_set = train_setE
        test_set = test_setE
        
        
    elif location == &quot;Muara&quot;:
        train_set = train_setM
        test_set = test_setM
    
    elif location == &quot;Rockies&quot;:
        train_set = train_setR
        test_set = test_setR
        
    # numeric time for interpolation
    train_time_num = (train_set.time.astype(&quot;int64&quot;) // 10**6).astype(&quot;int64&quot;).values
    test_time_num = (test_set.time.astype(&quot;int64&quot;) // 10**6).astype(&quot;int64&quot;).values

    # datetime for plotting
    train_time_dt = train_set.time.values
    test_time_dt = test_set.time.values
    

    # interpolation
    if TYPE == &quot;linear&quot;:
        f = interp1d(train_time_num, train_set.values, kind=TYPE, fill_value=&quot;extrapolate&quot;)
        interpolated_values = f(test_time_num)
        
        # plot with datetime
        plt.figure(figsize=(6, 5))
        plt.scatter(train_time_dt, train_set.values, label=&quot;train&quot;)
        plt.scatter(test_time_dt, interpolated_values, label=&quot;interpolated&quot;)
        plt.scatter(test_time_dt, test_set.values, label=&quot;real&quot;)

        plt.title(TYPE +&quot; interpolation - &quot; + location )
        plt.xlabel(&quot;Time&quot;)
        plt.ylabel(&quot;Values&quot;)

        # format x-axis as dates
        plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(&quot;%Y-%m-%d&quot;))
        plt.gcf().autofmt_xdate()

        plt.legend()
        #plt.show()
        
        R2 = r2_score(test_set.values, interpolated_values)
        RMSE = root_mean_squared_error(test_set.values, interpolated_values)
        MAPE = mean_absolute_percentage_error(test_set.values, interpolated_values)

        end = time.time()
        T =exec_time(start,end)

        dfmetrics = {&quot;R2&quot;: R2, &quot;RMSE&quot;:RMSE, &quot;MAPE&quot;:MAPE, &quot;days&quot;:days, &quot;kind&quot;:TYPE, &quot;time&quot;: T, &quot;location&quot;: location}
        
        #plt.savefig(&quot;Linear_&quot;+str(days)+&quot;_&quot;+location+&quot;.png&quot;, dpi=400)
        
    #Cubic Spline interpolation  
    if TYPE == &quot;CubicSpline&quot;:
        f = CubicSpline((train_set.time.astype(&quot;int64&quot;)//10**6).astype(&quot;int64&quot;).values, train_set.values)  # &#x27;linear&#x27; interpolation
        interpolated_values = f(test_time_num)
        
        # plot with datetime
        plt.figure(figsize=(6, 5))
        plt.scatter(train_time_dt, train_set.values, label=&quot;train&quot;)
        plt.scatter(test_time_dt, interpolated_values, label=&quot;interpolated&quot;)
        plt.scatter(test_time_dt, test_set.values, label=&quot;real&quot;)

        plt.title(TYPE +&quot; interpolation - &quot; + location )
        plt.xlabel(&quot;Time&quot;)
        plt.ylabel(&quot;Values&quot;)

        # format x-axis as dates
        plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(&quot;%Y-%m-%d&quot;))
        plt.gcf().autofmt_xdate()

        plt.legend()
        #plt.show()
        
        R2 = r2_score(test_set.values, interpolated_values)
        RMSE = root_mean_squared_error(test_set.values, interpolated_values)
        MAPE = mean_absolute_percentage_error(test_set.values, interpolated_values)

        end = time.time()
        T =exec_time(start,end)

        dfmetrics = {&quot;R2&quot;: R2, &quot;RMSE&quot;:RMSE, &quot;MAPE&quot;:MAPE, &quot;days&quot;:days, &quot;kind&quot;:TYPE, &quot;time&quot;: T, &quot;location&quot;: location}
        
        #plt.savefig(&quot;Cubic_&quot;+str(days)+&quot;_&quot;+location+&quot;.png&quot;, dpi=400)
        
    
    #Gaussian Process Regression interpolation
    if TYPE == &quot;GPR&quot;:
        start = time.time()

        # --- Convert train time to numeric days ---
        X_raw = train_set.time.values.astype(&quot;int64&quot;) // 10**9
        X_days = (X_raw - X_raw.min()) / (60*60*24)

        y = train_set.values
        if hasattr(y, &quot;to_numpy&quot;):
            y = y.to_numpy()

        # Mask observed values
        observed_mask = ~np.isnan(y)
        X_train = X_days[observed_mask].reshape(-1, 1)
        y_train = y[observed_mask]

        # --- Full timeline for prediction ---
        train_time_series = pd.Series(train_set.time.values)
        test_time_series = pd.Series(test_set.time.values)
        full_time = pd.concat([train_time_series, test_time_series]).sort_values().reset_index(drop=True)

        #convert date to a better format for GPR
        X_full = (full_time.values.astype(&quot;int64&quot;) // 10**9 - X_raw.min()) / (60*60*24)
        X_full = X_full.reshape(-1, 1)

        # --- Fit Gaussian Process ---
        # Pick our kernels: 
        #  RBF to account for smoothness,
        #  ExpSineSquared to account for seasonality
        #  WhiteKernel to accoutn for noise  
        kernel = RBF(length_scale=50.0) + ExpSineSquared(length_scale=50.0, periodicity=365.0) + WhiteKernel(noise_level=0.01)
        gp = GaussianProcessRegressor(kernel=kernel, n_restarts_optimizer=9, normalize_y=True)
        gp.fit(X_train, y_train)

        # --- Predict over full timeline ---
        y_pred, y_std = gp.predict(X_full, return_std=True)

        # --- Plot scatter like other methods ---
        plt.figure(figsize=(6,5))
        plt.scatter(train_set.time, train_set.values, label=&quot;train&quot;, color=&quot;tab:blue&quot;, s=20)
        plt.scatter(full_time, y_pred, label=&quot;interpolated (GPR)&quot;, color=&quot;tab:orange&quot;, s=20)
        plt.scatter(test_set.time, test_set.values, label=&quot;real&quot;, color=&quot;green&quot;, s=20)

        # Confidence interval
        plt.fill_between(full_time,
                         y_pred - 2*y_std,
                         y_pred + 2*y_std,
                         color=&quot;tab:orange&quot;, alpha=0.2, label=&quot;±2σ&quot;) #95% CI

        plt.title(f&quot;GPR interpolation - {location}&quot;)
        plt.xlabel(&quot;Time&quot;)
        plt.ylabel(&quot;Values&quot;)
        plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(&quot;%Y-%m-%d&quot;))
        plt.gcf().autofmt_xdate()
        plt.legend()
        #plt.show()

        # --- Metrics on test set only ---
        X_test = (test_set.time.values.astype(&quot;int64&quot;) // 10**9 - X_raw.min()) / (60*60*24)
        X_test = X_test.reshape(-1, 1)
        y_test = test_set.values
        if hasattr(y_test, &quot;to_numpy&quot;):
            y_test = y_test.to_numpy()
        y_test_pred, _ = gp.predict(X_test, return_std=True)

        R2 = r2_score(y_test, y_test_pred)
        RMSE = root_mean_squared_error(y_test, y_test_pred)
        MAPE = mean_absolute_percentage_error(y_test, y_test_pred)

        end = time.time()
        T = exec_time(start, end)

        dfmetrics = {&quot;R2&quot;: R2, &quot;RMSE&quot;: RMSE, &quot;MAPE&quot;: MAPE, &quot;days&quot;: days, &quot;kind&quot;: TYPE, &quot;time&quot;: T, &quot;location&quot;: location}

        #plt.savefig(&quot;GPR_&quot;+str(days)+&quot;_&quot;+location+&quot;.png&quot;, dpi=400)
        
    # --- Seasonal interpolation (with past and future window) ---
    elif TYPE == &quot;Seasonal&quot;:
        
        window_days=7
        train_df = pd.DataFrame({&quot;time&quot;: train_time_dt, &quot;value&quot;: train_set.values})
        train_df[&quot;doy&quot;] = train_df[&quot;time&quot;].dt.dayofyear
        test_time_dt1 = pd.to_datetime(test_time_dt)
        interpolated_values = []

        for t in test_time_dt1:
            doy_t = t.timetuple().tm_yday
            
            # Windowed selection
            window_vals = train_df[(train_df[&quot;doy&quot;] &gt;= doy_t - window_days) &amp; (train_df[&quot;doy&quot;] &lt;= doy_t + window_days)][&quot;value&quot;]
            
            if len(window_vals) &gt; 0:
                interpolated_values.append(window_vals.mean())
            else:
                diffs = np.abs(train_df[&quot;doy&quot;] - doy_t)
                idx_min = diffs.idxmin()
                interpolated_values.append(train_df.loc[idx_min, &quot;value&quot;])

        interpolated_values = np.array(interpolated_values)

        plt.figure(figsize=(6, 5))
        plt.scatter(train_time_dt, train_set.values, label=&quot;train&quot;)
        plt.scatter(test_time_dt, interpolated_values, label=&quot;interpolated (seasonal)&quot;, color=&quot;tab:orange&quot;)
        plt.scatter(test_time_dt, test_set.values, label=&quot;real&quot;, color=&quot;green&quot;)
        plt.title(&quot;Seasonal interpolation - &quot; + location)
        plt.xlabel(&quot;Time&quot;)
        plt.ylabel(&quot;Values&quot;)
        plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(&quot;%Y-%m-%d&quot;))
        plt.gcf().autofmt_xdate()
        plt.legend()
        #plt.show()

        R2 = r2_score(test_set.values, interpolated_values)
        RMSE = root_mean_squared_error(test_set.values, interpolated_values)
        MAPE = mean_absolute_percentage_error(test_set.values, interpolated_values)
        end = time.time()
        T = exec_time(start, end)

        dfmetrics = {&quot;R2&quot;: R2, &quot;RMSE&quot;: RMSE, &quot;MAPE&quot;: MAPE, &quot;days&quot;:days, &quot;kind&quot;:TYPE, &quot;time&quot;: T, &quot;location&quot;: location}
        #plt.savefig(&quot;Seasonal_&quot;+str(days)+&quot;_&quot;+location+&quot;.png&quot;, dpi=400)
        

    return dfmetrics
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LaqpiVn_EF38woq1x2Aj1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Nge9gvRCzv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#LINEAR INTERPOLATION
LC = interpolation(&quot;linear&quot;, &quot;Caatinga&quot;)
LA = interpolation(&quot;linear&quot;, &quot;Amazon&quot;)
LE =interpolation(&quot;linear&quot;, &quot;Elmstein&quot;)
LM = interpolation(&quot;linear&quot;, &quot;Muara&quot;)
LR = interpolation(&quot;linear&quot;, &quot;Rockies&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SujtCTaRchiMjjZJlTYfb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Execution Time:  0.35504698753356934
Execution Time:  0.6290695667266846
Execution Time:  0.37151408195495605
Execution Time:  0.4424552917480469
Execution Time:  0.5377426147460938
</span></code></pre></div><img src="/eodashboard-notebooks/build/145ea3982d47f221beafd334b3e2735f.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/307c3ee1a828fad231c9b02eaae5a0cf.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/98ddc156756c3dd609fd6bddd03e74a7.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/867ab41b8d0daaaa0e745e451df302f0.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/a0b93b5bfbff365ba8bd9ef678ef52fe.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/></div></div><div id="FaqU0BSDbI" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#CUBIC SPLINE INTERPOLATION
CC = interpolation(&quot;CubicSpline&quot;, &quot;Caatinga&quot;)
CA =interpolation(&quot;CubicSpline&quot;, &quot;Amazon&quot;)
CE =interpolation(&quot;CubicSpline&quot;, &quot;Elmstein&quot;)
CM =interpolation(&quot;CubicSpline&quot;, &quot;Muara&quot;)
CR =interpolation(&quot;CubicSpline&quot;, &quot;Rockies&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QiO7-qOtNpR8q3R-jQW48" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Execution Time:  0.38396620750427246
Execution Time:  0.6379997730255127
Execution Time:  0.3731379508972168
Execution Time:  0.44517946243286133
Execution Time:  0.5438599586486816
</span></code></pre></div><img src="/eodashboard-notebooks/build/4fdfc0a515e852de52501e5d46a7424f.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/c4c2e6ab0106c60d89ed02b98814e8bf.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/91bf5eff10762ebc2746219f3bb420ad.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/b373c64e1a801e17566fe4c11173e07d.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/6ad079476bce156af8b46763369200f4.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/></div></div><div id="k3XzMLLx46" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">GC = interpolation(&quot;GPR&quot;, &quot;Caatinga&quot;)
GA = interpolation(&quot;GPR&quot;, &quot;Amazon&quot;)
GE = interpolation(&quot;GPR&quot;, &quot;Elmstein&quot;)
GM = interpolation(&quot;GPR&quot;, &quot;Muara&quot;)
GR = interpolation(&quot;GPR&quot;, &quot;Rockies&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2enOYuuq9W-o2zp0fYKdH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Execution Time:  0.8819622993469238
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/home/conda/users/fbfe84b6-1757499783-109-science-hub-course-updated/lib/python3.13/site-packages/sklearn/gaussian_process/kernels.py:440: ConvergenceWarning: The optimal value found for dimension 0 of parameter k2__noise_level is close to the specified lower bound 1e-05. Decreasing the bound and calling fit again may find a better value.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Execution Time:  1.1756927967071533
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/home/conda/users/fbfe84b6-1757499783-109-science-hub-course-updated/lib/python3.13/site-packages/sklearn/gaussian_process/_gpr.py:663: ConvergenceWarning: lbfgs failed to converge after 1 iteration(s) (status=2):
ABNORMAL: 

You might also want to scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
  _check_optimize_result(&quot;lbfgs&quot;, opt_res)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Execution Time:  1.2742934226989746
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/home/conda/users/fbfe84b6-1757499783-109-science-hub-course-updated/lib/python3.13/site-packages/sklearn/gaussian_process/_gpr.py:663: ConvergenceWarning: lbfgs failed to converge after 2 iteration(s) (status=2):
ABNORMAL: 

You might also want to scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
  _check_optimize_result(&quot;lbfgs&quot;, opt_res)
/home/conda/users/fbfe84b6-1757499783-109-science-hub-course-updated/lib/python3.13/site-packages/sklearn/gaussian_process/kernels.py:450: ConvergenceWarning: The optimal value found for dimension 0 of parameter k1__k2__periodicity is close to the specified upper bound 100000.0. Increasing the bound and calling fit again may find a better value.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Execution Time:  1.1290569305419922
Execution Time:  1.4447743892669678
</span></code></pre></div><img src="/eodashboard-notebooks/build/8815af2a9db2fad877165534ac052afb.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/56fc5457197185af58c2b01384096eda.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/ff19492a5537527e87182a3df90f399a.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/f9c2e2bb08f7c18165883fcebe6d07df.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/a9a3e94278cd00c2e8fa4af82e5a5898.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/></div></div><div id="Z9qXpD7dMt" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">SC = interpolation(&quot;Seasonal&quot;, &quot;Caatinga&quot;)
SA = interpolation(&quot;Seasonal&quot;, &quot;Amazon&quot;)
SE = interpolation(&quot;Seasonal&quot;, &quot;Elmstein&quot;)
SM =interpolation(&quot;Seasonal&quot;, &quot;Muara&quot;)
SR =interpolation(&quot;Seasonal&quot;, &quot;Rockies&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YfVfT9y7ack_fo62BLIXp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Execution Time:  0.3807833194732666
Execution Time:  0.6626808643341064
Execution Time:  0.3941342830657959
Execution Time:  0.4735894203186035
Execution Time:  0.5647144317626953
</span></code></pre></div><img src="/eodashboard-notebooks/build/9cd3d01d521375ca700c46a29abc2e60.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/b032a63ed4fad485b5f2e5dc9b32ebb9.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/2dd1c8c694c7e594996e92f57e4e671e.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/b06c3f702c32d98dddee201688716b68.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/><img src="/eodashboard-notebooks/build/f77f6cda3f947fa893e2db9a1f9881a6.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/></div></div><div id="nIv6jz6AVr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># collate all metrics ! 
metrics = [LA, LC, LE, LM, LR, 
           CA, CC, CE, CM, CR,
            SC, SA, SE, SM ,SR,
           GA, GC, GE, GM, GR]


DFmetrics = pd.DataFrame(metrics)

#divide time by 10 to make it fit into plot
DFmetrics.time=DFmetrics.time/10
DFmetrics</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qUF5M9NAgkX_Qvk33f_Q8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="XU9AQyQDjk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df = DFmetrics
metrics = [&quot;R2&quot;,&quot;RMSE&quot;, &quot;time&quot;]
locations = df[&quot;location&quot;].unique()

fig, axes = plt.subplots(1, len(locations), figsize=(5*len(locations), 5), sharey=False)

for i, loc in enumerate(locations):
    sub = df[df[&quot;location&quot;] == loc]
    
    # x positions = kinds
    kinds = sub[&quot;kind&quot;].unique()
    x = np.arange(len(kinds))
    width = 0.25  # width of each bar
    
    for j, metric in enumerate(metrics):
        axes[i].bar(x + j*width, sub[metric], width, label=metric)
    
    axes[i].set_title(loc)
    axes[i].set_ylim(0,1.2)
    axes[i].set_xticks(x + width)
    axes[i].set_xticklabels(kinds, rotation=30)
    axes[i].set_ylabel(&quot;Value&quot;)
    axes[i].grid(axis=&quot;y&quot;, linestyle=&quot;--&quot;, alpha=0.7)


# put one legend for all
handles, labels = axes[0].get_legend_handles_labels()
fig.legend(handles, labels, loc=&quot;upper center&quot;, ncol=len(metrics))

plt.tight_layout(rect=[0, 0, 1, 0.95])

#plt.savefig(&quot;Summary_&quot;+str(days)+&quot;days.png&quot;, dpi=300)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2iQrVyzLJ6Wv_N6mEh-Eu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/c81a410dc8bf8b81e6e7e43668fa588e.png" alt="&lt;Figure size 2500x500 with 5 Axes&gt;"/></div></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-de_Oliveira_2023">de Oliveira, M. L., dos Santos, C. A. C., Santos, F. A. C., de Oliveira, G., Santos, C. A. G., Bezerra, U. A., de B. L. Cunha, J. E., & da Silva, R. M. (2023). Evaluation of Water and Carbon Estimation Models in the Caatinga Biome Based on Remote Sensing. <i>Forests</i>, <i>14</i>(4), 828. <a target="_blank" rel="noreferrer" href="https://doi.org/10.3390/f14040828">10.3390/f14040828</a></li></ol></div></section></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/eodashboard-notebooks/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/notebooks/openchallangenotebook-team-5-challenge-3-timeserie","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true,"style":"/eodashboard-notebooks/build/custom-9aa6e19c4d561b85d0cc8e22a3d167b2.css"},"nav":[],"actions":[],"projects":[{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-4cd88007f691f5591a10238dd3808047.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-9297cdd4fad11689d55cbd74099d432b.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/eodashboard-notebooks"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true,"style":"/eodashboard-notebooks/build/custom-9aa6e19c4d561b85d0cc8e22a3d167b2.css"},"nav":[],"actions":[],"projects":[{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-4cd88007f691f5591a10238dd3808047.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-9297cdd4fad11689d55cbd74099d432b.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"page":{"version":2,"kind":"Notebook","sha256":"8dd017447f46aee8a97f6cae923e6955b50fb6643f408e0ad51a0dab8b149a95","slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","location":"/notebooks/OpenChallangeNotebook-TEAM-5_CHALLENGE-3_Timeseries-Interpolation_UPDATED.ipynb","dependencies":[],"frontmatter":{"title":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","content_includes_title":true,"kernelspec":{"name":"conda-env-users-science-hub-course-updated-py","display_name":"users-science-hub-course-updated","language":"python"},"github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","subject":"Notebook examples","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/ESA-eodashboards/eodashboard-notebooks/blob/main/notebooks/OpenChallangeNotebook-TEAM-5_CHALLENGE-3_Timeseries-Interpolation_UPDATED.ipynb","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","exports":[{"format":"ipynb","filename":"OpenChallangeNotebook-TEAM-5_CHALLENGE-3_Timeseries-Interpolation_UPDATED.ipynb","url":"/eodashboard-notebooks/build/OpenChallangeNoteboo-471d51ba7c959281d989b93b5ebec60d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","alt":"Sept-2025-Venice-Edinburgh-Leeds.jpg","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rMs6zEBYPC","urlSource":"data:image/jpeg;base64,/9j/4AAQSk...KKAP/2Q==\n"}],"key":"VYcM5XbRKg"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"div","class":"alert alert-info","children":[{"type":"text","value":"This concise notebook demonstrates guidelines for submission of your projects developed under the ","key":"eJYMxKCIJk"},{"type":"strong","children":[{"type":"text","value":"Earth System Science Open Challenge!","key":"AicamUdzEk"}],"key":"SZEcHtFQdP"},{"type":"break","key":"kcT55fEfCC"},{"type":"text","value":" Please use this notebook as a template for delivering your workflow with the code you used to produce the results! ","key":"NCRbgOrm1p"},{"type":"break","key":"MzNvYfM08b"},{"type":"text","value":"For more information, refer to Open Challenge website: ","key":"AoiZggC5ZO"},{"type":"link","url":"https://eo4society.esa.int/event/sciencehubchallengefeb2024/","children":[{"type":"text","value":"https://​eo4society​.esa​.int​/event​/sciencehubchallengefeb2024/","key":"hxvAVkhfub"}],"urlSource":"https://eo4society.esa.int/event/sciencehubchallengefeb2024/","key":"Tjp96NMFhC"},{"type":"break","key":"Stdiu4HHXv"}],"key":"cEJl7ZfSKG"}],"visibility":"show","key":"JbJObIjib2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u1RA0PONiw"}],"identifier":"earth-system-science-hub-challenge-3-time-series-interpolation-techniques-for-remote-sensing-fran-denise-mae","label":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","html_id":"earth-system-science-hub-challenge-3-time-series-interpolation-techniques-for-remote-sensing-fran-denise-mae","implicit":true,"key":"tnKzGjYKxA"},{"type":"thematicBreak","key":"cl513DUEpB"}],"key":"Bq7v9sGIFc"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section1","label":"section1","url":"","children":[],"urlSource":"","key":"eLGW9Ot11b"}],"key":"SQlvQGKyNs"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"1. Title","key":"uxzMfSQQqS"}],"key":"QcyJcLpoGS"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EzAbn5sY3a"}],"identifier":"id-1-title","label":"1. Title ","html_id":"id-1-title","implicit":true,"key":"e7eQrHpBj0"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Author(s):","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"cOTKFBypvH"}],"key":"seVKhUBeoe"},{"type":"text","value":"  Fran, Denise, Mae ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tA5DGzNYOb"},{"type":"break","key":"XSCM1Q9x2o"},{"type":"text","value":"\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nxkRsTtjNk"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Group name:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hy48BJQq4k"}],"key":"HBgQMd1Why"},{"type":"text","value":" “Team 5” ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sENGA4BSjx"},{"type":"break","key":"tT8M09aS8G"},{"type":"text","value":"\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"T8gq7QaLQg"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Challenge:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rpcvSyA2Qf"}],"key":"rRMD6DZrZN"},{"type":"text","value":" Challenge 3: Time series interpolation techniques for remote sensing. From: ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"df9tRzjjPP"},{"type":"link","url":"https://eo4society.esa.int/wp-content/uploads/2024/02/Earth-System-Science-Hub-Challenges-February-2024-PREVIEW.pdf","children":[{"type":"text","value":"link to challenges","key":"JmnaUNe4Rt"}],"urlSource":"https://eo4society.esa.int/wp-content/uploads/2024/02/Earth-System-Science-Hub-Challenges-February-2024-PREVIEW.pdf","key":"H4d7yX0akU"},{"type":"text","value":" ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Z3HUlBt83d"},{"type":"break","key":"T2Z7xE1pkT"}],"key":"Yrt7DSa3r0"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Submission date:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"f75oBeItER"}],"key":"lQtAaifxM6"},{"type":"text","value":" 06 Oct 2025 ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sRkPwhXvH1"},{"type":"break","key":"CCYLD6VLLH"},{"type":"text","value":"\n","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"r9K5NLTnyt"},{"type":"break","key":"ddZrDIhB3Y"}],"key":"eiYpymF8J9"}],"visibility":"show","key":"oFqpRvUCdk"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section2","label":"section2","url":"","children":[],"urlSource":"","key":"nlM65ozAAg"}],"key":"CCYA5fyaiJ"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"2. Description","key":"qCPeGUH3lc"}],"key":"vm2ek5Dp8F"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BIpn970FOP"}],"identifier":"id-2-description","label":"2. Description ","html_id":"id-2-description","implicit":true,"key":"CnCByOW30l"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Scientific problem:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W3yCDUglBm"}],"identifier":"scientific-problem","label":"Scientific problem:","html_id":"scientific-problem","implicit":true,"key":"zp8tQkF7Ug"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Vegetation EO time series are crucial for monitoring ecosystem health, agricultural productivity and climate impacts.\nNDVI (Normalised Difference Vegetation Index) time series often suffer from residual cloud presence, even after data pre-processing.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mYdx9KQMRp"}],"key":"fBYZ7sOX6O"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Depending on land cover type, NDVI time series reconstructions may perform differently due to varying periodicity, amplitude or steepness of transitions (Julien and Sobrino, 2019).","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gKbkTdDak8"}],"key":"mwLsfANkRf"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Accurate interpolation is essential to ensure reliable analysis of vegetation dynamics !","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"DAviICYiHA"}],"key":"jNxyWegtwW"},{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Objective:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ugQsbDwoQL"}],"identifier":"objective","label":"Objective:","html_id":"objective","implicit":true,"key":"vrzSRvGqxU"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Design and implement a reproducible framework to compare multiple time series interpolation techniques on vegetation EO datasets with artificially introduced temporal gaps.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"vVnCbUKtUm"}],"key":"hRqVZnbUnI"},{"type":"heading","depth":2,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Methods:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Oyi4kJEehK"}],"identifier":"methods","label":"Methods:","html_id":"methods","implicit":true,"key":"sDB5ljCt5t"},{"type":"heading","depth":3,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Location selection","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"OSGlSNwDOM"}],"identifier":"location-selection","label":"Location selection","html_id":"location-selection","implicit":true,"key":"bw2kcaIbNj"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"We select 5 points:","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"fzUlwLTl4i"}],"key":"SS539zHEz6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"one in Amazon (Low seasonality, High precipitation, 123 billion tonnes of carbon (NOAA, 2021))","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"LeDOs7v5vc"}],"key":"IyjwX8col7"}],"key":"NUoRBTcgZN"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"one in Caatinga (High Seasonality, High precipitation, Nearly 100,000 km2 and large flux of carbon, water, and other compounds with the atmosphere with seasons)","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"OljHQdoIYj"}],"key":"kGw3sb4dEe"}],"key":"DLl3l4Ge71"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"one in Elmstein, Germany (High seasonality, Medium precipitation)","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"EZGnglNNKQ"}],"key":"NhjoS3F7oj"}],"key":"kHlJIrpSnq"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"one in Muara, Indonesia (High Seasonality - monsoonal pattern, High precipitation)","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"fkN9L0lr5q"}],"key":"Wl6BhCH5Gg"}],"key":"B0tI8Ox3ko"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"one in the Canadian Rockies (High seasonality, medium precipitation, boreal)","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"E2ypFIO4UX"}],"key":"lr9O13Mugx"}],"key":"evMbNomsQm"}],"key":"vxd4E7Y88R"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Then:","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Xg82EK5KWQ"}],"key":"uuCNyTAr7w"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Extract timeseries over each point for the period 2017-2022","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Bo7BaKtGaM"}],"key":"e1Ush9jaP3"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"introduce artifical gaps","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"mjFlYQIOR0"}],"key":"RywgMTclRM"},{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Interpolate using various techniques","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"WIUEAFwoJi"}],"key":"IhECYbnJkl"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"measure metrics (R2, RMSE, processing time)","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"C3StduNOrQ"}],"key":"MNUJl2yfAX"}],"key":"WsJeSJQCxW"},{"type":"heading","depth":3,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Data used:","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"hyLrYyysL4"}],"identifier":"data-used","label":"Data used:","html_id":"data-used","implicit":true,"key":"gJUil9KhFd"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"ndvi timeseries from DeepESDL Earth System Datacube (ESDC) v.3.0.1","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"a0AY58gLCW"}],"key":"qn3mjq9VbX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":44,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Temporal resolution: 8 days","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"iVclnKv2VO"}],"key":"AXKvBtlpal"},{"type":"listItem","spread":true,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"spatial resolution: 0.25° (~28 km)","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"LYGPSYYS4Z"}],"key":"FRmFKQmdEl"},{"type":"listItem","spread":true,"position":{"start":{"line":46,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Derived from MODIS Terra + Aqua BRDF corrected daily reflectance data","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"na5n6PRf5v"}],"key":"cWu7MVQ6KU"}],"key":"slxHuVaBpL"},{"type":"heading","depth":3,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Interpolation techniques tested:","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"xFy28Y3R1m"}],"identifier":"interpolation-techniques-tested","label":"Interpolation techniques tested:","html_id":"interpolation-techniques-tested","implicit":true,"key":"bM5oSsJWdb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":51,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"Linear interpolation: fit a line through the points.","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"zTM8hsAQaH"}],"key":"BIvgHQ9g85"},{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Cubic Spline: uses piecewise cubic polynomials to create a smooth curve passing through a set of points.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"EkK16FxuPN"}],"key":"dV5K9YisOT"},{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Gaussian Process Regression: Bayesian ML method that models data as a smooth curve with uncertainty. Smooth trend, seasonality noise accounted for using custom kernels.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"iaHpXWwi5y"}],"key":"tlwq2S1nrh"},{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Climatology Fill (seasonal): uses average values from previous 4 years to deduce pattern at missing time.","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"CeXxn6eMc2"}],"key":"o4Lm7bdqBD"}],"key":"vgYIpotC2c"}],"visibility":"show","key":"HyocJnzLgl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section3","label":"section3","url":"","children":[],"urlSource":"","key":"m5gOlMjl9f"}],"key":"KTKh1o1qvI"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"3. Table of Contents","key":"hnMtG51pxv"}],"key":"mh2yEdO5uZ"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NdZcjM5twT"}],"identifier":"id-3-table-of-contents","label":"3. Table of Contents ","html_id":"id-3-table-of-contents","implicit":true,"key":"bpJ3dvnNx6"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"#section1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Title","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HG7MorC3kP"}],"urlSource":"#section1","key":"oG8QSbztwH"}],"key":"X2JRSfsnHb"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"#section2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XhP2hxxWJw"}],"urlSource":"#section2","key":"rOgMOMNipJ"}],"key":"OtxaFh56ge"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"#section3","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Table of Contents","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ifXvE9gpRI"}],"urlSource":"#section3","key":"xBVWnk6ke4"}],"key":"CtCfTWswNj"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"#section4","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mbSfMwdlEP"}],"urlSource":"#section4","key":"oCkNXwe6z1"}],"key":"PddamlcyYv"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"#section5","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Key Conclusions","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xFmZW7NFE1"}],"urlSource":"#section5","key":"XAYIwTcCTa"}],"key":"Xmmpi0nlYs"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"#section6","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Societal Context","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jAxIUarsOs"}],"urlSource":"#section6","key":"iaYbvetIIk"}],"key":"rLwJbLhq7l"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"#section7","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Import libraries","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"koAwLuZ7fH"}],"urlSource":"#section7","key":"tiWpusAqad"}],"key":"fy94wfsxVn"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"#section8","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Access dataset","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"cBHKOcLqVh"}],"urlSource":"#section8","key":"VuOtQhJ87F"}],"key":"qBkKUDYHzQ"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"#section9","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Analysis cells","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"wBaYEUhAbV"}],"urlSource":"#section9","key":"jfcIRMsifP"}],"key":"ftzoGedw5b"}],"key":"CuSap5Y1aG"}],"key":"jHL4tgzi1l"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section4","label":"section4","url":"","children":[],"urlSource":"","key":"v9uKfcz9YM"}],"key":"IQ8bU4MC9C"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"4. References","key":"wziVtLOHND"}],"key":"B7r1BBhk9g"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"THoXib8rDf"}],"identifier":"id-4-references","label":"4. References ","html_id":"id-4-references","implicit":true,"key":"YlNP5jnys6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Julien, Y. and Sobrino, J.A. (2019). Optimizing and comparing gap-filling techniques using simulated NDVI time series from remotely sensed global data. International Journal of Applied Earth Observation and Geoinformation, 76, pp.93-111.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XQuGOVHHzX"}],"key":"TXNYsAL0du"}],"key":"r6XAgqgRux"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"de Oliveira, M.L.; dos Santos, C.A.C.; Santos, F.A.C.; de Oliveira, G.; Santos, C.A.G.; Bezerra, U.A.; de B. L. Cunha, J.E.; da Silva, R.M. (2023). Evaluation of Water and Carbon Estimation Models in the Caatinga Biome Based on Remote Sensing. Forests, 14, 828. ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"F9jtm26Onv"},{"type":"cite","url":"https://doi.org/10.3390/f14040828","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Oliveira ","key":"nlbqSaq4Rw"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"C8UVnQkHs6"}],"key":"fXMdReh55C"},{"type":"text","value":" (2023)","key":"wZiXEamy6M"}],"kind":"narrative","label":"de_Oliveira_2023","identifier":"https://doi.org/10.3390/f14040828","enumerator":"1","key":"nltAcbDxxQ"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Dkmp9v7ikQ"}],"key":"XnUcZgjySI"}],"key":"CmMBW8871g"}],"key":"T6ZtfmzApy"}],"key":"CoVYaNksVX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section5","label":"section5","url":"","children":[],"urlSource":"","key":"Wiy50wrFEW"}],"key":"QFGf0aCNsn"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"5. Key Conclusions","key":"Q342BZktcm"}],"key":"OwrLQKnU9p"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rTzqGi6aaG"}],"identifier":"id-5-key-conclusions","label":"5. Key Conclusions ","html_id":"id-5-key-conclusions","implicit":true,"key":"h7INgo3Dmu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Best interpolation teechnique depends on land cover being observed + length of missing data gap.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O7elXBdcbL"}],"key":"b0vtaWJFWy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"short window →  better interpolation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AzrxyJLjTs"}],"key":"mCytWWxSxD"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GPR processing time takes almost 2x as much","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"G0NiYRY0Kw"}],"key":"UbhxszNXIj"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Best interpolation technique for seasonal pattern:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Sp1MHLgl6G"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SHORT missing gap: linear, cubicSpline","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cbRGrRS2rr"}],"key":"uUxblLDiRF"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"LONG missing gap: Seasonal (but may be affected by climate change), GPR (but slightly more time-intensive)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"da4oeZpsUE"}],"key":"WuAUvHByPh"}],"key":"U8IAGAFsHr"}],"key":"kG4cGj02A0"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Best interpolation technique for non-seasonal: linear","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"A6jZcK48s7"}],"key":"JzNduUmQ86"}],"key":"wFyW2coQO3"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Note: when no data available over long periods, or when the missing data is at the end of the timeseries --\u003e cubic spline overshoots!","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ycSI9XemDF"}],"key":"UHqbFg8Zxh"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Disclaimer: Due to the coarse spatial resolution of this dataset (~28 km), certain land cover classes (e.g., cropland) could not be monitored in this case study. This framework however could be easily applied to ndvi timeseries acquired from other platforms (e.g. Sentinel-2) which would provide finer spatial resolution, allowing for field-scale monitoring.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ysv7NyN88n"}],"key":"D0cattSDDJ"}],"key":"zllLhQXBLP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section6","label":"section6","url":"","children":[],"urlSource":"","key":"esPRaJeYON"}],"key":"DwS98irQLz"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"6. Societal Context","key":"jGqrqstn8S"}],"key":"EFUAZ8MjPo"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OASJEVxftD"}],"identifier":"id-6-societal-context","label":"6. Societal Context ","html_id":"id-6-societal-context","implicit":true,"key":"LWW2HDikpY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is important for society because reliable, gap-free vegetation timeseries are useful for...","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cIHqckDacZ"}],"key":"UFvrpiBsXa"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"tracking carbon dynamics in forests \u0026 forest health","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gLJrIOJr97"}],"key":"DChhcT8kjy"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"tracking crop phenological stages and agricultural management","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iza7r27iT4"}],"key":"fVDASVYZsv"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"wider applicability outside of vegetation domain i.e. interpolating climatic data or data acquired by other sensors","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pOpnVbLeDW"}],"key":"eQIAG1dqJp"}],"key":"tEY6H23Qaf"}],"key":"uRLtg90NFM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PART 2: SCIENTIFIC EXPLOITATION AND ANALYSIS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FK53wlOsFX"}],"identifier":"part-2-scientific-exploitation-and-analysis","label":"PART 2: SCIENTIFIC EXPLOITATION AND ANALYSIS","html_id":"part-2-scientific-exploitation-and-analysis","implicit":true,"key":"MHXbtDeZc9"},{"type":"thematicBreak","key":"ava1aQOxkH"}],"key":"eOc50jTBDp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section7","label":"section7","url":"","children":[],"urlSource":"","key":"AjlaAV6TA1"}],"key":"f7wGcLylJ0"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"7. Import Libraries","key":"YnkHyXDl5V"}],"key":"fYCSLUAGTI"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u6Naqxpraj"}],"identifier":"id-7-import-libraries","label":"7. Import Libraries ","html_id":"id-7-import-libraries","implicit":true,"key":"xeNORh1j64"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook runs with the python environment ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pGF2kVKcjh"},{"type":"inlineCode","value":"deepesdl-xcube-1.1.2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kH83OLDICg"},{"type":"text","value":", please checkout the documentation for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f714mgpTqq"},{"type":"link","url":"https://deepesdl.readthedocs.io/en/latest/guide/jupyterlab/#python-environment-selection-of-the-jupyter-kerne","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"help on changing the environment","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rdm9XA6cYg"}],"urlSource":"https://deepesdl.readthedocs.io/en/latest/guide/jupyterlab/#python-environment-selection-of-the-jupyter-kerne","key":"ruZwD9i3jE"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V1BujsWIE2"}],"key":"rxFZNtjEj1"}],"key":"Yxsz0sUcui"}],"key":"I6gx1XGsQl"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Here is all the imports needed:\nimport xcube\nimport matplotlib.pyplot as plt\nimport xarray as xr\nfrom xcube.core.store import new_data_store, get_data_store_params_schema\nfrom xcube_stac.utils import reproject_bbox\nimport pandas as pd \nimport numpy as np\nimport time\nfrom sklearn.gaussian_process import GaussianProcessRegressor\nfrom sklearn.metrics.pairwise import polynomial_kernel\nfrom sklearn.gaussian_process.kernels import ConstantKernel, RBF,ExpSineSquared, WhiteKernel\nfrom sklearn.metrics.pairwise import polynomial_kernel\nimport random\n\nfrom sklearn.metrics import r2_score, mean_absolute_error, root_mean_squared_error, mean_absolute_percentage_error\nimport matplotlib.dates as mdates\n\n# If one wants to try some more interpolation techniques....\nfrom scipy.interpolate import (\n    CubicHermiteSpline,\n    lagrange,\n    BarycentricInterpolator,\n    interp1d,\n    UnivariateSpline,\n    splrep,\n    splev,\n    Rbf,\n    CubicSpline,\n    BSpline,\n    PchipInterpolator,\n    NearestNDInterpolator\n)\n\n","visibility":"show","key":"jlfr13XeOA"},{"type":"output","id":"3WZy_vPxDbL4hkBy2PL0P","data":[],"visibility":"show","key":"iOUifDuvxE"}],"visibility":"show","key":"onAudGwl47"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section8","label":"section8","url":"","children":[],"urlSource":"","key":"Dn5uMTIn6F"}],"key":"oqTTx4mPLw"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"8. Data sources","key":"FdZEX3iksQ"}],"key":"XiPC6WBoMl"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CAwa4WTj9l"}],"identifier":"id-8-data-sources","label":"8. Data sources ","html_id":"id-8-data-sources","implicit":true,"key":"nFe8Q6jXV9"},{"type":"break","key":"uuHzWPgbDr"},{"type":"table","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Datacube name","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Y5ucRFPNza"}],"key":"j4ZJh4ocBe"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Variable name","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JIGcVdzfYd"}],"key":"cQmsTjqXWG"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UNr5IJKJqj"}],"key":"z8N7wysgkg"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Reference*","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Xn5uKQh1am"}],"key":"bDeTGgbDlk"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Region","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hU35Fc1hJx"}],"key":"WPbVU5l1oq"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Time range","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DKVFp2zcMq"}],"key":"S50AsuK9hk"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Resolution","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gsCvNU0wj3"}],"key":"qnECaQEeMW"}],"key":"LosOXroPg0"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"(ESDC) v3.0.1","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"G3Uf5udSuV"}],"key":"BbHvuckAsi"},{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"ndvi","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"IJWDM7sbEN"}],"key":"tIUKCBKhjT"},{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://deepesdl.readthedocs.io/en/latest/datasets/ESDC/#air_temperature_2m","children":[{"type":"text","value":"metadata description","key":"GeKBqmiWUr"}],"urlSource":"https://deepesdl.readthedocs.io/en/latest/datasets/ESDC/#air_temperature_2m","key":"DOMSCTdYfm"}],"key":"fzk0AIy8xP"},{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://www.earthdata.nasa.gov/data/catalog/lpcloud-mcd43c4-061","children":[{"type":"text","value":"link to source","key":"nBkHxpn33v"}],"urlSource":"https://www.earthdata.nasa.gov/data/catalog/lpcloud-mcd43c4-061","key":"EgD3YYYUKB"}],"key":"XhIcyNVlkO"},{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"World","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xH9gj1ZfHc"}],"key":"aTpsw0uq3z"},{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"8 days","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"nBEPC5JDcN"}],"key":"RCcP7YQpob"},{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"0.25° (~28 km)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NE3CTzt5mA"}],"key":"fFz3KYWTYP"}],"key":"jBskAK0fk4"}],"key":"yBGEcTfmiZ"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Here you can start with accessing the relevant data:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"n96ih2jWn9"}],"key":"Kyy9tZ8Wdl"}],"visibility":"show","key":"LY7QGtiASr"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Access the data:\nstore = new_data_store(\"s3\", root=\"deep-esdl-public\")\nstore.list_data_ids()\n\n#Earth System Data Cube (ESDC) v3.0.1\n#-------------------------------------\ndata_store = new_data_store(\"s3\", root=\"deep-esdl-public\")\ndataset    = data_store.open_data( 'esdc-8d-0.25deg-256x128x128-3.0.1.zarr')\nds         = dataset[[\"ndvi\"]]\nds\n\n## SELECT OUR POINTS \n#-------------------------\nAMAZON = [-63.80931839570286, -2.1399049279461497]\nCAATINGA = [-40.091161552570036, -7.926450359938729]\nELMSTEIN = [7.918474, 49.377749] #Germany\nMUARA = [113.868742, -0.095807] #Indonesia\nROCKIES =[-123.747338,59.156882] # Canada\n\n\n\n# Visualise our data on a map:\nds.ndvi.isel(time=-1)[::10, ::10].plot(alpha=0.6, vmin=0, vmax=0.8)\nplt.scatter(AMAZON[0], AMAZON[1], label=\"AMAZON\",s=50,edgecolors='black',\n    linewidths=1,)\nplt.scatter(CAATINGA[0], CAATINGA[1], label=\"CAATINGA\",s=50,edgecolors='black',\n    linewidths=1,)\nplt.scatter(ELMSTEIN[0], ELMSTEIN[1], label=\"ELMSTEIN\", s=50, edgecolors='black',\n    linewidths=1, color=\"purple\")\nplt.scatter(MUARA[0], MUARA[1], label=\"MUARA\", color=\"pink\",s=50,edgecolors='black',\n    linewidths=1,)\nplt.scatter(ROCKIES[0], ROCKIES[1], label=\"ROCKIES\", color=\"red\",s=50,edgecolors='black',\n    linewidths=1,)\n\nplt.title(\"ndvi\")\nplt.legend()\n\nplt.show()\nplt.close()\n\n# Let's visualise two timeseries (2017-2022) for these points:\n#plt.figure()\n\nfig, axs = plt.subplots(5, figsize=(10,12))\n\nstart_date= pd.to_datetime(\"2017-01-01\")\nend_date= pd.to_datetime(\"2022-01-01\")\n\n\nstart_date = pd.to_datetime(start_date)\nend_date = pd.to_datetime(end_date)\n\n# Subset by time:\ntime_subsetA = ds.ndvi.sel(time=slice(start_date, end_date))\n\n\n\n# Create Amazon timeseries\nds1dA = time_subsetA.sel(lat=AMAZON[1], lon=AMAZON[0], method=\"nearest\")\n# Plot Amazon timeseries\nds1dA.plot(label=\"AMAZON\",color=\"tab:blue\",marker=\"o\",ax=axs[0])\naxs[0].set_title(\"AMAZON\")\n\n\n# Create Caatinga timeseries\nds1dCA = time_subsetA.sel(lat=CAATINGA[1], lon=CAATINGA[0],method=\"nearest\",)\n# Plot Caatinga timeseries\nds1dCA.plot(label= \"CAATINGA\", color = \"orange\",marker=\"o\",ax=axs[1])\naxs[1].set_title(\"CAATINGA\")\n\n\n\n# Create Caatinga timeseries\nds1dE = time_subsetA.sel(lat=ELMSTEIN[1], lon=ELMSTEIN[0],method=\"nearest\",)\n# Plot Caatinga timeseries\nds1dE.plot(label= \"ELMSTEIN\", color = \"purple\",marker=\"o\",ax=axs[2])\naxs[2].set_title(\"ELMSTEIN\")\n\n\n# Create Caatinga timeseries\nds1dM = time_subsetA.sel(lat=MUARA[1], lon=MUARA[0],method=\"nearest\",)\n# Plot Caatinga timeseries\nds1dM.plot(label= \"MUARA\", color = \"pink\", marker=\"o\",ax=axs[3])\naxs[3].set_title(\"MUARA\")\n\n\n# Create Caatinga timeseries\nds1dR = time_subsetA.sel(lat=ROCKIES[1], lon=ROCKIES[0],method=\"nearest\",)\n# Plot Caatinga timeseries\nds1dR.plot(label= \"ROCKIES\", color = \"red\", marker=\"o\",ax=axs[4])\naxs[4].set_title(\"ROCKIES\")\n\n\nfig.tight_layout()\nplt.show()\nplt.close()\n\n","visibility":"show","key":"Ae2GExOQL8"},{"type":"output","id":"tEi_QwRefALXqFI9fOjxl","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c906187e1d530f252ca088d156ceecbe","path":"/eodashboard-notebooks/build/c906187e1d530f252ca088d156ceecbe.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8ef9c61eba61c1f078c4eb7887f17e1b","path":"/eodashboard-notebooks/build/8ef9c61eba61c1f078c4eb7887f17e1b.png"},"text/plain":{"content":"\u003cFigure size 1000x1200 with 5 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"Jn1esCBwtQ"}],"visibility":"show","key":"rT3oNbwGFp"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","identifier":"section9","label":"section9","url":"","children":[],"urlSource":"","key":"sv1Rq2v13s"}],"key":"hXbpbATEx1"},{"type":"span","style":{"color":"DarkCyan"},"children":[{"type":"text","value":"9. Analysis cells","key":"CyQiR5Nj5h"}],"key":"beLd2kObCI"},{"type":"text","value":" ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tyiHqOpgO0"}],"identifier":"id-9-analysis-cells","label":"9. Analysis cells ","html_id":"id-9-analysis-cells","implicit":true,"key":"Zu5cibY75c"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Please comment your code, describe the functions, remove dead and unreachable code.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ihu4QlVbUu"}],"key":"VuMaVstNZj"}],"visibility":"show","key":"nXd8VVk0V5"},{"type":"block","kind":"notebook-code","data":{"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"\ndef generate_gaps(time_values, gap_length, unit=\"days\", n_gaps=2, seed=42, min_spacing=0):\n    \"\"\"\n    Generate gaps in a timeseries without overlaps and with minimum spacing.\n    \n    Parameters:\n    - time_values: list of datetime values\n    - gap_length: length of each gap\n    - unit: \"days\", \"weeks\", \"months\"\n    - n_gaps: number of gaps to generate\n    - seed: random seed\n    - min_spacing: minimum spacing between gaps (in same units as `unit`)\n    \n    Returns:\n    - gaps: list of (start, end) tuples\n    - actual_gap_length: length of each gap in days\n    \"\"\"\n    rng = random.Random(seed)\n    gaps = []\n\n    # Convert time_values to sorted pandas Series\n    time_series = pd.Series(pd.to_datetime(time_values)).sort_values().reset_index(drop=True)\n\n    # Convert min_spacing to DateOffset\n    if unit == \"weeks\":\n        spacing_offset = pd.DateOffset(weeks=min_spacing)\n        gap_offset = pd.DateOffset(weeks=gap_length)\n        actual_gap_length = gap_length * 7\n    elif unit == \"months\":\n        spacing_offset = pd.DateOffset(months=min_spacing)\n        gap_offset = pd.DateOffset(months=gap_length)\n        actual_gap_length = gap_length * 30  # approximate\n    else:  # days\n        spacing_offset = pd.DateOffset(days=min_spacing)\n        gap_offset = pd.DateOffset(days=gap_length)\n        actual_gap_length = gap_length\n\n    attempts = 0\n    max_attempts = n_gaps * 20  # safety to avoid infinite loops\n\n    while len(gaps) \u003c n_gaps and attempts \u003c max_attempts:\n        attempts += 1\n        random_start = rng.choice(time_series)\n        random_end = random_start + gap_offset\n\n        # Check for overlap with existing gaps + min_spacing\n        overlap = False\n        for s, e in gaps:\n            buffer_start = s - spacing_offset\n            buffer_end = e + spacing_offset\n            if (random_start \u003c= buffer_end) and (random_end \u003e= buffer_start):\n                overlap = True\n                break\n\n        if not overlap:\n            gaps.append((random_start, random_end))\n\n    return gaps, actual_gap_length\n\n\ndef subset_data_with_gaps(ds, gaps, data_name=\"DATASET\"):\n    \"\"\"\n    Apply gaps to a dataset and plot.\n\n    Parameters:\n    - ds: xarray dataset with time dimension\n    - gaps: list of (start, end) tuples\n    - data_name: string for labeling\n\n    Returns:\n    - train_set: dataset excluding gap periods\n    - test_set: dataset (gap periods)\n    \"\"\"\n    # Concatenate all gap periods into test_set\n    test_sets = [ds.sel(time=slice(start, end)) for start, end in gaps]\n    if test_sets:\n        test_set = xr.concat(test_sets, dim=\"time\").sortby(\"time\")\n    else:\n        test_set = ds.isel(time=[])\n\n    # Train set is everything else\n    train_set = ds.sel(time=~ds['time'].isin(test_set['time'].values))\n\n    # Compute duration of the first gap in days\n    if gaps:\n        first_gap_length = (gaps[0][1] - gaps[0][0]).days + 1  # +1 to include both start and end\n    else:\n        first_gap_length = 0\n\n    # Plot\n    plt.figure(figsize=(5, 4))\n    train_set.plot.scatter(x='time', y='ndvi', color='tab:blue', label=f'Train - {data_name}')\n    if len(test_set.time) \u003e 0:\n        test_set.plot.scatter(x='time', y='ndvi', color='tab:green', label=f'Test (gap) - {data_name}')\n    plt.legend()\n    plt.ylim(0, 1)\n    plt.title(f\"{data_name} with gap length: {first_gap_length} days\")\n\n    return train_set, test_set\n\n\n# Choose a reference timeline (e.g., Amazon dataset)\nref_time = pd.to_datetime(ds1dA['time'].values)\n\n# Generate shared gaps once\ngaps, days = generate_gaps(ref_time, gap_length=6, unit=\"months\", n_gaps=4, seed=18, min_spacing=2)\n\n# Apply same gaps to all datasets\ntrain_setA, test_setA = subset_data_with_gaps(ds1dA, gaps, \"AMAZON\")\ntrain_setC, test_setC = subset_data_with_gaps(ds1dCA, gaps, \"CAATINGA\")\ntrain_setE, test_setE = subset_data_with_gaps(ds1dE, gaps, \"ELMSTEIN\")\ntrain_setM, test_setM = subset_data_with_gaps(ds1dM, gaps, \"MUARA\")\ntrain_setR, test_setR = subset_data_with_gaps(ds1dR, gaps, \"ROCKIES\")\n","visibility":"show","key":"BWIg5dClpb"},{"type":"output","id":"00bfJLeOszIvEVBn36i_B","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ad8f57ca41d12693bed012438bc2062f","path":"/eodashboard-notebooks/build/ad8f57ca41d12693bed012438bc2062f.png"},"text/plain":{"content":"\u003cFigure size 500x400 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c7b78142634694b151e5b1d22205ba0e","path":"/eodashboard-notebooks/build/c7b78142634694b151e5b1d22205ba0e.png"},"text/plain":{"content":"\u003cFigure size 500x400 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f7a5cb0294fc2f6a4e142a72c2010d57","path":"/eodashboard-notebooks/build/f7a5cb0294fc2f6a4e142a72c2010d57.png"},"text/plain":{"content":"\u003cFigure size 500x400 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c01aaa0c5ee94840c0c6d14681811277","path":"/eodashboard-notebooks/build/c01aaa0c5ee94840c0c6d14681811277.png"},"text/plain":{"content":"\u003cFigure size 500x400 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d59529eff787be10220df84b05058b4d","path":"/eodashboard-notebooks/build/d59529eff787be10220df84b05058b4d.png"},"text/plain":{"content":"\u003cFigure size 500x400 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"rJupkxLGY1"}],"visibility":"show","key":"ZRPDflptcF"},{"type":"block","kind":"notebook-code","data":{"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# We define a function to calculate processing time:\n\ndef exec_time(start, end):\n    \"\"\"\n    This function calculates process execution time\n    -----------------------------------------------\n    \n    input:\n    - start time: start time. call with time.time()\n    - end time: end of processing time. call time.time() again.\n\n    output:\n    - diff_time: time it took to run the process\n    \"\"\"\n    \n    diff_time = end - start\n    m, s = divmod(diff_time, 60)\n    h, m = divmod(m, 60)\n    s,m,h = int(round(s, 0)), int(round(m, 0)), int(round(h, 0))\n    print(\"Execution Time: \", diff_time )#+ \"{0:06d}:{1:06d}:{2:06d}\".format(h, m, s)\n\n    return diff_time\n    \n","visibility":"show","key":"nXVwcbk71z"},{"type":"output","id":"j1-pFtUEZ_6Lw7K935QrI","data":[],"visibility":"show","key":"zuRMylsXK5"}],"visibility":"show","key":"jGKfVgigMs"},{"type":"block","kind":"notebook-code","data":{"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Start time counter\nstart = time.time()\n\ndef interpolation(TYPE, location):\n    start = time.time()\n    \n    \"\"\"\n    A function that interpolates our timeseries data.\n    Input:\n    - TYPE: choose among \"linear\", \n    - location: pick our location\n\n    output:\n    - dfmetrics: a dataframe of accuracy metrics\n    \n    \"\"\"\n    if location == \"Amazon\":\n        train_set = train_setA\n        test_set = test_setA\n        \n    elif location == \"Caatinga\":\n        train_set = train_setC\n        test_set = test_setC\n            \n    elif location == \"Elmstein\":\n        train_set = train_setE\n        test_set = test_setE\n        \n        \n    elif location == \"Muara\":\n        train_set = train_setM\n        test_set = test_setM\n    \n    elif location == \"Rockies\":\n        train_set = train_setR\n        test_set = test_setR\n        \n    # numeric time for interpolation\n    train_time_num = (train_set.time.astype(\"int64\") // 10**6).astype(\"int64\").values\n    test_time_num = (test_set.time.astype(\"int64\") // 10**6).astype(\"int64\").values\n\n    # datetime for plotting\n    train_time_dt = train_set.time.values\n    test_time_dt = test_set.time.values\n    \n\n    # interpolation\n    if TYPE == \"linear\":\n        f = interp1d(train_time_num, train_set.values, kind=TYPE, fill_value=\"extrapolate\")\n        interpolated_values = f(test_time_num)\n        \n        # plot with datetime\n        plt.figure(figsize=(6, 5))\n        plt.scatter(train_time_dt, train_set.values, label=\"train\")\n        plt.scatter(test_time_dt, interpolated_values, label=\"interpolated\")\n        plt.scatter(test_time_dt, test_set.values, label=\"real\")\n\n        plt.title(TYPE +\" interpolation - \" + location )\n        plt.xlabel(\"Time\")\n        plt.ylabel(\"Values\")\n\n        # format x-axis as dates\n        plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(\"%Y-%m-%d\"))\n        plt.gcf().autofmt_xdate()\n\n        plt.legend()\n        #plt.show()\n        \n        R2 = r2_score(test_set.values, interpolated_values)\n        RMSE = root_mean_squared_error(test_set.values, interpolated_values)\n        MAPE = mean_absolute_percentage_error(test_set.values, interpolated_values)\n\n        end = time.time()\n        T =exec_time(start,end)\n\n        dfmetrics = {\"R2\": R2, \"RMSE\":RMSE, \"MAPE\":MAPE, \"days\":days, \"kind\":TYPE, \"time\": T, \"location\": location}\n        \n        #plt.savefig(\"Linear_\"+str(days)+\"_\"+location+\".png\", dpi=400)\n        \n    #Cubic Spline interpolation  \n    if TYPE == \"CubicSpline\":\n        f = CubicSpline((train_set.time.astype(\"int64\")//10**6).astype(\"int64\").values, train_set.values)  # 'linear' interpolation\n        interpolated_values = f(test_time_num)\n        \n        # plot with datetime\n        plt.figure(figsize=(6, 5))\n        plt.scatter(train_time_dt, train_set.values, label=\"train\")\n        plt.scatter(test_time_dt, interpolated_values, label=\"interpolated\")\n        plt.scatter(test_time_dt, test_set.values, label=\"real\")\n\n        plt.title(TYPE +\" interpolation - \" + location )\n        plt.xlabel(\"Time\")\n        plt.ylabel(\"Values\")\n\n        # format x-axis as dates\n        plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(\"%Y-%m-%d\"))\n        plt.gcf().autofmt_xdate()\n\n        plt.legend()\n        #plt.show()\n        \n        R2 = r2_score(test_set.values, interpolated_values)\n        RMSE = root_mean_squared_error(test_set.values, interpolated_values)\n        MAPE = mean_absolute_percentage_error(test_set.values, interpolated_values)\n\n        end = time.time()\n        T =exec_time(start,end)\n\n        dfmetrics = {\"R2\": R2, \"RMSE\":RMSE, \"MAPE\":MAPE, \"days\":days, \"kind\":TYPE, \"time\": T, \"location\": location}\n        \n        #plt.savefig(\"Cubic_\"+str(days)+\"_\"+location+\".png\", dpi=400)\n        \n    \n    #Gaussian Process Regression interpolation\n    if TYPE == \"GPR\":\n        start = time.time()\n\n        # --- Convert train time to numeric days ---\n        X_raw = train_set.time.values.astype(\"int64\") // 10**9\n        X_days = (X_raw - X_raw.min()) / (60*60*24)\n\n        y = train_set.values\n        if hasattr(y, \"to_numpy\"):\n            y = y.to_numpy()\n\n        # Mask observed values\n        observed_mask = ~np.isnan(y)\n        X_train = X_days[observed_mask].reshape(-1, 1)\n        y_train = y[observed_mask]\n\n        # --- Full timeline for prediction ---\n        train_time_series = pd.Series(train_set.time.values)\n        test_time_series = pd.Series(test_set.time.values)\n        full_time = pd.concat([train_time_series, test_time_series]).sort_values().reset_index(drop=True)\n\n        #convert date to a better format for GPR\n        X_full = (full_time.values.astype(\"int64\") // 10**9 - X_raw.min()) / (60*60*24)\n        X_full = X_full.reshape(-1, 1)\n\n        # --- Fit Gaussian Process ---\n        # Pick our kernels: \n        #  RBF to account for smoothness,\n        #  ExpSineSquared to account for seasonality\n        #  WhiteKernel to accoutn for noise  \n        kernel = RBF(length_scale=50.0) + ExpSineSquared(length_scale=50.0, periodicity=365.0) + WhiteKernel(noise_level=0.01)\n        gp = GaussianProcessRegressor(kernel=kernel, n_restarts_optimizer=9, normalize_y=True)\n        gp.fit(X_train, y_train)\n\n        # --- Predict over full timeline ---\n        y_pred, y_std = gp.predict(X_full, return_std=True)\n\n        # --- Plot scatter like other methods ---\n        plt.figure(figsize=(6,5))\n        plt.scatter(train_set.time, train_set.values, label=\"train\", color=\"tab:blue\", s=20)\n        plt.scatter(full_time, y_pred, label=\"interpolated (GPR)\", color=\"tab:orange\", s=20)\n        plt.scatter(test_set.time, test_set.values, label=\"real\", color=\"green\", s=20)\n\n        # Confidence interval\n        plt.fill_between(full_time,\n                         y_pred - 2*y_std,\n                         y_pred + 2*y_std,\n                         color=\"tab:orange\", alpha=0.2, label=\"±2σ\") #95% CI\n\n        plt.title(f\"GPR interpolation - {location}\")\n        plt.xlabel(\"Time\")\n        plt.ylabel(\"Values\")\n        plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(\"%Y-%m-%d\"))\n        plt.gcf().autofmt_xdate()\n        plt.legend()\n        #plt.show()\n\n        # --- Metrics on test set only ---\n        X_test = (test_set.time.values.astype(\"int64\") // 10**9 - X_raw.min()) / (60*60*24)\n        X_test = X_test.reshape(-1, 1)\n        y_test = test_set.values\n        if hasattr(y_test, \"to_numpy\"):\n            y_test = y_test.to_numpy()\n        y_test_pred, _ = gp.predict(X_test, return_std=True)\n\n        R2 = r2_score(y_test, y_test_pred)\n        RMSE = root_mean_squared_error(y_test, y_test_pred)\n        MAPE = mean_absolute_percentage_error(y_test, y_test_pred)\n\n        end = time.time()\n        T = exec_time(start, end)\n\n        dfmetrics = {\"R2\": R2, \"RMSE\": RMSE, \"MAPE\": MAPE, \"days\": days, \"kind\": TYPE, \"time\": T, \"location\": location}\n\n        #plt.savefig(\"GPR_\"+str(days)+\"_\"+location+\".png\", dpi=400)\n        \n    # --- Seasonal interpolation (with past and future window) ---\n    elif TYPE == \"Seasonal\":\n        \n        window_days=7\n        train_df = pd.DataFrame({\"time\": train_time_dt, \"value\": train_set.values})\n        train_df[\"doy\"] = train_df[\"time\"].dt.dayofyear\n        test_time_dt1 = pd.to_datetime(test_time_dt)\n        interpolated_values = []\n\n        for t in test_time_dt1:\n            doy_t = t.timetuple().tm_yday\n            \n            # Windowed selection\n            window_vals = train_df[(train_df[\"doy\"] \u003e= doy_t - window_days) \u0026 (train_df[\"doy\"] \u003c= doy_t + window_days)][\"value\"]\n            \n            if len(window_vals) \u003e 0:\n                interpolated_values.append(window_vals.mean())\n            else:\n                diffs = np.abs(train_df[\"doy\"] - doy_t)\n                idx_min = diffs.idxmin()\n                interpolated_values.append(train_df.loc[idx_min, \"value\"])\n\n        interpolated_values = np.array(interpolated_values)\n\n        plt.figure(figsize=(6, 5))\n        plt.scatter(train_time_dt, train_set.values, label=\"train\")\n        plt.scatter(test_time_dt, interpolated_values, label=\"interpolated (seasonal)\", color=\"tab:orange\")\n        plt.scatter(test_time_dt, test_set.values, label=\"real\", color=\"green\")\n        plt.title(\"Seasonal interpolation - \" + location)\n        plt.xlabel(\"Time\")\n        plt.ylabel(\"Values\")\n        plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(\"%Y-%m-%d\"))\n        plt.gcf().autofmt_xdate()\n        plt.legend()\n        #plt.show()\n\n        R2 = r2_score(test_set.values, interpolated_values)\n        RMSE = root_mean_squared_error(test_set.values, interpolated_values)\n        MAPE = mean_absolute_percentage_error(test_set.values, interpolated_values)\n        end = time.time()\n        T = exec_time(start, end)\n\n        dfmetrics = {\"R2\": R2, \"RMSE\": RMSE, \"MAPE\": MAPE, \"days\":days, \"kind\":TYPE, \"time\": T, \"location\": location}\n        #plt.savefig(\"Seasonal_\"+str(days)+\"_\"+location+\".png\", dpi=400)\n        \n\n    return dfmetrics\n","visibility":"show","key":"c5PwWLimyc"},{"type":"output","id":"LaqpiVn_EF38woq1x2Aj1","data":[],"visibility":"show","key":"U9EjrX5Miz"}],"visibility":"show","key":"xJxSP2RL2M"},{"type":"block","kind":"notebook-code","data":{"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#LINEAR INTERPOLATION\nLC = interpolation(\"linear\", \"Caatinga\")\nLA = interpolation(\"linear\", \"Amazon\")\nLE =interpolation(\"linear\", \"Elmstein\")\nLM = interpolation(\"linear\", \"Muara\")\nLR = interpolation(\"linear\", \"Rockies\")\n","visibility":"show","key":"MQysFRRw1x"},{"type":"output","id":"SujtCTaRchiMjjZJlTYfb","data":[{"name":"stdout","output_type":"stream","text":"Execution Time:  0.35504698753356934\nExecution Time:  0.6290695667266846\nExecution Time:  0.37151408195495605\nExecution Time:  0.4424552917480469\nExecution Time:  0.5377426147460938\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"145ea3982d47f221beafd334b3e2735f","path":"/eodashboard-notebooks/build/145ea3982d47f221beafd334b3e2735f.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"307c3ee1a828fad231c9b02eaae5a0cf","path":"/eodashboard-notebooks/build/307c3ee1a828fad231c9b02eaae5a0cf.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"98ddc156756c3dd609fd6bddd03e74a7","path":"/eodashboard-notebooks/build/98ddc156756c3dd609fd6bddd03e74a7.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"867ab41b8d0daaaa0e745e451df302f0","path":"/eodashboard-notebooks/build/867ab41b8d0daaaa0e745e451df302f0.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a0b93b5bfbff365ba8bd9ef678ef52fe","path":"/eodashboard-notebooks/build/a0b93b5bfbff365ba8bd9ef678ef52fe.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"p0mXUWobuW"}],"visibility":"show","key":"Nge9gvRCzv"},{"type":"block","kind":"notebook-code","data":{"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#CUBIC SPLINE INTERPOLATION\nCC = interpolation(\"CubicSpline\", \"Caatinga\")\nCA =interpolation(\"CubicSpline\", \"Amazon\")\nCE =interpolation(\"CubicSpline\", \"Elmstein\")\nCM =interpolation(\"CubicSpline\", \"Muara\")\nCR =interpolation(\"CubicSpline\", \"Rockies\")\n","visibility":"show","key":"CzQqUHKKDm"},{"type":"output","id":"QiO7-qOtNpR8q3R-jQW48","data":[{"name":"stdout","output_type":"stream","text":"Execution Time:  0.38396620750427246\nExecution Time:  0.6379997730255127\nExecution Time:  0.3731379508972168\nExecution Time:  0.44517946243286133\nExecution Time:  0.5438599586486816\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4fdfc0a515e852de52501e5d46a7424f","path":"/eodashboard-notebooks/build/4fdfc0a515e852de52501e5d46a7424f.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c4c2e6ab0106c60d89ed02b98814e8bf","path":"/eodashboard-notebooks/build/c4c2e6ab0106c60d89ed02b98814e8bf.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"91bf5eff10762ebc2746219f3bb420ad","path":"/eodashboard-notebooks/build/91bf5eff10762ebc2746219f3bb420ad.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b373c64e1a801e17566fe4c11173e07d","path":"/eodashboard-notebooks/build/b373c64e1a801e17566fe4c11173e07d.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6ad079476bce156af8b46763369200f4","path":"/eodashboard-notebooks/build/6ad079476bce156af8b46763369200f4.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"IKNWDMpBaX"}],"visibility":"show","key":"FaqU0BSDbI"},{"type":"block","kind":"notebook-code","data":{"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"GC = interpolation(\"GPR\", \"Caatinga\")\nGA = interpolation(\"GPR\", \"Amazon\")\nGE = interpolation(\"GPR\", \"Elmstein\")\nGM = interpolation(\"GPR\", \"Muara\")\nGR = interpolation(\"GPR\", \"Rockies\")\n","visibility":"show","key":"R28P5ZeCqj"},{"type":"output","id":"2enOYuuq9W-o2zp0fYKdH","data":[{"name":"stdout","output_type":"stream","text":"Execution Time:  0.8819622993469238\n"},{"name":"stderr","output_type":"stream","text":"/home/conda/users/fbfe84b6-1757499783-109-science-hub-course-updated/lib/python3.13/site-packages/sklearn/gaussian_process/kernels.py:440: ConvergenceWarning: The optimal value found for dimension 0 of parameter k2__noise_level is close to the specified lower bound 1e-05. Decreasing the bound and calling fit again may find a better value.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"Execution Time:  1.1756927967071533\n"},{"name":"stderr","output_type":"stream","text":"/home/conda/users/fbfe84b6-1757499783-109-science-hub-course-updated/lib/python3.13/site-packages/sklearn/gaussian_process/_gpr.py:663: ConvergenceWarning: lbfgs failed to converge after 1 iteration(s) (status=2):\nABNORMAL: \n\nYou might also want to scale the data as shown in:\n    https://scikit-learn.org/stable/modules/preprocessing.html\n  _check_optimize_result(\"lbfgs\", opt_res)\n"},{"name":"stdout","output_type":"stream","text":"Execution Time:  1.2742934226989746\n"},{"name":"stderr","output_type":"stream","text":"/home/conda/users/fbfe84b6-1757499783-109-science-hub-course-updated/lib/python3.13/site-packages/sklearn/gaussian_process/_gpr.py:663: ConvergenceWarning: lbfgs failed to converge after 2 iteration(s) (status=2):\nABNORMAL: \n\nYou might also want to scale the data as shown in:\n    https://scikit-learn.org/stable/modules/preprocessing.html\n  _check_optimize_result(\"lbfgs\", opt_res)\n/home/conda/users/fbfe84b6-1757499783-109-science-hub-course-updated/lib/python3.13/site-packages/sklearn/gaussian_process/kernels.py:450: ConvergenceWarning: The optimal value found for dimension 0 of parameter k1__k2__periodicity is close to the specified upper bound 100000.0. Increasing the bound and calling fit again may find a better value.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"Execution Time:  1.1290569305419922\nExecution Time:  1.4447743892669678\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8815af2a9db2fad877165534ac052afb","path":"/eodashboard-notebooks/build/8815af2a9db2fad877165534ac052afb.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"56fc5457197185af58c2b01384096eda","path":"/eodashboard-notebooks/build/56fc5457197185af58c2b01384096eda.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ff19492a5537527e87182a3df90f399a","path":"/eodashboard-notebooks/build/ff19492a5537527e87182a3df90f399a.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f9c2e2bb08f7c18165883fcebe6d07df","path":"/eodashboard-notebooks/build/f9c2e2bb08f7c18165883fcebe6d07df.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a9a3e94278cd00c2e8fa4af82e5a5898","path":"/eodashboard-notebooks/build/a9a3e94278cd00c2e8fa4af82e5a5898.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"x0GC8FAdFW"}],"visibility":"show","key":"k3XzMLLx46"},{"type":"block","kind":"notebook-code","data":{"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"SC = interpolation(\"Seasonal\", \"Caatinga\")\nSA = interpolation(\"Seasonal\", \"Amazon\")\nSE = interpolation(\"Seasonal\", \"Elmstein\")\nSM =interpolation(\"Seasonal\", \"Muara\")\nSR =interpolation(\"Seasonal\", \"Rockies\")\n","visibility":"show","key":"bGIw6MaXO6"},{"type":"output","id":"YfVfT9y7ack_fo62BLIXp","data":[{"name":"stdout","output_type":"stream","text":"Execution Time:  0.3807833194732666\nExecution Time:  0.6626808643341064\nExecution Time:  0.3941342830657959\nExecution Time:  0.4735894203186035\nExecution Time:  0.5647144317626953\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9cd3d01d521375ca700c46a29abc2e60","path":"/eodashboard-notebooks/build/9cd3d01d521375ca700c46a29abc2e60.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b032a63ed4fad485b5f2e5dc9b32ebb9","path":"/eodashboard-notebooks/build/b032a63ed4fad485b5f2e5dc9b32ebb9.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2dd1c8c694c7e594996e92f57e4e671e","path":"/eodashboard-notebooks/build/2dd1c8c694c7e594996e92f57e4e671e.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b06c3f702c32d98dddee201688716b68","path":"/eodashboard-notebooks/build/b06c3f702c32d98dddee201688716b68.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f77f6cda3f947fa893e2db9a1f9881a6","path":"/eodashboard-notebooks/build/f77f6cda3f947fa893e2db9a1f9881a6.png"},"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"T7zCyKSpef"}],"visibility":"show","key":"Z9qXpD7dMt"},{"type":"block","kind":"notebook-code","data":{"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# collate all metrics ! \nmetrics = [LA, LC, LE, LM, LR, \n           CA, CC, CE, CM, CR,\n            SC, SA, SE, SM ,SR,\n           GA, GC, GE, GM, GR]\n\n\nDFmetrics = pd.DataFrame(metrics)\n\n#divide time by 10 to make it fit into plot\nDFmetrics.time=DFmetrics.time/10\nDFmetrics","visibility":"show","key":"PjTIXTHMpz"},{"type":"output","id":"qUF5M9NAgkX_Qvk33f_Q8","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eR2\u003c/th\u003e\n      \u003cth\u003eRMSE\u003c/th\u003e\n      \u003cth\u003eMAPE\u003c/th\u003e\n      \u003cth\u003edays\u003c/th\u003e\n      \u003cth\u003ekind\u003c/th\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003elocation\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e-2.071670\u003c/td\u003e\n      \u003ctd\u003e0.022765\u003c/td\u003e\n      \u003ctd\u003e0.017272\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003elinear\u003c/td\u003e\n      \u003ctd\u003e0.062907\u003c/td\u003e\n      \u003ctd\u003eAmazon\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e-0.783645\u003c/td\u003e\n      \u003ctd\u003e0.154162\u003c/td\u003e\n      \u003ctd\u003e0.344884\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003elinear\u003c/td\u003e\n      \u003ctd\u003e0.035505\u003c/td\u003e\n      \u003ctd\u003eCaatinga\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e0.064498\u003c/td\u003e\n      \u003ctd\u003e0.125736\u003c/td\u003e\n      \u003ctd\u003e0.165355\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003elinear\u003c/td\u003e\n      \u003ctd\u003e0.037151\u003c/td\u003e\n      \u003ctd\u003eElmstein\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e-0.160626\u003c/td\u003e\n      \u003ctd\u003e0.019588\u003c/td\u003e\n      \u003ctd\u003e0.017285\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003elinear\u003c/td\u003e\n      \u003ctd\u003e0.044246\u003c/td\u003e\n      \u003ctd\u003eMuara\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e0.556621\u003c/td\u003e\n      \u003ctd\u003e0.193512\u003c/td\u003e\n      \u003ctd\u003e0.710559\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003elinear\u003c/td\u003e\n      \u003ctd\u003e0.053774\u003c/td\u003e\n      \u003ctd\u003eRockies\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e5\u003c/th\u003e\n      \u003ctd\u003e-1.203839\u003c/td\u003e\n      \u003ctd\u003e0.019283\u003c/td\u003e\n      \u003ctd\u003e0.015733\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eCubicSpline\u003c/td\u003e\n      \u003ctd\u003e0.063800\u003c/td\u003e\n      \u003ctd\u003eAmazon\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e6\u003c/th\u003e\n      \u003ctd\u003e-4.664079\u003c/td\u003e\n      \u003ctd\u003e0.274719\u003c/td\u003e\n      \u003ctd\u003e0.410980\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eCubicSpline\u003c/td\u003e\n      \u003ctd\u003e0.038397\u003c/td\u003e\n      \u003ctd\u003eCaatinga\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e7\u003c/th\u003e\n      \u003ctd\u003e-8.888681\u003c/td\u003e\n      \u003ctd\u003e0.408797\u003c/td\u003e\n      \u003ctd\u003e0.358573\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eCubicSpline\u003c/td\u003e\n      \u003ctd\u003e0.037314\u003c/td\u003e\n      \u003ctd\u003eElmstein\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e8\u003c/th\u003e\n      \u003ctd\u003e-20.002818\u003c/td\u003e\n      \u003ctd\u003e0.083325\u003c/td\u003e\n      \u003ctd\u003e0.058022\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eCubicSpline\u003c/td\u003e\n      \u003ctd\u003e0.044518\u003c/td\u003e\n      \u003ctd\u003eMuara\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e9\u003c/th\u003e\n      \u003ctd\u003e0.283473\u003c/td\u003e\n      \u003ctd\u003e0.246001\u003c/td\u003e\n      \u003ctd\u003e0.853321\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eCubicSpline\u003c/td\u003e\n      \u003ctd\u003e0.054386\u003c/td\u003e\n      \u003ctd\u003eRockies\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e10\u003c/th\u003e\n      \u003ctd\u003e0.462521\u003c/td\u003e\n      \u003ctd\u003e0.084626\u003c/td\u003e\n      \u003ctd\u003e0.166001\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eSeasonal\u003c/td\u003e\n      \u003ctd\u003e0.038078\u003c/td\u003e\n      \u003ctd\u003eCaatinga\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11\u003c/th\u003e\n      \u003ctd\u003e-0.698638\u003c/td\u003e\n      \u003ctd\u003e0.016929\u003c/td\u003e\n      \u003ctd\u003e0.013000\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eSeasonal\u003c/td\u003e\n      \u003ctd\u003e0.066268\u003c/td\u003e\n      \u003ctd\u003eAmazon\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e12\u003c/th\u003e\n      \u003ctd\u003e0.650421\u003c/td\u003e\n      \u003ctd\u003e0.076862\u003c/td\u003e\n      \u003ctd\u003e0.099251\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eSeasonal\u003c/td\u003e\n      \u003ctd\u003e0.039413\u003c/td\u003e\n      \u003ctd\u003eElmstein\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e13\u003c/th\u003e\n      \u003ctd\u003e0.055022\u003c/td\u003e\n      \u003ctd\u003e0.017675\u003c/td\u003e\n      \u003ctd\u003e0.015228\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eSeasonal\u003c/td\u003e\n      \u003ctd\u003e0.047359\u003c/td\u003e\n      \u003ctd\u003eMuara\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e14\u003c/th\u003e\n      \u003ctd\u003e0.751644\u003c/td\u003e\n      \u003ctd\u003e0.144830\u003c/td\u003e\n      \u003ctd\u003e0.297944\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eSeasonal\u003c/td\u003e\n      \u003ctd\u003e0.056471\u003c/td\u003e\n      \u003ctd\u003eRockies\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e15\u003c/th\u003e\n      \u003ctd\u003e-0.131028\u003c/td\u003e\n      \u003ctd\u003e0.013814\u003c/td\u003e\n      \u003ctd\u003e0.011259\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eGPR\u003c/td\u003e\n      \u003ctd\u003e0.117569\u003c/td\u003e\n      \u003ctd\u003eAmazon\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e16\u003c/th\u003e\n      \u003ctd\u003e0.671794\u003c/td\u003e\n      \u003ctd\u003e0.066130\u003c/td\u003e\n      \u003ctd\u003e0.103889\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eGPR\u003c/td\u003e\n      \u003ctd\u003e0.088196\u003c/td\u003e\n      \u003ctd\u003eCaatinga\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e17\u003c/th\u003e\n      \u003ctd\u003e0.316192\u003c/td\u003e\n      \u003ctd\u003e0.107499\u003c/td\u003e\n      \u003ctd\u003e0.141263\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eGPR\u003c/td\u003e\n      \u003ctd\u003e0.127429\u003c/td\u003e\n      \u003ctd\u003eElmstein\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e18\u003c/th\u003e\n      \u003ctd\u003e-0.087993\u003c/td\u003e\n      \u003ctd\u003e0.018965\u003c/td\u003e\n      \u003ctd\u003e0.015341\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eGPR\u003c/td\u003e\n      \u003ctd\u003e0.112906\u003c/td\u003e\n      \u003ctd\u003eMuara\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e19\u003c/th\u003e\n      \u003ctd\u003e0.783029\u003c/td\u003e\n      \u003ctd\u003e0.135370\u003c/td\u003e\n      \u003ctd\u003e0.390458\u003c/td\u003e\n      \u003ctd\u003e180\u003c/td\u003e\n      \u003ctd\u003eGPR\u003c/td\u003e\n      \u003ctd\u003e0.144477\u003c/td\u003e\n      \u003ctd\u003eRockies\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"           R2      RMSE      MAPE  days         kind      time  location\n0   -2.071670  0.022765  0.017272   180       linear  0.062907    Amazon\n1   -0.783645  0.154162  0.344884   180       linear  0.035505  Caatinga\n2    0.064498  0.125736  0.165355   180       linear  0.037151  Elmstein\n3   -0.160626  0.019588  0.017285   180       linear  0.044246     Muara\n4    0.556621  0.193512  0.710559   180       linear  0.053774   Rockies\n5   -1.203839  0.019283  0.015733   180  CubicSpline  0.063800    Amazon\n6   -4.664079  0.274719  0.410980   180  CubicSpline  0.038397  Caatinga\n7   -8.888681  0.408797  0.358573   180  CubicSpline  0.037314  Elmstein\n8  -20.002818  0.083325  0.058022   180  CubicSpline  0.044518     Muara\n9    0.283473  0.246001  0.853321   180  CubicSpline  0.054386   Rockies\n10   0.462521  0.084626  0.166001   180     Seasonal  0.038078  Caatinga\n11  -0.698638  0.016929  0.013000   180     Seasonal  0.066268    Amazon\n12   0.650421  0.076862  0.099251   180     Seasonal  0.039413  Elmstein\n13   0.055022  0.017675  0.015228   180     Seasonal  0.047359     Muara\n14   0.751644  0.144830  0.297944   180     Seasonal  0.056471   Rockies\n15  -0.131028  0.013814  0.011259   180          GPR  0.117569    Amazon\n16   0.671794  0.066130  0.103889   180          GPR  0.088196  Caatinga\n17   0.316192  0.107499  0.141263   180          GPR  0.127429  Elmstein\n18  -0.087993  0.018965  0.015341   180          GPR  0.112906     Muara\n19   0.783029  0.135370  0.390458   180          GPR  0.144477   Rockies","content_type":"text/plain"}}}],"visibility":"show","key":"VaNHaIozdm"}],"visibility":"show","key":"nIv6jz6AVr"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"df = DFmetrics\nmetrics = [\"R2\",\"RMSE\", \"time\"]\nlocations = df[\"location\"].unique()\n\nfig, axes = plt.subplots(1, len(locations), figsize=(5*len(locations), 5), sharey=False)\n\nfor i, loc in enumerate(locations):\n    sub = df[df[\"location\"] == loc]\n    \n    # x positions = kinds\n    kinds = sub[\"kind\"].unique()\n    x = np.arange(len(kinds))\n    width = 0.25  # width of each bar\n    \n    for j, metric in enumerate(metrics):\n        axes[i].bar(x + j*width, sub[metric], width, label=metric)\n    \n    axes[i].set_title(loc)\n    axes[i].set_ylim(0,1.2)\n    axes[i].set_xticks(x + width)\n    axes[i].set_xticklabels(kinds, rotation=30)\n    axes[i].set_ylabel(\"Value\")\n    axes[i].grid(axis=\"y\", linestyle=\"--\", alpha=0.7)\n\n\n# put one legend for all\nhandles, labels = axes[0].get_legend_handles_labels()\nfig.legend(handles, labels, loc=\"upper center\", ncol=len(metrics))\n\nplt.tight_layout(rect=[0, 0, 1, 0.95])\n\n#plt.savefig(\"Summary_\"+str(days)+\"days.png\", dpi=300)","visibility":"show","key":"Pz70ilGoY4"},{"type":"output","id":"2iQrVyzLJ6Wv_N6mEh-Eu","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c81a410dc8bf8b81e6e7e43668fa588e","path":"/eodashboard-notebooks/build/c81a410dc8bf8b81e6e7e43668fa588e.png"},"text/plain":{"content":"\u003cFigure size 2500x500 with 5 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"EINEeYjs52"}],"visibility":"show","key":"XU9AQyQDjk"}],"key":"KRwRHi8cFi"},"references":{"cite":{"order":["de_Oliveira_2023"],"data":{"de_Oliveira_2023":{"label":"de_Oliveira_2023","enumerator":"1","doi":"10.3390/f14040828","html":"de Oliveira, M. L., dos Santos, C. A. C., Santos, F. A. C., de Oliveira, G., Santos, C. A. G., Bezerra, U. A., de B. L. Cunha, J. E., \u0026 da Silva, R. M. (2023). Evaluation of Water and Carbon Estimation Models in the Caatinga Biome Based on Remote Sensing. \u003ci\u003eForests\u003c/i\u003e, \u003ci\u003e14\u003c/i\u003e(4), 828. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.3390/f14040828\"\u003e10.3390/f14040828\u003c/a\u003e","url":"https://doi.org/10.3390/f14040828"}}}},"footer":{"navigation":{"prev":{"title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","url":"/notebooks/inland-water-with-edc","group":"Notebooks"},"next":{"title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","url":"/notebooks/openchallengenotebook-c1-jessel-hezzi-roussel","group":"Notebooks"}}},"domain":"http://localhost:3000"},"project":{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-4cd88007f691f5591a10238dd3808047.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"Earth System Science Hub Challenge 3: Time series interpolation techniques for remote sensing - Fran, Denise, Mae","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-9297cdd4fad11689d55cbd74099d432b.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/eodashboard-notebooks/build/manifest-ED236704.js";
import * as route0 from "/eodashboard-notebooks/build/root-ZJOPFBMV.js";
import * as route1 from "/eodashboard-notebooks/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/eodashboard-notebooks/build/entry.client-UNPC4GT3.js");</script></body></html>