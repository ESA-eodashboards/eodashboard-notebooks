<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI - EO Dashboard Notebooks</title><meta property="og:title" content="URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI - EO Dashboard Notebooks"/><meta name="generator" content="mystmd"/><meta name="description" content="Collection of examples relevant to the EO Dashboard project"/><meta property="og:description" content="Collection of examples relevant to the EO Dashboard project"/><meta name="keywords" content=""/><meta name="image" content="/eodashboard-notebooks/build/header-be0a09fdf5a46e3efaa55b331b0060c1.png"/><meta property="og:image" content="/eodashboard-notebooks/build/header-be0a09fdf5a46e3efaa55b331b0060c1.png"/><link rel="stylesheet" href="/eodashboard-notebooks/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/eodashboard-notebooks/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/eodashboard-notebooks/favicon.ico"/><link rel="stylesheet" href="/eodashboard-notebooks/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block lg:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/eodashboard-notebooks/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] lg:hidden hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">Notebook examples</div><div class="flex-grow"></div><a href="https://github.com/ESA-eodashboards/eodashboard-notebooks" title="GitHub Repository: ESA-eodashboards/eodashboard-notebooks" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/ESA-eodashboards/eodashboard-notebooks/blob/main/external_notebooks/group1/2025-BiDS-EODashboard/notebook/Urban_Health_and_Megacities.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="NGdgtp9WvJ" class="relative group/block"><img id="Sa3zDrP0yj" style="margin:0 auto" src="/eodashboard-notebooks/build/header-be0a09fdf5a46e3efaa55b331b0060c1.png" alt="Title" data-canonical-url="Intro/img/header.png" class=""/></div><div id="coj8jYYkb7" class="relative group/block"><h4 id="running-environment" class="relative group"><span class="heading-text">Running environment:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#running-environment" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li>This notebook can be run by installing the provided Anaconda Python environment (<strong>notebook-env.yml</strong>).</li></ul></div><div id="qYOQ8XYYzK" class="relative group/block"><h2 id="use-case-1-nighttime-lights" class="relative group"><span class="heading-text">USE CASE 1: Nighttime Lights</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-case-1-nighttime-lights" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="creating-nighttime-light-maps-with-color-blending" class="relative group"><span class="heading-text">Creating nighttime light maps with color blending</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#creating-nighttime-light-maps-with-color-blending" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="EZuSeJWSdt" class="relative group/block"><p>This use case demonstrates how to create <strong>nighttime light variation maps</strong> over a time interval (from 2019 to 2022) with additive color blending for studying the distribution of artificial lighting in urban and rural regions, offering insights into urbanization, infrastructure development, and socio-economic activity.
The Nighttime Light Levels indicator can be explored on the EO Dashboard by selecting the EXPLORE DATASETS mode and choosing <a target="_blank" rel="noreferrer" href="https://eodashboard.org/explore?indicator=NTLU&amp;x=12142837.23019&amp;y=4137471.98879&amp;z=5.69238" class="">Night lights indicators</a>.</p><p>The study has been carried out by Associate Professor <em>TOJO Bumpei</em> of the Institute of Global Studies (specializing in Geographic Information Systems) in collaboration with <em>JAXA</em>.</p></div><div id="jAneWEfOPt" class="relative group/block"><img id="iz41S9sftN" style="margin:0 auto" src="/eodashboard-notebooks/build/night_india-60cb31650b891d290e3c30b5aa95fb2f.JPG" alt="title" data-canonical-url="Nightlights/img/night_india.JPG" class=""/><p>Example of a nighttime light map covering India during 2019-2022, representing areas where a decrease in nighttime light level occurred (indicating a presumed reduction in social activity) in red, and areas where an increase occurred (indicating a presumed increase in social activity) in blue.</p></div><div id="F89xrcCT2a" class="relative group/block"><h4 id="id-1-1-input-data" class="relative group"><span class="heading-text">1.1 Input data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-1-input-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li>Visible Infrared Imaging Radiometer Suite (VIIRS, onboard NASA Suomi NPP satellite).</li><li>Aggregation: data aggregated on a semi-annual basis (using median image generation) with 10-degree lat/lon (geographic) grid h-v tile as Geo Tiff files.</li><li>The tiles are 2400 x 2400 pixels, with pixel size of 0.004166 degrees (~464 m at the equator).</li><li>Spatial Resolution: (0.4 - 0.8) km.</li><li>Metric: nighttime radiance (measured in watts per square centimeter per steradian, [W/cm²/sr]), which represents the brightness of artificial lighting.</li><li>Data access: aggregated input data provided by Jaxa and available locally</li></ul></div><div id="IrQ4jSx6s1" class="relative group/block"><p><strong>VIIRS 10-degree tile scheme</strong></p><img id="iF808gLkoK" style="margin:0 auto" src="/eodashboard-notebooks/build/VIIRS_tiling_scheme-b3c0231f0aeb82a42a1067bd4be546c0.jpg" alt="VIIRS tiling scheme.JPG" data-canonical-url="Nightlights/img/VIIRS_tiling_scheme.jpg" class=""/></div><div id="qBt6omeYqf" class="relative group/block"><h4 id="id-1-2-importing-python-libraries" class="relative group"><span class="heading-text">1.2 Importing Python libraries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-2-importing-python-libraries" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="OJvXTmWoWn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Import libraries
import os
import sys
import re
import numpy as np
import rasterio
import rioxarray as rxr
import subprocess
from subprocess import Popen, PIPE
import tempfile
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
from PIL import Image
import json
from ipyleaflet import Map, ImageOverlay, basemaps</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OgHLIqXP7KWGYYkAkHMHp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="lilM9PIHIm" class="relative group/block"><h4 id="id-1-3-defining-working-folders" class="relative group"><span class="heading-text">1.3 Defining working folders</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-3-defining-working-folders" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="UGt1qpDOAH" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">input_dir = &quot;input&quot;
input_path = os.path.join(os.getcwd(), &quot;Nightlights&quot;, input_dir)

output_urban = &quot;output&quot;
urban_path = os.path.join(os.getcwd(), &quot;Nightlights&quot;, output_urban)

# Create output dir
os.makedirs(urban_path, exist_ok=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Lw8ImxKD7pE6XGYs0GGB4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OOEbekzAcX" class="relative group/block"><h4 id="id-1-4-visualizing-input-data" class="relative group"><span class="heading-text">1.4 Visualizing input data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-4-visualizing-input-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="B4yVfcYjbk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">pattern = re.compile(r&quot;h(\d+)v(\d+)_(\d{4})_(\d)H_median\.tif&quot;)

for root, _, files in os.walk(input_path):
    grouped_files = {}
    
    # Grouping files by h and v
    for file in files:
        match = pattern.match(file)
        if match:
            h, v, year, H = match.groups()
            key = (h, v)
            if key not in grouped_files:
                grouped_files[key] = []
            grouped_files[key].append((year, H, os.path.join(root, file))) 
    
    # Process files for plotting
    for (h, v), file_group in grouped_files.items():
        file_group

tuplelist2dict = {c:{&#x27;year&#x27;:a,&#x27;half&#x27;:b} for a,b,c in file_group}
sorted_dict = {}

grid_tile = None
for item in sorted(tuplelist2dict, key = lambda k: (tuplelist2dict[k][&#x27;year&#x27;], tuplelist2dict[k][&#x27;half&#x27;])):
    sorted_dict.update({item:tuplelist2dict[item]})
    grid_tile = item.split(&#x27;/&#x27;)[-1].split(&#x27;_&#x27;)[0]
#print(sorted_dict)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="K23XP-sF9jHvCJ-_bcabj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="cGsRLr51c5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def plot_figures(figures, nrows = 1, ncols=1, factor = 1., clip_range = None, **kwargs):
    fig, axeslist = plt.subplots(ncols=ncols, nrows=nrows, figsize=(15, 15))
    for idx,file_name in enumerate(figures):
        title = file_name.split(&#x27;/&#x27;)[-1]
        title = title.replace(&quot;_median.tif&quot;, &quot;&quot;)
        axeslist.ravel()[idx].imshow(np.clip(mpimg.imread(file_name)*factor, *clip_range), **kwargs) # cmap=plt.gray(), cmap=&#x27;Greys&#x27;
        axeslist.ravel()[idx].set_title(title)
        axeslist.ravel()[idx].set_axis_off()
    fig.suptitle(r&#x27;Median nighttime light level [$Wcm^{-2}sr^{-1}$]&#x27;, fontsize=20)
    #plt.tight_layout() 

    </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tJaw2WH3JSsYdWJ4SyTLJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="c7WWl4RNgO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plot_figures(sorted_dict, 4, 2, clip_range=(0,1), factor=100./255.)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HCYlDfe0sL5IEcZTgeYyS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/825b81381eaebd4716b057f77b672bc4.png" alt="&lt;Figure size 1500x1500 with 8 Axes&gt;"/></div></div><div id="Fd937lgBCo" class="relative group/block"><h4 id="id-1-5-applying-color-blending" class="relative group"><span class="heading-text">1.5 Applying color blending</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-5-applying-color-blending" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="l8Rb2S6tpf" class="relative group/block"><p>Additive color blending involves mixing the primary colors of light, red (R), green (G), and blue (B), while adjusting their luminance levels. By manipulating the luminance of these colors, a wide range of hues can be achieved, with the key characteristic being that combining all three colors results in white.</p></div><div id="KJUiCSL7Ym" class="relative group/block"><p>Technique</p><ul><li>maximum pixel value of images for 2019 (brightest pixel values) is assigned to red (R)</li><li>minimum pixel value of images for 2020-2021 (darkest pixel values) is assigned to green (G)</li><li>maximum pixel value of images for 2022 (brightest pixel values) is assigned to blue (B)</li></ul></div><div id="CPwvyxpz7d" class="relative group/block"><p>Output</p><ul><li>regions where a decrease in nighttime light level occurred are displayed in red</li><li>areas that experienced an increase (presumed to indicate an increase in social activity) are shown in blue</li><li>regions where there was no significant change throughout the pandemic are displayed in a gradient from gray to white.</li></ul></div><div id="UkAFmkn0wC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">pattern = re.compile(r&quot;h(\d+)v(\d+)_(\d{4})_(\d)H_median\.tif&quot;)


def read_and_preprocess(file):
    with rasterio.open(file) as src:
        img = src.read(1)
        img = np.nan_to_num(img, nan=0)  # Replace NaNs with zeros
        return img, src.profile

    
def additive_blending(grouped_files):
    # Process each group of files for blending
    for (h, v), file_group in grouped_files.items():
        # Initialize arrays to store the maximum and minimum values for each year
        max_2019 = None
        min_2020_2021 = None
        max_2022 = None
        
        for year, H, file in file_group:
            img, profile = read_and_preprocess(file)
            
            if year == &#x27;2019&#x27;:
                if max_2019 is None:
                    max_2019 = img
                else:
                    max_2019 = np.maximum(max_2019, img)
            elif year in [&#x27;2020&#x27;, &#x27;2021&#x27;]:
                if min_2020_2021 is None:
                    min_2020_2021 = img
                else:
                    min_2020_2021 = np.minimum(min_2020_2021, img)
            elif year == &#x27;2022&#x27;:
                if max_2022 is None:
                    max_2022 = img
                else:
                    max_2022 = np.maximum(max_2022, img)
                                  
    # Create the blended image using the specified blending technique
    blended_img = np.zeros((max_2019.shape[0], max_2019.shape[1], 3), dtype=np.float32)
    blended_img[:, :, 0] = max_2019.astype(np.float32)  # Red band: maximum of 2019
    blended_img[:, :, 1] = min_2020_2021.astype(np.float32)  # Green band: minimum of 2020-2021 compared
    blended_img[:, :, 2] = max_2022.astype(np.float32)  # Blue band: maximum of 2022
    
    return blended_img, profile        </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LfA7ZJ_xHyvEJmKBTXZmz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wtbUj56Sad" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Grouping files per (h,v) tiles and years span
grouped_files = {}
for root, _, files in os.walk(input_path):
    
    
    # Group files by h and v
    for file in files:
        match = pattern.match(file)
        if match:
            h, v, year, H = match.groups()
            key = (h, v)
            if key not in grouped_files:
                grouped_files[key] = []
            grouped_files[key].append((year, H, os.path.join(root, file)))


# blending           
blended_img, profile = additive_blending(grouped_files)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PzcsMlyv3Z2xs_YaCtCZn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="oOKnJUXuHw" class="relative group/block"><h4 id="id-1-6-employing-urban-stretch-processing" class="relative group"><span class="heading-text">1.6 Employing “urban” stretch processing</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-6-employing-urban-stretch-processing" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="GGu2E6VdVX" class="relative group/block"><p>The purpose of the stretch processing is to emphasize the nighttime light level of each band (corresponding to 2019, 2020-21, and 2022), focusing on:</p><ul><li>“urban” nighttime light levels: the display range of each band is adjusted to 25-1000 [watts·cm-2·sr-1], emphasizing brighter areas</li></ul></div><div id="qalVHBWFh2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Urban stretch processing: Emphasize brighter areas
def urban_stretch_processing(band):
    min_val = 25
    max_val = 1000
    band = np.clip(band, min_val, max_val)
    band = (band - min_val) / (max_val - min_val) * 255
    return band.astype(np.uint8)

# Apply urban stretch processing to each band
blended_img[:, :, 0] = urban_stretch_processing(blended_img[:, :, 0])
blended_img[:, :, 1] = urban_stretch_processing(blended_img[:, :, 1])
blended_img[:, :, 2] = urban_stretch_processing(blended_img[:, :, 2])
        
# Update the profile for a 3-band image and set nodata value to None
profile.update(count=3, dtype=rasterio.uint8, nodata=None)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="k-Fv9BzRbffWrzye8MiAP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vN5TCwpl0i" class="relative group/block"><h4 id="id-1-7-plotting-blended-image" class="relative group"><span class="heading-text">1.7 Plotting blended image</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-7-plotting-blended-image" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="CRFUHU4xLo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def plot_image(image, factor=1.0, clip_range = None, **kwargs):
    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15, 15))
    if clip_range is not None:
        ax.imshow(np.clip(image * factor, *clip_range), **kwargs)
    else:
        ax.imshow(image * factor, **kwargs)
    ax.set_xticks([])
    ax.set_yticks([])


plot_image(blended_img, factor=1.5/255., clip_range=(0,1))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wrhp9UYQ0KZBHDAwr2RSB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/f198eccc56d09718ec07ec34ee418bfc.png" alt="&lt;Figure size 1500x1500 with 1 Axes&gt;"/></div></div><div id="YsirwPafdV" class="relative group/block"><h4 id="id-1-8-overlaying-with-an-interactive-map" class="relative group"><span class="heading-text">1.8 Overlaying with an interactive map</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-8-overlaying-with-an-interactive-map" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="wOjHb1ULaX" class="relative group/block"><p>Saving blended image as Cloud Optimized GeoTIFF</p></div><div id="w3kF3Sohxo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Exporting output as COG file 
res_name = f&quot;Nighttimelevel_Urban_{grid_tile}_2019-2022.tif&quot;
output_cog = os.path.join(urban_path, res_name)


# Write the blended image directly to a temporary file
with tempfile.NamedTemporaryFile(suffix=&quot;.tif&quot;) as temp_file:
    with rasterio.open(temp_file.name, &quot;w&quot;, **profile) as dst:
        dst.write(blended_img[:, :, 0], 1)
        dst.write(blended_img[:, :, 1], 2)
        dst.write(blended_img[:, :, 2], 3)

    subprocess.run([
        &quot;gdal_translate&quot;, &quot;-of&quot;, &quot;COG&quot;,
        &quot;-co&quot;, &quot;COMPRESS=DEFLATE&quot;,
        &quot;-co&quot;, &quot;BLOCKSIZE=512&quot;,
        &quot;-co&quot;, &quot;RESAMPLING=NEAREST&quot;,
        &quot;-co&quot;, &quot;OVERVIEWS=IGNORE_EXISTING&quot;,
        temp_file.name,
        output_cog
    ])

print(f&quot;COG file saved as {output_cog}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ngEiDC6a9kDwdSMh0Npi5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Input file size is 2400, 2400
0...10...20...30...40...50...60...70...80...90...100 - done.
COG file saved as /home/lubojr/2025-BiDS-EODashboard/notebook/Nightlights/output/Nighttimelevel_Urban_h25v06_2019-2022.tif
</span></code></pre></div></div></div><div id="bNq7nNcrN3" class="relative group/block"><p>Extracting bounding-box coordinates</p></div><div id="pXH0o6c9UV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">p1 = Popen([&quot;gdalinfo&quot;, &quot;-json&quot;, output_cog, &quot;-mm&quot;], stdout=PIPE)
output = p1.communicate()[0]
dec_out = output.decode(&#x27;utf-8&#x27;)
j_str = json.loads(dec_out)
bbox = j_str[&#x27;cornerCoordinates&#x27;]
ll = bbox[&#x27;lowerLeft&#x27;]  # SW coo
ur = bbox[&#x27;upperRight&#x27;] # NE coo
center = bbox[&#x27;center&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GULKefHaOFhrUBwRhWc_u" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="oBzbWeJNpB" class="relative group/block"><p>Adding alpha channel to the blended image</p></div><div id="aOrSvERIrB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def almostEquals(a,b,thres=50):
    return all(abs(a[i]-b[i])&lt;thres for i in range(len(a)))


image = Image.open(output_cog).convert(&#x27;RGBA&#x27;)
pixeldata = list(image.getdata())


for i,pixel in enumerate(pixeldata):
    if almostEquals(pixel[:3], (0,0,0)):
        pixeldata[i] = (0,0,0,0)


image.putdata(pixeldata)
png_path = os.path.join(urban_path, res_name.replace(&quot;.tif&quot;,&quot;.png&quot;))
res = image.save(png_path)
#os.path.abspath(res)
abs_path = os.path.abspath(png_path)
work_dir = os.getcwd()
id_ = work_dir.split(&#x27;/&#x27;)[2]
base_url = os.path.join(&#x27;https://hub-otc-sc.eox.at/user&#x27;,id_,&#x27;files&#x27;)
#base_url
abs_path = &#x27;/&#x27;.join(abs_path.split(&#x27;/&#x27;)[3:])
print(abs_path)
print(base_url)
#abs_path
print(os.path.join(base_url,abs_path))
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pRRYj7Rq5DKjCnbShUBDT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>2025-BiDS-EODashboard/notebook/Nightlights/output/Nighttimelevel_Urban_h25v06_2019-2022.png
https://hub-otc-sc.eox.at/user/lubojr/files
https://hub-otc-sc.eox.at/user/lubojr/files/2025-BiDS-EODashboard/notebook/Nightlights/output/Nighttimelevel_Urban_h25v06_2019-2022.png
</span></code></pre></div></div></div><div id="VnHxX4jjHX" class="relative group/block"><p>Overlay with OpenStreetMap</p></div><div id="W1Ms8AYrCo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">m = Map(basemap=basemaps.CartoDB.DarkMatter, center=(center[1], center[0]), zoom=6)
osm_url = os.path.join(base_url,abs_path)
image = ImageOverlay(url=osm_url,bounds=((ll[1], ll[0]), (ur[1], ur[0])))
m.add_layer(image);
m</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OdeNf82c3c32O-Zgva6jC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="Gk6JRAhgLC" class="relative group/block"><p>Using additive color blending images to focus on urban areas in India, in particular the North-West part comprising New Delhi, Jaipur, Agra, Gwalior, ...</p></div><div id="maDTxg3Zpd" class="relative group/block"><h4 id="id-1-9-alternative-stretch-processing-approaches" class="relative group"><span class="heading-text">1.9 Alternative stretch processing approaches</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-9-alternative-stretch-processing-approaches" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="X22gVUykXK" class="relative group/block"><ul><li>“Rural” nighttime light levels: setting each band’s display range to 0-50 [Watts·cm-2·sr-1] to emphasize darker areas</li><li>For a broader focus (from rural to urban areas): applying a log10 transformation to the values of each band with a display range set to 0-3.6 (equivalent to 0-3981 [Watts·cm-2·sr-1])</li></ul></div><div id="dCBOTmqXBS" class="relative group/block"><h4 id="id-1-10-final-remarks" class="relative group"><span class="heading-text">1.10 Final remarks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-10-final-remarks" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="Gsx1oWLZLm" class="relative group/block"><p>This product has been specifically designed for utilization by researchers in applied scientific fields.
<strong>Potential applications</strong> are being explored in environmental and social issue studies, such as:</p><ul><li><strong>disaster recovery</strong></li><li><strong>energy</strong></li><li><strong>urban land use changes</strong></li><li><strong>conflicts</strong></li><li><strong>migration</strong></li><li><strong>monitoring of illegal, unreported activities</strong></li></ul></div><div id="nVy6db3PIs" class="relative group/block"><h4 id="to-learn-more" class="relative group"><span class="heading-text">To learn more</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#to-learn-more" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="hEZJgvnPwd" class="relative group/block"><p>The presented approach is often referenced in scientific and public health research. For example, Bunpei Tojo (2021) used Nightlights data in the study “Application of Earth observation satellite data to public health: Comparison of night light (VIIRS) and solar radiation (SGLI) and domestic COVID-19 epidemic,” presented at the 12th Federation of Science and Technology conference, to analyze the relationship between nighttime light intensity and public health factors.
<cite class="" data-state="closed"><a href="https://doi.org/10.11487/oukan.2021.0_B-4-4" target="_blank" rel="noreferrer" class="hover-link">東城 (2021)</a></cite>.</p></div><div id="MOUg6WWqaU" class="relative group/block"><h2 id="use-case-2-air-pollution" class="relative group"><span class="heading-text">USE CASE 2: Air Pollution</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-case-2-air-pollution" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="monitoring-no2-concentrations-over-northern-india" class="relative group"><span class="heading-text">Monitoring NO2 concentrations over Northern India</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#monitoring-no2-concentrations-over-northern-india" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="FoRMS7tqNY" class="relative group/block"><p>Air quality is poor across India, but especially poor in <strong>Northern India</strong> due to a mix of human activity and seasonal weather conditions:</p><ul><li><strong>Vehicle emissions</strong>: The city’s high population density results in heavy traffic and significant pollution from older and poorly maintained vehicles. Increased investment in mass transportation and stricter fuel efficiency enforcement could help mitigate these issues in future.</li><li><strong>Industrial and construction dust</strong>: Industrial operations and ongoing construction projects release fine particulate matter into the air.</li><li><strong>Home heating</strong>: Coal, firewood, and diesel generator use can contribute to poor air quality.</li><li><strong>Weather patterns</strong>: Chillier temperatures, low wind speeds, and heavy air trap pollutants close to the ground during colder months, worsening smog.</li><li><strong>Crop stubble burning</strong>: Farmers in neighboring states including Bihar, Haryana, and Uttar Pradesh burn agricultural waste, contributing to particulate pollution</li></ul><p>Combined, these factors create a toxic atmosphere. Air quality is particularly dangerous during the winter months, when weather conditions exacerbate pollution.</p></div><div id="DqqdlYoF0D" class="relative group/block"><img id="YGd4GrT4FL" style="margin:0 auto" src="/eodashboard-notebooks/build/Northern_India-air_p-c6c5212798c61ec9d4ecbb8efe813b70.JPG" alt="title" data-canonical-url="Air_pollution/img/Northern_India-air_pollution.JPG" class=""/></div><div id="AHiTI5HQRA" class="relative group/block"><p>In particular, Delhi and large parts of North India experienced a significant <strong>air quality crisis towards the end of 2024</strong>, with air quality reaching the “Severe” and “Hazardous” categories, leading to a public health emergency.</p></div><div id="eYEOLOHk7E" class="relative group/block"><p>This use case aims at analyzing the air quality over North India, showing how to create a <strong>time series plot of mean tropospheric NO2 values</strong> accompanied by the standard deviation to assess the impact of the pollutant agent.</p></div><div id="aQpqIyOTYZ" class="relative group/block"><p>The tropospheric NO2 concetrations can be further explored on the EO Dashboard by selecting the ATMOSPHERE Theme and choosing <a target="_blank" rel="noreferrer" href="https://eodashboard.org/explore/?indicator=N1_NO2&amp;x=0.0000&amp;y=0.0000&amp;z=2.6812&amp;datetime=2025-06-23&amp;template=expert" class="">Air Quality (tropospheric NO2 concentrations)</a>.</p></div><div id="XOZZkniSxn" class="relative group/block"><h4 id="id-2-1-input-data" class="relative group"><span class="heading-text">2.1 Input data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-1-input-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li>Tropospheric nitrogen dioxide (NO2) measurements obtained by TROPOMI (multispectral imaging spectrometer) aboard ESA Sentinel-5 Precursor (S5P) satellite (part of the European Copernicus programme)</li><li>Aggregation: data combined over 14 days for averaging out meteorological daily variability</li><li>Spectral bands: ultraviolet and visible (270–500 nm), near-infrared (675–775 nm) and shortwave infrared (2305–2385 nm)</li><li>Resolution: (7 × 3.5) km</li><li>Metric: micromoles per square meter [μmol/m²], total number of molecules of NO2 within a column of the atmosphere</li><li>Data access: aggregated data collection available on Sentinel Hub as <a target="_blank" rel="noreferrer" href="https://docs.sentinel-hub.com/api/latest/data/byoc/" class="">Bring Your Own COG (BYOC)</a> and accessed using Sentinel Hub APIs</li></ul></div><div id="XOZwqccVgV" class="relative group/block"><h4 id="id-2-2-importing-python-libraries" class="relative group"><span class="heading-text">2.2 Importing Python libraries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-2-importing-python-libraries" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="A5M4w6I3Lg" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from oauthlib.oauth2 import BackendApplicationClient
from requests_oauthlib import OAuth2Session
import subprocess
import json
import requests
import pandas as pd
import os 
import IPython.display
from datetime import datetime
import matplotlib.pyplot as plt
from sentinelhub import BBox</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Rr5TlLabmp3K06hpujn8n" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EJCe18uuKy" class="relative group/block"><h4 id="id-2-3-visualizing-the-aoi-gurugram-south-west-of-new-delhi" class="relative group"><span class="heading-text">2.3 Visualizing the AoI (Gurugram, South-West of New Delhi)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-3-visualizing-the-aoi-gurugram-south-west-of-new-delhi" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="WiJhy6Tw0G" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Gurugram coordinates
top_left_x =  76.9602268594042
top_left_y = 28.5355222251629
bottom_right_x = 77.11128887112295 
bottom_right_y = 28.394875392026698

bbox = [   
  top_left_x,
  bottom_right_y,
  bottom_right_x,
  top_left_y
        ]

# Bbox EPSG
bbox_epsg = 4326</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hIgJaocfeU8kDhr3AivvZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="FNnBRCpVlQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Plotting the bounding box on a map

IPython.display.GeoJSON(BBox(bbox,crs=bbox_epsg).get_geojson())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="o4JmThgEoIuXRyLGZGX-c" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="s1hZuIXJQN" class="relative group/block"><h4 id="id-2-4-using-sentinel-hub-statistical-api-request-to-access-no2-data-collection-for-the-selected-aoi" class="relative group"><span class="heading-text">2.4 Using Sentinel Hub statistical API request to access NO2 data collection for the selected AoI</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-4-using-sentinel-hub-statistical-api-request-to-access-no2-data-collection-for-the-selected-aoi" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="z7TZxR9jzN" class="relative group/block"><p>The Statistical API (or shortly “Stats API”) enables to get statistics calculated based on satellite imagery without having to download images.
In the <strong>Statistical API request</strong>, one can specify the following <strong>inputs</strong>:</p><ul><li><strong>area of interest (AoI)</strong></li><li><strong>time period</strong></li><li><strong>data collection</strong> data collection id info on the publicly accessible <a target="_blank" rel="noreferrer" href="https://esa-eodashboards.github.io/eodashboard-catalog/trilateral/catalog.json" class="">STAC catalog</a> (it can be also be queried via the pystac library as in this <a target="_blank" rel="noreferrer" href="https://eodashboard.org/notebook/?id=notebooks/eodashboard-stac-access/eodashboard-stac-access" class="">example</a>)</li><li><strong>evalscript</strong> or “custom script” is a piece of Javascript code which defines how the satellite data shall be processed by Sentinel Hub and what values the service shall return (more info <a target="_blank" rel="noreferrer" href="https://docs.sentinel-hub.com/api/latest/evalscript/v3/" class="">here</a>)</li><li><strong>statistics to be calculated</strong> are returned in the API response in a json format. Further details can be found on the corresponding <a target="_blank" rel="noreferrer" href="https://docs.sentinel-hub.com/api/latest/api/statistical/" class="">SH documentation</a>.</li></ul></div><div id="PEXibTjXd6" class="relative group/block"><h5 id="defining-statistical-api-input-parameters-aoi-time-period-data-collection" class="relative group"><span class="heading-text">Defining Statistical API input parameters: AoI, time period, data collection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-statistical-api-input-parameters-aoi-time-period-data-collection" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="hCJwtMMavK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># AoI coordinates WGS84 (Gurugram)
bbox = [   
  top_left_x,
  top_left_y,
  bottom_right_x,
  bottom_right_y,
        ]

# Time period
date_from = &quot;2024-11-01T00:00:00.000Z&quot;
date_to = &quot;2025-02-28T00:00:00.000Z&quot;

# Data collection id
data_collection = &quot;byoc-972e67a7-2ca8-4bf6-964a-11fe772e3ac2&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Bd9jADnqNN-n0Ril5DTnm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="JNEopL9qlB" class="relative group/block"><h5 id="defining-statistical-api-input-parameters-custom-script-evalscript" class="relative group"><span class="heading-text">Defining Statistical API input parameters: custom script (evalscript)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-statistical-api-input-parameters-custom-script-evalscript" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="UHUbwFAKnm" class="relative group/block"><p>Evalscript version 3 (V3) requires to specify two functions:</p><ul><li>setup: where you specify inputs and outputs.</li><li>evaluatePixel: which calculates the output values for each pixel.</li></ul><p>evaluatePixel() function must, in addition to other output, always return also dataMask output.
This output defines which pixels are excluded from calculations.</p></div><div id="ijUdMcRrW0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Evalscript
evalscript=&quot;&quot;&quot;
//VERSION=3
function setup() {
  return {
    input: [{bands: [&quot;tropno2&quot;,&quot;dataMask&quot;]}],
    output: [
      {
      id: &quot;data&quot;,
      bands: 1,
      sampleType: &quot;FLOAT32&quot;
      },
      {
      id: &quot;dataMask&quot;,
      bands: 1
      }]
    }
}

function evaluatePixel(samples) {
  let validValue = 1    // data sanitation
  if (samples.tropno2 &gt;= 1e20 ){
    validValue = 0
    }
  let index = samples.tropno2;
  return {
    data:  [index],
    dataMask: [samples.dataMask * validValue]
    }
}
&quot;&quot;&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PWtyrg4lUyY05uxR0qw5C" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yBU8I5Ptkz" class="relative group/block"><h5 id="building-no2-data-request" class="relative group"><span class="heading-text">Building NO2 data request</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#building-no2-data-request" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="itYPQHymyl" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">data_req = {
  &quot;input&quot;: {
    &quot;bounds&quot;: {
      &quot;bbox&quot;: bbox
    },
    &quot;data&quot;: [
      {
        &quot;dataFilter&quot;: {},
        &quot;type&quot;: data_collection
      }
    ]
  },
  &quot;aggregation&quot;: {
    &quot;evalscript&quot;: evalscript,
    &quot;timeRange&quot;: {
      &quot;from&quot;: date_from,
      &quot;to&quot;: date_to
    },
    &quot;aggregationInterval&quot;: {
      &quot;of&quot;: &quot;P1D&quot;
    },
    &quot;width&quot;: 100,
    &quot;height&quot;: 100
  },
  &quot;calculations&quot;: {
    &quot;default&quot;: {}
  }
}
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xIw8qFn22LR3DXP0x5NsS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="n5viwL8Abv" class="relative group/block"><h5 id="setting-credentials-for-accessing-sentinel-hub-services" class="relative group"><span class="heading-text">Setting credentials for accessing Sentinel Hub services</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#setting-credentials-for-accessing-sentinel-hub-services" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><p>OAuth credentials to access SH services can be obtained by following the <a target="_blank" rel="noreferrer" href="https://docs.sentinel-hub.com/api/latest/api/overview/authentication/" class="">instructions</a> provided on the SH platform.</p></div><div id="cw4x8nyNeY" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
# Creating a session
service_url = &quot;https://services.sentinel-hub.com&quot; # SH services endpoint

# OAuth Client configuration
client_id = os.environ.get(&quot;SH_CLIENT_ID&quot;)
client_secret = os.environ.get(&quot;SH_CLIENT_SECRET&quot;)

client = BackendApplicationClient(client_id=client_id)
oauth = OAuth2Session(client=client)

# Get token for the session
token_url = f&quot;{service_url}/oauth/token&quot; # Sentinel-Hub OAuth2 server token endpoint
token = oauth.fetch_token(token_url=token_url,
                          client_secret=client_secret)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5HXj2qo0zlH7PHY-Vp3fW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="w0v0VQzEDp" class="relative group/block"><h5 id="sending-a-post-request-to-sh-statistical-api" class="relative group"><span class="heading-text">Sending a POST request to SH Statistical API</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#sending-a-post-request-to-sh-statistical-api" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="xrn79W7JyA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">stat_url = f&quot;{service_url}/api/v1/statistics&quot; # SH statistical API endpoint
resp = oauth.post(stat_url,
                  headers={&quot;Accept&quot;:&quot;application/json&quot;,&quot;Content-Type&quot;:&quot;application/json&quot;},
                  json=data_req)
#print(resp.status_code, resp.text)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lS38U6QSEwBkZs69uvXIJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="JvciaNu3uW" class="relative group/block"><h5 id="parsing-response-and-extracting-relevant-statistics" class="relative group"><span class="heading-text">Parsing response and extracting relevant statistics</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#parsing-response-and-extracting-relevant-statistics" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="PAgZTWhDzI" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extracting stats from timeseries data within the specified time interval
data_r = resp.json() # parsing response to json
time_axis = [datetime.strptime(entry[&quot;interval&quot;][&quot;from&quot;], &quot;%Y-%m-%dT%H:%M:%SZ&quot;).strftime(&quot;%Y/%m/%d&quot;) for entry in data_r[&quot;data&quot;]]
means = [float(entry[&#x27;outputs&#x27;][&#x27;data&#x27;][&#x27;bands&#x27;][&#x27;B0&#x27;][&#x27;stats&#x27;][&#x27;mean&#x27;]) for entry in data_r[&quot;data&quot;]]
std_devs = [float(entry[&#x27;outputs&#x27;][&#x27;data&#x27;][&#x27;bands&#x27;][&#x27;B0&#x27;][&#x27;stats&#x27;][&#x27;stDev&#x27;]) for entry in data_r[&quot;data&quot;]]
std_upper = [m+s for (m,s) in zip(means, std_devs)]
std_lower = [m-s for (m,s) in zip(means, std_devs)]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="oO9tISxjCxD-pM7jRjtV_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="aAZMTCADSQ" class="relative group/block"><h4 id="id-2-5-plotting-the-statistics-for-the-no2-timeseries" class="relative group"><span class="heading-text">2.5 Plotting the statistics for the NO2 timeseries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-5-plotting-the-statistics-for-the-no2-timeseries" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="uWprFZs1Wn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(20,10))
# plot mean values 
plt.plot(time_axis, means, linestyle=&#x27;solid&#x27;, linewidth=2, color=&quot;black&quot;, label=&quot;Mean Tropospheric NO2 values [umol/ m^2]&quot;)

# plot standard deviation error bars
plt.errorbar(time_axis, means, yerr=std_devs, linestyle=&quot;-&quot;)

plt.title(&#x27;Tropospheric NO2 Values over the AOI&#x27;)
plt.legend()
fig.autofmt_xdate()

# Saving plot
output_no2 = &quot;output&quot;
output_no2_path = os.path.join(os.getcwd(), &quot;Air_pollution&quot;, output_no2)
os.makedirs(output_no2_path, exist_ok=True)
plt.savefig(os.path.join(output_no2_path, &#x27;NO2_Gurugram.png&#x27;))

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="St07-oPaXhFD0veJlPkl6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/67372d6fd9791368d098641b91b6fff1.png" alt="&lt;Figure size 2000x1000 with 1 Axes&gt;"/></div></div><div id="J6tBHKJpmU" class="relative group/block"><p>The plot shows a spike in NO2 concentration over Gurugram in December 2024, when the significant air quality crisis in Northern India has been reported.
In particular, it can be noticed that the standard deviation starts increasing over this month with respect to the preceding and subsequent  time interval.</p></div><div id="YlSXIjJCgX" class="relative group/block"><h4 id="id-2-6-final-remarks" class="relative group"><span class="heading-text">2.6 Final remarks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-6-final-remarks" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="Mi2r4Y1Rd5" class="relative group/block"><p>The analysis carried out in this use case demonstrates how the <em>Sentinel-5 Precursor Copernicus mission</em> represents an essential contribution to monitoring air quality and providing critical information to services and decision makers to safeguard the everyday life of citizens.</p><p>In addition to nitrogen dioxide, the Tropomi spectrometer can map a multitude of trace gases such as:</p><ul><li>ozone</li><li>formaldehyde</li><li>sulphur dioxide</li><li>methane</li><li>carbon monoxide</li><li>aerosols</li></ul><p>all of which affect the air we breathe and therefore our <strong>health</strong>, and our <strong>climate</strong>.</p></div><div id="kuy7hiYX4E" class="relative group/block"><h2 id="use-case-3-heatwaves" class="relative group"><span class="heading-text">USE CASE 3: HEATWAVES</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-case-3-heatwaves" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="analyzing-land-surface-temperature-with-gcom-c-shikisai-satellite-data-from-jaxa" class="relative group"><span class="heading-text">Analyzing Land Surface Temperature with GCOM-C ‘Shikisai’ Satellite Data from JAXA</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#analyzing-land-surface-temperature-with-gcom-c-shikisai-satellite-data-from-jaxa" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In this use case, we will explore <strong>GCOM (Global Change Observation Mission)</strong> satellite data to analyze <strong>Land Surface Temperature (LST)</strong>. Specifically, we’ll look at data from the <strong>GCOM-C</strong> satellite, which is part of the Japan Aerospace Exploration Agency’s (<strong>JAXA</strong>) efforts to monitor global climate change. GCOM-C provides valuable information on various environmental factors, including temperature, vegetation, and water bodies, through its thermal infrared sensors.
Our focus will be on studying the <strong>heatwave</strong> that occurred in <strong>New Delhi, India, in 2024</strong>. In particular, the city experienced a significant temperature surge during the peak summer months. The temperature exceeded <strong>45°C (113°F)</strong>, causing severe disruptions to daily life, and raising concerns about the increasing frequency and intensity of heatwaves due to climate change.
By analyzing GCOM-C’s satellite data, we can better understand the spatial distribution of land surface temperature during that period.</p><img id="gFRk0yfmnJ" style="margin:0 auto" src="/eodashboard-notebooks/build/4cea597f3e78ea8f2da8950b64da3d78.jpeg" alt="Title" data-canonical-url="https://th-i.thgim.com/public/incoming/ifa6rc/article68228316.ece/alternates/LANDSCAPE_1200/07_Standalone_Hot_Weather_Mirage_29_05_Delhi.jpg" class=""/><p>The July LST can be further explored on the <a target="_blank" rel="noreferrer" href="https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json&amp;x=1.4778&amp;y=9.5915&amp;z=4.0973&amp;datetime=2018-07-20&amp;indicator=GCOM_global_monthly" class="">EO Dashboard </a>.</p></div><div id="SnjnNS9hYl" class="relative group/block"><h4 id="id-3-1-input-data" class="relative group"><span class="heading-text">3.1 Input data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-1-input-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li>Aggregation: Monthly <strong>averaged global dataset for July 2024</strong> (daytime measurements)</li><li>Variable: <strong>Land Surface Temperature (LST)</strong> (which is a Level-2 product, calculating from two thermal infrared (TIR) bands  two TIR bands (10.8 µm &amp; 12.0 µm) using a hybrid split-window + semi-analytical algorithm that accounts for emissivity and atmospheric effects.</li><li>Spatial coverage: spatial coordinates 0°–90° East and 0°–90° North.</li><li>Resolution: Approximately 1 km (spatial resolution of SGLI Level 3 products).</li><li>Metric (units): Kelvin (°K) with scale factor of <strong>0.02</strong>, since: K = DN*0.02.</li><li>Dataset documentation: <a target="_blank" rel="noreferrer" href="https://suzaku.eorc.jaxa.jp/GCOM_C/data/ATBD/ver2/V2ATBD_T4A_LST_Moriyama_r1.pdf" class="">https://<wbr/>suzaku<wbr/>.eorc<wbr/>.jaxa<wbr/>.jp<wbr/>/GCOM<wbr/>_C<wbr/>/data<wbr/>/ATBD<wbr/>/ver2<wbr/>/V2ATBD<wbr/>_T4A<wbr/>_LST<wbr/>_Moriyama<wbr/>_r1<wbr/>.pdf</a></li><li>DOI: 10.57746/EO.01gs73bfs5sbzhyxg4j9ytajsa</li></ul></div><div id="rAo3Zh0yEr" class="relative group/block"><h4 id="id-3-2-import-libraries" class="relative group"><span class="heading-text">3.2 Import libraries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-2-import-libraries" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="j2zWgtweg9" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import geopandas as gpd
import rasterio
from rasterio.mask import mask
import matplotlib.pyplot as plt
from osgeo import gdal
import requests
import numpy as np
import matplotlib.pyplot as plt
from osgeo import gdal
from matplotlib.colors import LinearSegmentedColormap
import matplotlib.patches as patches
import matplotlib.colors as mcolors</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JyKl2WPF56XcSAD-Oy229" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QiR0abSXXh" class="relative group/block"><h4 id="id-3-3-defining-working-folders" class="relative group"><span class="heading-text">3.3 Defining working folders</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-3-defining-working-folders" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="ottG74jyob" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">output_urban = &quot;output&quot;
urban_path = os.path.join(os.getcwd(), &quot;Heatwaves&quot;, output_urban)

# Create output dir
os.makedirs(urban_path, exist_ok=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lqFzjrNXNwa84ViY3FnLg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RfwocQnPIr" class="relative group/block"><h4 id="id-3-4-visualizing-input-dataset" class="relative group"><span class="heading-text">3.4 Visualizing input dataset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-4-visualizing-input-dataset" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="PlL50vm0K3" class="relative group/block"><h5 id="saving-dataset-locally-from-data-endpoint" class="relative group"><span class="heading-text">Saving dataset locally from data endpoint</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#saving-dataset-locally-from-data-endpoint" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><ul><li>This URL (data endpoint) contains a GeoTIFF file from LST and <a target="_blank" rel="noreferrer" href="https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json&amp;x=1.4778&amp;y=9.5915&amp;z=4.0973&amp;datetime=2018-07-20&amp;indicator=GCOM_global_monthly" class=""><strong>it’s part of the EO Dashboard data ecosystem</strong></a></li><li>Dataset originally was generated in the <a target="_blank" rel="noreferrer" href="https://data.earth.jaxa.jp/en/datasets/#/id/JAXA.G-Portal_GCOM-C.SGLI_standard.L3-AROT.daytime.v3_global_daily" class="">JAXA’s G-Portal</a> and JAXA provides direct access to this and other COGs through their Earth API</li><li>While these COGs differ between Level 0 and Level 1 data (meaning it is not yet possible to create composite layers), the <strong>EO Dashboard</strong> allows integration of raw Level 1 COGs hosted by JAXA (<a target="_blank" rel="noreferrer" href="https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json&amp;x=1.4778&amp;y=9.5915&amp;z=4.0973&amp;datetime=2018-07-20&amp;indicator=GCOM_global_monthly" class="">example</a>)</li></ul></div><div id="IOV7frznyE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Data endpoint
url = &quot;https://s3.ap-northeast-1.wasabisys.com/je-pds/cog/v1/JAXA.G-Portal_GCOM-C.SGLI_standard.L3-LST.daytime.v3_global_monthly/2024-07/1/E000.00-E090.00/E000.00-N00.00-E090.00-N90.00-LST.tiff&quot;
# Downloads the file from the URL
response = requests.get(url)
# Saves file locally 
with open(&quot;Heatwaves/LST.tiff&quot;, &quot;wb&quot;) as f:
    f.write(response.content)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HqjfBOEU98pL2R9H2DxTG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="dwB1EpWSQv" class="relative group/block"><h5 id="plot-the-image" class="relative group"><span class="heading-text">Plot the image</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-the-image" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="r85Z2PdZbJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Opening the file with GDAL (library for geospatial raster data)
ds = gdal.Open(&quot;Heatwaves/LST.tiff&quot;)
# Gests the first (and in this case) only band refering to LST.
band = ds.GetRasterBand(1)
#Reads the raster into a NumPy array (a sort of matrix)
arr = band.ReadAsArray().astype(float)

# Plotting
import matplotlib.pyplot as plt
plt.imshow(arr, cmap=&quot;viridis&quot;)
plt.colorbar()
plt.title(&quot;LST&quot;)
plt.show()

print(&#x27; - - - &#x27;)
print(&#x27;Aditional information about the dataset:&#x27;)
print(&#x27; - - - &#x27;)
print(ds.GetProjection(), ds.GetGeoTransform())
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="sKcRlz0nmR8-kKZJMujxK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/d02536bc5ff9e1c0b153e66b17be6474.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span> - - - 
Aditional information about the dataset:
 - - - 
GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]] (0.0, 0.025, 0.0, 90.0, 0.0, -0.025)
</span></code></pre></div></div></div><div id="sqc3qYTwpq" class="relative group/block"><h4 id="id-3-4-converting-to-celsius-degrees-and-clean-unvalid-pixels" class="relative group"><span class="heading-text">3.4 Converting to Celsius Degrees and clean unvalid pixels</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-4-converting-to-celsius-degrees-and-clean-unvalid-pixels" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li>The JAXA GCOM-C SGLI L3 LST had a 0.02 scalling factor and was in Kelvin.</li><li>Removing values of pixels (consider them as NaN)</li></ul></div><div id="snNS2XSgr6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Now we mask invalid or unrealistic values (sometimes satellite data have artifacts or other issues that render the value of a pixel wrong)
arr[(arr &lt;= 0) | (arr &gt; 35000)] = np.nan

# Re-scale and convert from Kelvin to Celsius
arr_c = arr * 0.02 - 273.15  </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jGgFyYfUCgU0CcluAQHq5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="umNh7CeUyT" class="relative group/block"><h4 id="id-3-4-croping-to-areas-of-interest-northern-india-and-new-dehli" class="relative group"><span class="heading-text">3.4 Croping to areas of interest: Northern India and New Dehli</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-4-croping-to-areas-of-interest-northern-india-and-new-dehli" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="lNwFGfdMCZ" class="relative group/block"><h5 id="defining-locations-of-interest" class="relative group"><span class="heading-text">Defining locations of interest</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-locations-of-interest" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="hHV4YXHz5H" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># GeoTransform is a GDAL function that helps map between the raster coordinates and georeference coordinates
# In other words it is converting geographic coordinates (lat, lon) into pixel coordinates of our matrix (X, y)
gt = ds.GetGeoTransform()
def latlon_to_pixel(lat, lon, gt):
    px = int((lon - gt[0]) / gt[1])
    py = int((lat - gt[3]) / gt[5])
    return px, py

# Now we use this function to get the pixel coordinates of an area around Northern India 
lon_min, lon_max = 70, 90
lat_min, lat_max = 20, 37
px_min, py_max = latlon_to_pixel(lat_min, lon_min, gt)
px_max, py_min = latlon_to_pixel(lat_max, lon_max, gt)
# &#x27;Bounding box of northern India&#x27;
arr_crop_india = arr_c[py_min:py_max, px_min:px_max]

# We do the same for New Dehli
lon_min, lon_max = 76.8, 77.5
lat_min, lat_max = 28.4, 28.9
px_min2, py_max2 = latlon_to_pixel(lat_min, lon_min, gt)
px_max2, py_min2 = latlon_to_pixel(lat_max, lon_max, gt)
arr_crop_delhi = arr_c[py_min2:py_max2, px_min2:px_max2]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5Czq2gyUyBYAX2Qcj85ZK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xIgfwEiHHa" class="relative group/block"><h5 id="plotting-results" class="relative group"><span class="heading-text">Plotting results</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plotting-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="A4aI4XOxBR" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Selecting the color scheme 
cmap = &quot;plasma&quot;  

# Settlings to ensure we have 2 plots, side by side
fig, axes = plt.subplots(1, 2, figsize=(14, 6))
vmin, vmax = 27, 50  

# 
im1 = axes[0].imshow(arr_crop_india, cmap=cmap, vmin=vmin, vmax=vmax)
axes[0].set_title(&quot;LST (°C) - Northern India&quot;)
cbar1 = fig.colorbar(im1, ax=axes[0], orientation=&quot;horizontal&quot;, fraction=0.046, pad=0.08)
cbar1.set_label(&quot;LST (°C)&quot;)

# Mark New Delhi on Northern India map
delhi_lat, delhi_lon = 28.61, 77.21
px_delhi, py_delhi = latlon_to_pixel(delhi_lat, delhi_lon, gt)
px_delhi_rel = px_delhi - px_min
py_delhi_rel = py_delhi - py_min
axes[0].scatter(px_delhi_rel, py_delhi_rel, color=&quot;red&quot;, s=40, marker=&quot;o&quot;)
axes[0].text(px_delhi_rel + 5, py_delhi_rel - 5, &quot;New Delhi&quot;, color=&quot;white&quot;,
             fontsize=10, weight=&quot;bold&quot;, backgroundcolor=&quot;black&quot;)

# Plot side-by-side
im2 = axes[1].imshow(arr_crop_delhi, cmap=cmap, vmin=vmin, vmax=vmax)
axes[1].set_title(&quot;LST (°C) - New Delhi (Cropped and zoomed it)&quot;)
cbar2 = fig.colorbar(im2, ax=axes[1], orientation=&quot;horizontal&quot;, fraction=0.046, pad=0.08)
cbar2.set_label(&quot;LST (°C)&quot;)

plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nZL3OSz9TSwNCw3mVDfoJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/8c4ee3ee3fdb8cd666a6987e0b7b9df7.png" alt="&lt;Figure size 1400x600 with 4 Axes&gt;"/></div></div><div id="x2jslNo8uo" class="relative group/block"><h4 id="id-3-5-identifying-locations-where-heatwave-has-occured-in-june-2024" class="relative group"><span class="heading-text">3.5 Identifying locations where Heatwave has occured in June 2024</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-5-identifying-locations-where-heatwave-has-occured-in-june-2024" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><h6 id="defiyning-the-threshold" class="relative group"><span class="heading-text">Defiyning the threshold:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defiyning-the-threshold" title="Link to this Section" aria-label="Link to this Section">¶</a></h6><ul><li>Applying a <strong>threshold</strong> (temperature limit from which it’s considered to be a ‘heatwave’): <strong>40</strong></li></ul></div><div id="kETNu1nVwC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">threshold = 40</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UDXjMj47XaeTPe__5PZmj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hKaJcSuFIP" class="relative group/block"><h6 id="selecting-the-aoi" class="relative group"><span class="heading-text">Selecting the AoI</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#selecting-the-aoi" title="Link to this Section" aria-label="Link to this Section">¶</a></h6><ul><li>From before we defined New Delhi <strong>arr_crop_delhi</strong> or northern india <strong>arr_crop_india</strong></li></ul></div><div id="fsvhQN4vwj" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">arr_view = arr_crop_delhi</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gat0xWy4ubHpgcTxvdBnf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="DduxmHClNJ" class="relative group/block"><ul><li>Creating a <strong>mask</strong> with that value</li></ul></div><div id="HWxoRkv2Ce" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create a colormap from plasma
base_cmap = plt.cm.plasma
newcolors = base_cmap(np.linspace(0, 1, 256))
vmin, vmax = 27, 49

# Create a ListedColormap
cmap = mcolors.ListedColormap(newcolors)

# Create a mask for values &gt; threshold
arr_masked = np.where(arr_view &gt; threshold, np.nan, arr_view)

# Plot
fig, ax = plt.subplots(figsize=(12, 9))
im = ax.imshow(arr_masked, cmap=cmap, vmin=vmin, vmax=vmax)

# Overlay black for pixels &gt; threshold
ax.imshow(np.where(arr_view &gt; threshold, 1, np.nan), cmap=mcolors.ListedColormap([[0,0,0,1]]))

# Colorbar
cbar = fig.colorbar(im, ax=ax, orientation=&quot;horizontal&quot;, fraction=0.046, pad=0.08)
cbar.set_label(&quot;LST (°C)&quot;)
cbar.ax.text(0.99, -0.99, f&quot;&gt;{threshold}°C = black = heatwave location&quot;, color=&quot;black&quot;,
             fontsize=12, ha=&#x27;center&#x27;, va=&#x27;center&#x27;, transform=cbar.ax.transAxes)

# Title
ax.set_title(&quot;LST (°C) July Average Land Surface Temperatures&quot;, fontsize=16)


# Only show New Delhi if arr_view is arr_crop_india
if &#x27;arr_crop_india&#x27; in globals() and arr_view is arr_crop_india:
    ax.scatter(px_delhi_rel, py_delhi_rel, color=&quot;red&quot;, s=100, marker=&quot;X&quot;)
    circle = patches.Circle((px_delhi_rel, py_delhi_rel), radius=40,
                            edgecolor=&#x27;red&#x27;, facecolor=&#x27;none&#x27;, linewidth=2.5)
    ax.add_patch(circle)
    ax.text(px_delhi_rel + 50, py_delhi_rel - 15, &quot;New Delhi&quot;,
            color=&quot;white&quot;, fontsize=10, weight=&quot;bold&quot;, backgroundcolor=&quot;black&quot;)


plt.tight_layout()
plt.show()
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="f4GbH66W_n1tNZoEyCjwm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/8d2d6eb30ae78ccbae39b94ecc56ea29.png" alt="&lt;Figure size 1200x900 with 2 Axes&gt;"/></div></div><div id="pfcPQHYZGM" class="relative group/block"><h4 id="id-3-6-calculating-areas-sqkm-affected-within-the-selected-area" class="relative group"><span class="heading-text">3.6 Calculating areas (sqkm) affected within the selected area</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-6-calculating-areas-sqkm-affected-within-the-selected-area" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="xmh9zJ062n" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Mask pixels above threshold value
hot_pixels = arr_view &gt; threshold

# Count pixels
num_hot_pixels = np.sum(hot_pixels)

# Assuming 1 km² per pixel
area_km2 = num_hot_pixels * 1  # 1 km² per pixel

print(f&quot;Number of pixels &gt; {threshold}°C: {num_hot_pixels}&quot;)
print(f&quot;Total area &gt; {threshold}°C: {area_km2} km²&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2h_zNHuMPcYBe9Yo5n_-B" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Number of pixels &gt; 40°C: 26
Total area &gt; 40°C: 26 km²
</span></code></pre></div></div></div><div id="jiPr6s4uKC" class="relative group/block"><h4 id="id-3-7-final-remarks" class="relative group"><span class="heading-text">3.7 Final remarks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-7-final-remarks" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>High Temperatures Around New Delhi
The highlighted region (New Delhi) shows elevated land surface temperatures, consistent with the reported heatwave where values exceeded 40 °C.</p><ul><li>Central and northwestern plains (yellow/orange shades) show much higher LST, typical of semi-arid and urbanized regions during peak summer.</li><li><strong>Urban Heat Island Effect</strong> - The dense, bright patch around New Delhi suggests an intensified heating effect compared to the surrounding rural areas, which may be attributed to urbanization, infrastructure, and reduced vegetation cover.</li><li>In contrast, coastal and mountainous regions show a clear temperature contrast, indicating geographical control over heat distribution.</li></ul></div><div id="inTmqIedm3" class="relative group/block"><h2 id="use-case-4-urban-health" class="relative group"><span class="heading-text">USE CASE 4: URBAN HEALTH</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-case-4-urban-health" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="assessing-deprivation-and-poverty-in-new-dehli-and-gurugram" class="relative group"><span class="heading-text">Assessing deprivation and poverty in New Dehli and Gurugram</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#assessing-deprivation-and-poverty-in-new-dehli-and-gurugram" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="mr1K8zTvFc" class="relative group/block"><p>This use case demonstrates how to <strong>estimate deprivation and poverty of two cities</strong>, using the <strong>Global Gridded Relative Deprivation Index (GRDI), Version 1 dataset</strong>. characterizes the relative levels of multidimensional deprivation and poverty where a <strong>value of 100 represents the highest level of deprivation and a value of 0 the lowest</strong>. GRDI is built from sociodemographic and satellite data inputs that were spatially harmonized, indexed, and weighted into six main components to produce the final GRDI layer. Inputs were selected from the best-available data that either continuously vary across space or have at least administrative level 1 (provincial/state) resolution, and which have global spatial coverage. GRDI has six input components, or dimensions, that are combined to determine the degree of relative deprivation:</p><ul><li><strong>Built-up to Non-built-up Area Ratio (BUILT)</strong>: Lower ratios mean higher deprivation, as rural areas (with less built-up land) tend to face more poverty.</li><li><strong>Child Dependency Ratio (CDR)</strong>: Higher ratios mean higher deprivation, since more children depend on fewer working-age adults.</li><li><strong>Infant Mortality Rate (IMR)</strong>: Higher mortality rates signal higher deprivation.</li><li><strong>Subnational Human Development Index (SHDI)</strong>: Lower values mean higher deprivation in education, health, and living standards.</li><li><strong>VIIRS Night Lights (VNL)</strong>: Lower light intensity indicates higher deprivation, reflecting weaker economic activity and infrastructure.</li><li><strong>VNL Slope (2012–2020)</strong>: A positive slope (increasing brightness) implies decreasing deprivation; a negative slope implies increasing deprivation.</li></ul><p>In this use case, we will compare both the <strong>GRDI</strong> and <strong>VNL slope</strong> specifically to the the cities of New Dehli and Gurugram.</p><img id="UqhQAIsxBI" style="width:70%;margin:0 auto" src="/eodashboard-notebooks/build/dd434246310f90d1292b41aefe3cae36.jpeg" alt="Description" data-canonical-url="https://thumbnails.openveda.cloud/grdi--dataset-cover.jpg" class=""/><p>The Global Gridded Relative Deprivation Indexindicator can be explored on the EO Dashboard by selecting the EXPLORE DATASETS mode and choosing <a target="_blank" rel="noreferrer" href="https://eodashboard.org/explore/?x=-0.0917&amp;y=39.4096&amp;z=2.4939&amp;datetime=2010-01-01&amp;template=expert&amp;indicator=GRDI2" class="">GRDI Indicator</a>.</p></div><div id="qhq7W0V6li" class="relative group/block"><h4 id="id-4-1-input-data-grdi" class="relative group"><span class="heading-text">4.1. Input data (GRDI)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-1-input-data-grdi" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li>Temporal Resolution: n/a ( single image resulting from the aggregation of 6 indicators collected within (2010-2020)</li><li>Spatial Extent: Global</li><li>Spatial Resolution: 30 arc-second (~1 km x 1 km)</li><li>Data Units: relative level of multidimensional deprivation and poverty in each pixel represented as an index <strong>from 0 to 100</strong></li><li>DOI: <cite class="" data-state="closed"><a href="https://doi.org/10.7927/3XXE-AP97" target="_blank" rel="noreferrer" class="hover-link">Center For International Earth Science Information Network-CIESIN-Columbia University (2022)</a></cite></li><li>Dataset documentation: <a target="_blank" rel="noreferrer" href="https://www.earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-pmp-grdi-2010-2020-1.00#documents-and-resources" class="">https://<wbr/>www<wbr/>.earthdata<wbr/>.nasa<wbr/>.gov<wbr/>/data<wbr/>/catalog<wbr/>/sedac<wbr/>-ciesin<wbr/>-sedac<wbr/>-pmp<wbr/>-grdi<wbr/>-2010<wbr/>-2020<wbr/>-1<wbr/>.00<wbr/>#documents<wbr/>-and<wbr/>-resources</a></li></ul></div><div id="PsDKYCgLPa" class="relative group/block"><h4 id="id-4-2-import-python-libraries" class="relative group"><span class="heading-text">4.2 Import python libraries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-2-import-python-libraries" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="ELxicShxkW" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import requests
from IPython.display import Image
import mercantile
from io import BytesIO
import numpy as np
import matplotlib.pyplot as plt
from PIL import Image
import mercantile
import numpy as np
from shapely.geometry import Polygon, Point
#from pykml import parser
import matplotlib.pyplot as plt
#!pip install fastkml shapely
#!pip install pykml
import requests
import folium
from folium.raster_layers import ImageOverlay</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VElN_YCHLCTk_ZVZogTiG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="co7STxRbGj" class="relative group/block"><h4 id="id-4-3-defining-working-folders" class="relative group"><span class="heading-text">4.3 Defining working folders</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-3-defining-working-folders" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="LexE5YNrBt" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">output_urban = &quot;output&quot;
urban_path = os.path.join(os.getcwd(), &quot;Poverty&quot;, output_urban)

# Create output dir
os.makedirs(urban_path, exist_ok=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gUIWQD_P9HzDNOdc-MP58" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="A0lGt2bnLL" class="relative group/block"><h4 id="id-4-4-visualizing-the-input-data" class="relative group"><span class="heading-text">4.4. Visualizing the input data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-4-visualizing-the-input-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><h5 id="query-the-stac-endpoint" class="relative group"><span class="heading-text">Query the STAC endpoint</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#query-the-stac-endpoint" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><ul><li>GRDI dataset and all its 6 forming components <a target="_blank" rel="noreferrer" href="https://github.com/ESA-eodashboards/eodashboard-catalog/tree/main/collections" class="">are part of the <strong>EO Dashboard data ecosystem</strong>: check the collections.</a> and explore them on the EO Dashboard:<a target="_blank" rel="noreferrer" href="https://eodashboard.org/explore/?x=-0.0917&amp;y=39.4096&amp;z=2.3242&amp;datetime=2010-01-01&amp;template=expert&amp;indicator=GRDI2" class="">GRDI</a>; <a target="_blank" rel="noreferrer" href="https://eodashboard.org/explore/?x=-0.0917&amp;y=39.4096&amp;z=2.3242&amp;datetime=2015-01-01&amp;template=expert&amp;indicator=GRDI1" class="">Builtup Area</a>; <a target="_blank" rel="noreferrer" href="https://eodashboard.org/explore/?x=5.9701&amp;y=49.2863&amp;z=3.5875&amp;datetime=2010-01-01&amp;template=expert&amp;indicator=GRDI8" class="">Child Dependency Ratio</a>; <a target="_blank" rel="noreferrer" href="https://eodashboard.org/explore/?x=-0.0917&amp;y=39.4096&amp;z=2.3242&amp;datetime=2015-01-01&amp;template=expert&amp;indicator=GRDI7" class="">Infant Mortality Rates</a>.</li><li>The data endpoint in this case is not public accessible, but NASA VEDA allows to use a Tile Endpoint, which enables to show interactive map without downloading the full raster (VEDA API handles S3 authentication). VEDA endpoint is used by <strong>EO Dashboard</strong> that directly interacts with the services provided by VEDA, e.g. like rendering the image.</li></ul></div><div id="rXI650SLHo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from pystac_client import Client

# STAC endpoint
stac_url = &quot;https://openveda.cloud/api/stac/&quot;
client = Client.open(stac_url)

# list available collections. 
# Uncomment below to see all collecions:
#collections = [c.id for c in client.get_collections()]
#print(collections[:])  # print all collections</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="P3legVQvQRKNF1C9ooqLS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="MKCDBwGEXL" class="relative group/block"><h5 id="selection-of-collection" class="relative group"><span class="heading-text">Selection of collection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#selection-of-collection" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><ul><li>Selecting which dataset to query</li></ul></div><div id="KbHte1vmEJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">collection_id = &quot;grdi-v1-raster&quot;
#collection_id =  &quot;grdi-v1-raster&quot; or &quot;grdi-vnl-slope-raster&quot; or  &#x27;grdi-vnl-raster&#x27; or grdi-v1-built&#x27;, &#x27;grdi-v1-raster&#x27;,&quot;grdi-vnl-slope-raster&quot; or</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CdUinDjO4270p2Zlji5La" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="rY3s2q4AWX" class="relative group/block"><h5 id="query-the-stac-endpoint-with-selected-collection" class="relative group"><span class="heading-text">Query the STAC Endpoint with selected collection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#query-the-stac-endpoint-with-selected-collection" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="wq3o3N2su1" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">search = client.search(collections=[collection_id], max_items=5)
items = list(search.items())

print(f&quot;Found {len(items)} items&quot;)

# Look at the first item
item = items[0]
print(&quot;Item ID:&quot;, item.id)
print(&quot;Assets:&quot;, item.assets.keys())

cog_url = item.assets[&quot;cog_default&quot;].href
print(&quot;Data endpoint: COG URL:&quot;, cog_url)

cog_url = item.assets[&quot;rendered_preview&quot;].href
print(&quot;Rendered preview:&quot;, cog_url)

cog_path = item.assets.get(&quot;cog_default&quot;, None)
if cog_path is None:
    raise ValueError(&quot;No COG asset found for this item!&quot;)

cog_path = cog_path.href
print(&quot;COG PATH:&quot;, cog_path)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XcF9qGLwP5A3n-FKkAq8Q" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Found 1 items
Item ID: povmap-grdi-v1_2010-01-01_2021-12-31
Assets: dict_keys([&#x27;cog_default&#x27;, &#x27;rendered_preview&#x27;])
Data endpoint: COG URL: s3://veda-data-store/grdi-v1-raster/povmap-grdi-v1_2010-01-01_2021-12-31.tif
Rendered preview: https://openveda.cloud/api/raster/collections/grdi-v1-raster/items/povmap-grdi-v1_2010-01-01_2021-12-31/preview.png?assets=cog_default&amp;rescale=0%2C100&amp;colormap_name=viridis
COG PATH: s3://veda-data-store/grdi-v1-raster/povmap-grdi-v1_2010-01-01_2021-12-31.tif
</span></code></pre></div></div></div><div id="JNREgVsefJ" class="relative group/block"><h5 id="preview-of-data" class="relative group"><span class="heading-text">Preview of data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#preview-of-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="vQg0vxvBMu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cog_preview_url = item.assets[&quot;rendered_preview&quot;].href

response = requests.get(cog_preview_url)
img = Image.open(BytesIO(response.content))

plt.figure(figsize=(8,6))
plt.imshow(img)
plt.axis(&quot;off&quot;)
plt.title(&quot;Rendered Preview&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wfILV_CIg4XNX-p9UCz5V" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/3a55d0e0e03245bca47340314550899e.png" alt="&lt;Figure size 800x600 with 1 Axes&gt;"/></div></div><div id="zwfnKe9C7n" class="relative group/block"><h5 id="tile-endpoint" class="relative group"><span class="heading-text">Tile Endpoint</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#tile-endpoint" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><ul><li>Using Tile endpoint since in this case S3 path is not public</li><li>The VEDA Tile endpoint generates Web Mercator map tiles from a Cloud-Optimized GeoTIFF (COG) for given z/x/y coordinates, applying optional resampling, band selection, colormap, and value rescaling.</li></ul></div><div id="kGPjGJZP3I" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Coordinates over India
lon, lat = 77.1025, 28.7041
zoom = 6

# Converts longitude and latitude into a tile in the Web Mercator grid
tile = mercantile.tile(lon, lat, zoom)

# Tile endpoint (which takes the COG and returns map tiles)
base_url = &quot;https://openveda.cloud/api/raster/cog/tiles/WebMercatorQuad&quot;

# Constructs the full url to request the tile image
tile_url = (
    f&quot;{base_url}/{tile.z}/{tile.x}/{tile.y}&quot;
    f&quot;?url={cog_path}&amp;resampling_method=nearest&amp;bidx=1&quot;
    f&quot;&amp;colormap_name=viridis&amp;rescale=0,100&quot;
)

# Request and plot the tile
response = requests.get(tile_url)
img = Image.open(BytesIO(response.content))

plt.imshow(img)
plt.axis(&quot;off&quot;)
plt.title(f&quot;GRDI - Zoomed to India (Zoom level: {zoom})&quot;)
plt.show()
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VYnb9aXiv_WHDxFhifa1-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/eodashboard-notebooks/build/11f78414fa778b25cd4e148f6cf87f3f.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><div id="q1eQgeiFby" class="relative group/block"><h4 id="id-4-4-comparing-two-cities-new-delhi-vs-gurugram" class="relative group"><span class="heading-text">4.4 Comparing two cities: New Delhi vs Gurugram</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-4-comparing-two-cities-new-delhi-vs-gurugram" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="dSl1NQ15Ao" class="relative group/block"><h5 id="definition-of-the-city-boundaries" class="relative group"><span class="heading-text">Definition of the city boundaries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#definition-of-the-city-boundaries" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><ul><li>Since we are comparing specifically the overall indicator of two distinct cities, we will try to focus on their admnistrative context</li><li>You can hand-draw your own coordinates, or downdload kml or shapefile for your AoI</li></ul></div><div id="ZD0l81T3DV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Coordinates for cities 
newdelhi_nd = Polygon([(77.05010024928556, 28.545329632240488),(77.06932632350431, 28.527232785401164),(77.12151138209806, 28.493443691269704),(77.11052505397306, 28.458436437649425),(77.15172378444181, 28.435494362127248),(77.19292251491056, 28.4463622814295),(77.20253555201994, 28.472923604842666),(77.19292251491056, 28.497064469025712),(77.23961440944181, 28.5043056518795),(77.28355972194181, 28.530852403411522),(77.31102554225431, 28.545329632240488),(77.28767959498869, 28.571866050451412),(77.32201187037931, 28.574278120363793),(77.35085098170744, 28.6032186447749),(77.34398452662931, 28.633356550416348),(77.36321060084806, 28.65505048508341),(77.32475845241056, 28.73214811494396),(77.34398452662931, 28.777897949422616),(77.25884048366056, 28.786323363598065),(77.23961440944181, 28.730943901281826),(77.23686782741056, 28.705652209939004),(77.19841567897306, 28.729739673745172),(77.17094985866056, 28.751413646301874),(77.11876480006681, 28.768268071318303),(77.10365859889494, 28.751413646301874),(77.06245986842619, 28.724922624860923),(77.02812759303556, 28.67914959345852),(77.01027480983244, 28.638177812503272),(77.00478164576994, 28.593572688482055),(77.01988784694181, 28.569453925238474),(77.05010024928556, 28.545329632240488)])
gurugram_nd = Polygon([(77.03636733912931, 28.552567500585084),(77.06795303248869, 28.526026218441455),(77.10777847194181, 28.493443691269704),(77.11464492701994, 28.43066381740982),(76.99928848170744, 28.389595287262374),(76.97319595241056, 28.388387148302826),(76.92650405787931, 28.334006651363715),(76.87981216334806, 28.359387683848297),(76.89079849147306, 28.400467918290314),(76.92238418483244, 28.478959338289766),(76.96844764838063, 28.48499472683416),(77.00827308783376, 28.50792605695689),(77.00415321478688, 28.540504110335135),(77.03636733912931, 28.552567500585084)])
#ballabgarh_nd = Polygon([(77.305, 28.390),(77.315, 28.385),(77.325, 28.375),(77.330, 28.365),(77.320, 28.355),(77.310, 28.350),(77.300, 28.355),(77.295, 28.365),(77.295, 28.375),(77.300, 28.385),(77.305, 28.390)])
#ghaziabad_nd = Polygon([(77.380, 28.670),(77.400, 28.660),(77.420, 28.645),(77.435, 28.625),(77.430, 28.605),(77.410, 28.590),(77.390, 28.595),(77.370, 28.610),(77.360, 28.630),(77.365, 28.650),(77.380, 28.670)])

# Creating a dictionary of the cities to loop through them later
polygons = {
    &quot;New Delhi&quot;: newdelhi_nd,
    &quot;Gurugram&quot;: gurugram_nd
}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PSMtHmbxFRVoJzoP0VsGW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QrgepT9vVt" class="relative group/block"><h5 id="fetch-cog-into-tile" class="relative group"><span class="heading-text">Fetch COG into tile</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#fetch-cog-into-tile" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><ul><li>Fetches COG map tiles for polygon-centered coordinates, crops them to the polygons, and overlays onto a Folium map</li></ul></div><div id="k9i30Dt0ge" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">
# This will fetch the map tile image of defined lon and lat and a cog_raster
def get_tile_image(lon, lat, zoom, cog_path, base_url):
    tile = mercantile.tile(lon, lat, zoom)
    url = (
        f&quot;{base_url}/{tile.z}/{tile.x}/{tile.y}&quot;
        f&quot;?url={cog_path}&amp;resampling_method=nearest&amp;bidx=1&quot;
        f&quot;&amp;colormap_name=viridis&amp;rescale=0,100&quot;
    )
    response = requests.get(url)
    img = Image.open(BytesIO(response.content)).convert(&quot;RGBA&quot;)
    return np.array(img), tile

# Crops the tile into defined polygon
def crop_to_polygon(img_array, tile, polygon):
    height, width = img_array.shape[:2]
    lon_ul, lat_ul = mercantile.ul(tile.x, tile.y, tile.z).lng, mercantile.ul(tile.x, tile.y, tile.z).lat
    lon_lr, lat_lr = mercantile.ul(tile.x+1, tile.y+1, tile.z).lng, mercantile.ul(tile.x+1, tile.y+1, tile.z).lat
    res_lon = (lon_lr - lon_ul) / width
    res_lat = (lat_lr - lat_ul) / height

    mask = np.zeros((height, width), dtype=bool)
    for i in range(height):
        for j in range(width):
            lat_p = lat_ul + i * res_lat
            lon_p = lon_ul + j * res_lon
            if polygon.contains(Point(lon_p, lat_p)):
                mask[i, j] = True
    img_array[~mask] = [0, 0, 0, 0]
    return img_array

# --- Settings ---
zoom = 8
#base_url = &quot;https://openveda.cloud/api/raster/cog/tiles/WebMercatorQuad&quot;
#cog_path = &quot;s3://veda-data-store/grdi-v1-raster/povmap-grdi-v1_2010-01-01_2021-12-31.tif&quot;
# cog_path= &quot;s3://veda-data-store/grdi-vnl-slope-raster/povmap-grdi-v1_VNL-slope_2012-01-01_2020-12-31.tif&quot;



# Loop through each city to get the tile crop and plot
m = folium.Map(location=[28.55, 77.13], zoom_start=11)

for city, polygon in polygons.items():
    # Get approximate center of polygon for fetching tile
    lon, lat = polygon.centroid.x, polygon.centroid.y
    img, tile = get_tile_image(lon, lat, zoom, cog_path, base_url)
    img = crop_to_polygon(img, tile, polygon)

    # Overlay image
    ul_lat, ul_lon = mercantile.ul(tile.x, tile.y, tile.z).lat, mercantile.ul(tile.x, tile.y, tile.z).lng
    lr_lat, lr_lon = mercantile.ul(tile.x+1, tile.y+1, tile.z).lat, mercantile.ul(tile.x+1, tile.y+1, tile.z).lng
    ImageOverlay(image=img, bounds=[[lr_lat, ul_lon], [ul_lat, lr_lon]], opacity=0.6).add_to(m)

    # Add border
    folium.Polygon(
        locations=[(lat, lon) for lon, lat in polygon.exterior.coords],
        color=&#x27;red&#x27; if city==&quot;New Delhi&quot; else &#x27;blue&#x27;,
        weight=6,  # &lt;-- thicker border
        fill=False
).add_to(m)

m</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dZkRIG6SUzBRY1CyeL2VK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="VUUrPKwKJ9" class="relative group/block"><h4 id="id-4-5-estimating-poverty-average-values-new-delhi-vs-gurugram" class="relative group"><span class="heading-text">4.5 Estimating poverty (average values): New Delhi vs Gurugram</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-5-estimating-poverty-average-values-new-delhi-vs-gurugram" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="DTAaZumjRI" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Fetch tile image 
def get_tile_image(lon, lat, zoom, cog_path, base_url):
    tile = mercantile.tile(lon, lat, zoom)
    url = (
        f&quot;{base_url}/{tile.z}/{tile.x}/{tile.y}&quot;
        f&quot;?url={cog_path}&amp;resampling_method=nearest&amp;bidx=1&quot;
        f&quot;&amp;colormap_name=viridis&amp;rescale=0,100&quot;
    )
    response = requests.get(url)
    img = Image.open(BytesIO(response.content))
    img_array = np.array(img).astype(float)

    # Rescale if tile is in 0-255
    if img_array.max() &gt; 100:
        img_array = img_array * (100.0 / 255.0)

    return img_array, tile

#  Generate boolean mask for each city/polygon
def polygon_mask(tile, polygon, img_shape):
    height, width = img_shape[:2]
    lon_ul, lat_ul = mercantile.ul(tile.x, tile.y, tile.z).lng, mercantile.ul(tile.x, tile.y, tile.z).lat
    lon_lr, lat_lr = mercantile.ul(tile.x+1, tile.y+1, tile.z).lng, mercantile.ul(tile.x+1, tile.y+1, tile.z).lat

    res_lon = (lon_lr - lon_ul) / width
    res_lat = (lat_lr - lat_ul) / height

    mask = np.zeros((height, width), dtype=bool)
    for i in range(height):
        for j in range(width):
            lon = lon_ul + j * res_lon
            lat = lat_ul + i * res_lat
            if polygon.contains(Point(lon, lat)):
                mask[i, j] = True
    return mask

# Compute average GRDI for each polygon
def compute_average_grdi(polygon, zoom=8):
    min_lon, min_lat, max_lon, max_lat = polygon.bounds
    tiles = list(mercantile.tiles(min_lon, min_lat, max_lon, max_lat, zoom))
    all_values = []

    for tile in tiles:
        lon = (mercantile.ul(tile.x, tile.y, tile.z).lng + mercantile.ul(tile.x+1, tile.y+1, tile.z).lng) / 2
        lat = (mercantile.ul(tile.x, tile.y, tile.z).lat + mercantile.ul(tile.x+1, tile.y+1, tile.z).lat) / 2

        img_array, tile = get_tile_image(lon, lat, tile.z, cog_path, base_url)

        mask = polygon_mask(tile, polygon, img_array.shape)
        all_values.extend(img_array[mask])

    return np.mean(all_values) if all_values else np.nan

</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="u1QzvQncJ7e1QtFC0XVLE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="fbHlPhFUDU" class="relative group/block"><h5 id="visualizing-averaged-values-by-city" class="relative group"><span class="heading-text">Visualizing averaged values by city</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualizing-averaged-values-by-city" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="KDCGXHuutP" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Compute averages
averages = {city: compute_average_grdi(poly, zoom) for city, poly in polygons.items()}

# Print results
for city, avg in averages.items():
    print(f&quot;Average GRDI for {city}: {avg:.2f}&quot;)

# Plot results
plt.figure(figsize=(6, 4))
plt.bar(averages.keys(), averages.values(), color=[&#x27;red&#x27;, &#x27;blue&#x27;])
plt.ylabel(&quot;Average GRDI Value&quot;)
plt.title(&quot;Average GRDI (Masked by Polygons)&quot;)
for i, v in enumerate(averages.values()):
    plt.text(i, v + 0.5, f&quot;{v:.1f}&quot;, ha=&#x27;center&#x27;, fontsize=10, fontweight=&#x27;bold&#x27;)
plt.ylim(0, max(averages.values()) * 1.2)
plt.show()
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0ueGR8N1cgMRjDzYSX73A" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Average GRDI for New Delhi: 51.64
Average GRDI for Gurugram: 52.01
</span></code></pre></div><img src="/eodashboard-notebooks/build/5f53792d40bf41a706911c897912e9cb.png" alt="&lt;Figure size 600x400 with 1 Axes&gt;"/></div></div><div id="OPKWP3QgRS" class="relative group/block"><h5 id="export-graph-results" class="relative group"><span class="heading-text">Export graph results</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#export-graph-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="EPsDaYXSGf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Sets location of output
output_file = os.path.join(urban_path, &quot;average_grdi.png&quot;)

# --- Plot bar chart and save ---
plt.figure(figsize=(6, 4))
plt.bar(averages.keys(), averages.values(), color=[&#x27;red&#x27;, &#x27;blue&#x27;])
plt.ylabel(&quot;Average Value&quot;)
plt.title(&quot;Average GRDI (Masked by Polygons)&quot;)
for i, v in enumerate(averages.values()):
    plt.text(i, v + 0.5, f&quot;{v:.1f}&quot;, ha=&#x27;center&#x27;, fontsize=10, fontweight=&#x27;bold&#x27;)
plt.ylim(0, max(averages.values()) * 1.2)

# Save figure
plt.savefig(output_file, dpi=300, bbox_inches=&#x27;tight&#x27;)
plt.close()
print(f&quot;Graph saved to: {output_file}&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="1gLbQ5d9dL8felR0qIClA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Graph saved to: /home/lubojr/2025-BiDS-EODashboard/notebook/Poverty/output/average_grdi.png
</span></code></pre></div></div></div><div id="YBqomgNph8" class="relative group/block"><h4 id="id-4-5-final-remarks" class="relative group"><span class="heading-text">4.5 Final remarks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-5-final-remarks" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="LHtrMAA3px" class="relative group/block"><p>Overall GRDI values are ‘mid’. Both New Delhi (51.6) and Gurugram (52) have GRDI values close to the middle on a 0–100 scale, <strong>suggesting relative deprivation &amp; proverty</strong> . Gurugram <strong>slightly higher than New Delhi, Gurugram’s average</strong> higher than New Delhi could <strong>indicate marginally worse development indicators</strong>, but the difference is small—so not necessarily a large practical difference.</p><p>However, other indicators might indicate a relatively different result.</p></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-2021">東城文柄. (2021). 地球観測衛星データの公衆衛生学への応用. In <i>横幹連合コンファレンス予稿集</i> (No. 0; Vol. 2021). 特定非営利活動法人　横断型基幹科学技術研究団体連合. <a target="_blank" rel="noreferrer" href="https://doi.org/10.11487/oukan.2021.0_B-4-4">10.11487/oukan.2021.0_B-4-4</a></li><li class="break-words" id="cite-https://doi.org/10.7927/3xxe-ap97">Center For International Earth Science Information Network-CIESIN-Columbia University. (2022). <i>Global Gridded Relative Deprivation Index (GRDI), Version 1</i>. Palisades, NY: NASA Socioeconomic Data. <a target="_blank" rel="noreferrer" href="https://doi.org/10.7927/3XXE-AP97">10.7927/3XXE-AP97</a></li></ol></div></section></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/eodashboard-notebooks/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/eodashboard-notebooks/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/external-notebooks/group1/2025-bids-eodashboard/notebook/urban-health-and-megacities","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true,"style":"/eodashboard-notebooks/build/custom-02a120986468e4374349a3c0a1289d42.css"},"nav":[],"actions":[],"projects":[{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-be0a09fdf5a46e3efaa55b331b0060c1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"PART 1: SUMMARY","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-2011f743867dcc9f3a804e552695e0e5.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/eodashboard-notebooks"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true,"style":"/eodashboard-notebooks/build/custom-02a120986468e4374349a3c0a1289d42.css"},"nav":[],"actions":[],"projects":[{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-be0a09fdf5a46e3efaa55b331b0060c1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"PART 1: SUMMARY","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-2011f743867dcc9f3a804e552695e0e5.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"page":{"version":2,"kind":"Notebook","sha256":"1ddd532c57f11b7de7dccbeb25ab365849636d2b46578e64fa0664764a3233b1","slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","location":"/external_notebooks/group1/2025-BiDS-EODashboard/notebook/Urban_Health_and_Megacities.ipynb","dependencies":[],"frontmatter":{"title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","content_includes_title":false,"kernelspec":{"name":"conda-env-eodashboardtutorial-eodashboardtutorial-tutorial-dashboards-py","display_name":"eodashboardtutorial-eodashboardtutorial-tutorial-dashboards","language":"python"},"github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","subject":"Notebook examples","numbering":{"title":{"offset":4}},"edit_url":"https://github.com/ESA-eodashboards/eodashboard-notebooks/blob/main/external_notebooks/group1/2025-BiDS-EODashboard/notebook/Urban_Health_and_Megacities.ipynb","thumbnail":"/eodashboard-notebooks/build/header-be0a09fdf5a46e3efaa55b331b0060c1.png","exports":[{"format":"ipynb","filename":"Urban_Health_and_Megacities.ipynb","url":"/eodashboard-notebooks/build/Urban_Health_and_Meg-6cc42139afb36e225183118069ae28ee.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/eodashboard-notebooks/build/header-be0a09fdf5a46e3efaa55b331b0060c1.png","alt":"Title","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sa3zDrP0yj","urlSource":"Intro/img/header.png"}],"key":"NGdgtp9WvJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Running environment:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LQV1msDcIE"}],"identifier":"running-environment","label":"Running environment:","html_id":"running-environment","implicit":true,"key":"gGEvtpErxB"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This notebook can be run by installing the provided Anaconda Python environment (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zrCmh3VuHW"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"notebook-env.yml","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"G2oPY6WfbA"}],"key":"JbqUeEtGpF"},{"type":"text","value":").","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"mr6PLyk5ae"}],"key":"YdfqEdXOQJ"}],"key":"pNtc6eryUZ"}],"key":"coj8jYYkb7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"USE CASE 1: Nighttime Lights","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DZzRYV9gxF"}],"identifier":"use-case-1-nighttime-lights","label":"USE CASE 1: Nighttime Lights","html_id":"use-case-1-nighttime-lights","implicit":true,"key":"Q8NFAEwGuG"},{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Creating nighttime light maps with color blending","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HS3RFVDjzg"}],"identifier":"creating-nighttime-light-maps-with-color-blending","label":"Creating nighttime light maps with color blending","html_id":"creating-nighttime-light-maps-with-color-blending","implicit":true,"key":"dAGf3WSAx2"}],"key":"qYOQ8XYYzK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This use case demonstrates how to create ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BAhHtdhrS3"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nighttime light variation maps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UXcQ0wPjFC"}],"key":"ddRu68AYik"},{"type":"text","value":" over a time interval (from 2019 to 2022) with additive color blending for studying the distribution of artificial lighting in urban and rural regions, offering insights into urbanization, infrastructure development, and socio-economic activity.\nThe Nighttime Light Levels indicator can be explored on the EO Dashboard by selecting the EXPLORE DATASETS mode and choosing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nDfEvGa0Ey"},{"type":"link","url":"https://eodashboard.org/explore?indicator=NTLU\u0026x=12142837.23019\u0026y=4137471.98879\u0026z=5.69238","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Night lights indicators","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q11keCHAs3"}],"urlSource":"https://eodashboard.org/explore?indicator=NTLU\u0026x=12142837.23019\u0026y=4137471.98879\u0026z=5.69238","key":"Yc6vGNhRHC"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sMMnkVH9Ds"}],"key":"kBZU7vg410"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The study has been carried out by Associate Professor ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PrZgzv4wUX"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"TOJO Bumpei","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hVkLiJhLae"}],"key":"omzQZSDQA9"},{"type":"text","value":" of the Institute of Global Studies (specializing in Geographic Information Systems) in collaboration with ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"alwHFVEyHc"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"JAXA","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"udQvAB46Ai"}],"key":"WZay6FhP5C"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wTFkq5iNIT"}],"key":"LMHFvHRX0T"}],"key":"EZuSeJWSdt"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/eodashboard-notebooks/build/night_india-60cb31650b891d290e3c30b5aa95fb2f.JPG","alt":"title","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iz41S9sftN","urlSource":"Nightlights/img/night_india.JPG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Example of a nighttime light map covering India during 2019-2022, representing areas where a decrease in nighttime light level occurred (indicating a presumed reduction in social activity) in red, and areas where an increase occurred (indicating a presumed increase in social activity) in blue.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lPPDyOQdhW"}],"key":"JOr0R4lQVw"}],"key":"jAneWEfOPt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.1 Input data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vnDYIaviyq"}],"identifier":"id-1-1-input-data","label":"1.1 Input data","html_id":"id-1-1-input-data","implicit":true,"key":"MnQbn6SnTK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Visible Infrared Imaging Radiometer Suite (VIIRS, onboard NASA Suomi NPP satellite).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vHs5AM7vzh"}],"key":"QwkUD9rDei"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Aggregation: data aggregated on a semi-annual basis (using median image generation) with 10-degree lat/lon (geographic) grid h-v tile as Geo Tiff files.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nKHsuDC5TF"}],"key":"FUMTyYt7u6"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The tiles are 2400 x 2400 pixels, with pixel size of 0.004166 degrees (~464 m at the equator).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qcVJx7G7Ze"}],"key":"RltXwyf1HV"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Spatial Resolution: (0.4 - 0.8) km.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"P9aR9sOdCi"}],"key":"JKPYjZc37B"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Metric: nighttime radiance (measured in watts per square centimeter per steradian, [W/cm²/sr]), which represents the brightness of artificial lighting.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QyHkuholyK"}],"key":"HAtC4QdDUm"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Data access: aggregated input data provided by Jaxa and available locally","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"K4fhqAbhOx"}],"key":"qpCHzLTrEm"}],"key":"wWhom93zNH"}],"key":"F89xrcCT2a"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"VIIRS 10-degree tile scheme","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gEKV29ZsZJ"}],"key":"NbIIqJ3rTq"}],"key":"WCx3BPLhJO"},{"type":"image","url":"/eodashboard-notebooks/build/VIIRS_tiling_scheme-b3c0231f0aeb82a42a1067bd4be546c0.jpg","alt":"VIIRS tiling scheme.JPG","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iF808gLkoK","urlSource":"Nightlights/img/VIIRS_tiling_scheme.jpg"}],"key":"IrQ4jSx6s1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.2 Importing Python libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ilDCUJr2Vt"}],"identifier":"id-1-2-importing-python-libraries","label":"1.2 Importing Python libraries","html_id":"id-1-2-importing-python-libraries","implicit":true,"key":"fjTNATdcAo"}],"key":"qBt6omeYqf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Import libraries\nimport os\nimport sys\nimport re\nimport numpy as np\nimport rasterio\nimport rioxarray as rxr\nimport subprocess\nfrom subprocess import Popen, PIPE\nimport tempfile\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nfrom PIL import Image\nimport json\nfrom ipyleaflet import Map, ImageOverlay, basemaps","key":"gzmi4mzorB"},{"type":"output","id":"OgHLIqXP7KWGYYkAkHMHp","data":[],"key":"HYVeQlg5np"}],"key":"OJvXTmWoWn"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.3 Defining working folders","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dTbakBLXwd"}],"identifier":"id-1-3-defining-working-folders","label":"1.3 Defining working folders","html_id":"id-1-3-defining-working-folders","implicit":true,"key":"CIqdRsv0WD"}],"visibility":"show","key":"lilM9PIHIm"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"input_dir = \"input\"\ninput_path = os.path.join(os.getcwd(), \"Nightlights\", input_dir)\n\noutput_urban = \"output\"\nurban_path = os.path.join(os.getcwd(), \"Nightlights\", output_urban)\n\n# Create output dir\nos.makedirs(urban_path, exist_ok=True)","visibility":"show","key":"uzFiCB9IF4"},{"type":"output","id":"Lw8ImxKD7pE6XGYs0GGB4","data":[],"visibility":"show","key":"gvd1eaQ0qV"}],"visibility":"show","key":"UGt1qpDOAH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.4 Visualizing input data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A2qgmRxiWS"}],"identifier":"id-1-4-visualizing-input-data","label":"1.4 Visualizing input data","html_id":"id-1-4-visualizing-input-data","implicit":true,"key":"RtOKktqYZV"}],"key":"OOEbekzAcX"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"pattern = re.compile(r\"h(\\d+)v(\\d+)_(\\d{4})_(\\d)H_median\\.tif\")\n\nfor root, _, files in os.walk(input_path):\n    grouped_files = {}\n    \n    # Grouping files by h and v\n    for file in files:\n        match = pattern.match(file)\n        if match:\n            h, v, year, H = match.groups()\n            key = (h, v)\n            if key not in grouped_files:\n                grouped_files[key] = []\n            grouped_files[key].append((year, H, os.path.join(root, file))) \n    \n    # Process files for plotting\n    for (h, v), file_group in grouped_files.items():\n        file_group\n\ntuplelist2dict = {c:{'year':a,'half':b} for a,b,c in file_group}\nsorted_dict = {}\n\ngrid_tile = None\nfor item in sorted(tuplelist2dict, key = lambda k: (tuplelist2dict[k]['year'], tuplelist2dict[k]['half'])):\n    sorted_dict.update({item:tuplelist2dict[item]})\n    grid_tile = item.split('/')[-1].split('_')[0]\n#print(sorted_dict)","visibility":"show","key":"RCKhFXxkdX"},{"type":"output","id":"K23XP-sF9jHvCJ-_bcabj","data":[],"visibility":"show","key":"lXbdLMcxOF"}],"visibility":"show","key":"B4yVfcYjbk"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_figures(figures, nrows = 1, ncols=1, factor = 1., clip_range = None, **kwargs):\n    fig, axeslist = plt.subplots(ncols=ncols, nrows=nrows, figsize=(15, 15))\n    for idx,file_name in enumerate(figures):\n        title = file_name.split('/')[-1]\n        title = title.replace(\"_median.tif\", \"\")\n        axeslist.ravel()[idx].imshow(np.clip(mpimg.imread(file_name)*factor, *clip_range), **kwargs) # cmap=plt.gray(), cmap='Greys'\n        axeslist.ravel()[idx].set_title(title)\n        axeslist.ravel()[idx].set_axis_off()\n    fig.suptitle(r'Median nighttime light level [$Wcm^{-2}sr^{-1}$]', fontsize=20)\n    #plt.tight_layout() \n\n    ","visibility":"show","key":"v24YBYPUWV"},{"type":"output","id":"tJaw2WH3JSsYdWJ4SyTLJ","data":[],"visibility":"show","key":"g0F7QH6ejT"}],"visibility":"show","key":"cGsRLr51c5"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_figures(sorted_dict, 4, 2, clip_range=(0,1), factor=100./255.)","visibility":"show","key":"GC0LRsLqIH"},{"type":"output","id":"HCYlDfe0sL5IEcZTgeYyS","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"825b81381eaebd4716b057f77b672bc4","path":"/eodashboard-notebooks/build/825b81381eaebd4716b057f77b672bc4.png"},"text/plain":{"content":"\u003cFigure size 1500x1500 with 8 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"OaRouzDfAq"}],"visibility":"show","key":"c7WWl4RNgO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.5 Applying color blending","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pM47AJ4z17"}],"identifier":"id-1-5-applying-color-blending","label":"1.5 Applying color blending","html_id":"id-1-5-applying-color-blending","implicit":true,"key":"LiMK27vgtw"}],"key":"Fd937lgBCo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Additive color blending involves mixing the primary colors of light, red (R), green (G), and blue (B), while adjusting their luminance levels. By manipulating the luminance of these colors, a wide range of hues can be achieved, with the key characteristic being that combining all three colors results in white.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yF4G4Rc1n5"}],"key":"vS2dKljQaT"}],"key":"l8Rb2S6tpf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Technique","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pcMcTNSctF"}],"key":"XpCT2hIqd3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"maximum pixel value of images for 2019 (brightest pixel values) is assigned to red (R)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QcB28bMMIU"}],"key":"HTOVL6has1"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"minimum pixel value of images for 2020-2021 (darkest pixel values) is assigned to green (G)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lFje9fYLng"}],"key":"UFkB6ozwhb"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"maximum pixel value of images for 2022 (brightest pixel values) is assigned to blue (B)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jqWPS9TTkC"}],"key":"a5casIifLa"}],"key":"myzOyFCup4"}],"key":"KJUiCSL7Ym"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cVohE19syN"}],"key":"ezIk1ZLY9m"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"regions where a decrease in nighttime light level occurred are displayed in red","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"S14YKsXgqU"}],"key":"cbefztURsZ"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"areas that experienced an increase (presumed to indicate an increase in social activity) are shown in blue","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CgacEA9NwM"}],"key":"VCXASn6hnF"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"regions where there was no significant change throughout the pandemic are displayed in a gradient from gray to white.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JvLiATcB95"}],"key":"T4GSU4Dviu"}],"key":"fNcldsEfGn"}],"key":"CPwvyxpz7d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pattern = re.compile(r\"h(\\d+)v(\\d+)_(\\d{4})_(\\d)H_median\\.tif\")\n\n\ndef read_and_preprocess(file):\n    with rasterio.open(file) as src:\n        img = src.read(1)\n        img = np.nan_to_num(img, nan=0)  # Replace NaNs with zeros\n        return img, src.profile\n\n    \ndef additive_blending(grouped_files):\n    # Process each group of files for blending\n    for (h, v), file_group in grouped_files.items():\n        # Initialize arrays to store the maximum and minimum values for each year\n        max_2019 = None\n        min_2020_2021 = None\n        max_2022 = None\n        \n        for year, H, file in file_group:\n            img, profile = read_and_preprocess(file)\n            \n            if year == '2019':\n                if max_2019 is None:\n                    max_2019 = img\n                else:\n                    max_2019 = np.maximum(max_2019, img)\n            elif year in ['2020', '2021']:\n                if min_2020_2021 is None:\n                    min_2020_2021 = img\n                else:\n                    min_2020_2021 = np.minimum(min_2020_2021, img)\n            elif year == '2022':\n                if max_2022 is None:\n                    max_2022 = img\n                else:\n                    max_2022 = np.maximum(max_2022, img)\n                                  \n    # Create the blended image using the specified blending technique\n    blended_img = np.zeros((max_2019.shape[0], max_2019.shape[1], 3), dtype=np.float32)\n    blended_img[:, :, 0] = max_2019.astype(np.float32)  # Red band: maximum of 2019\n    blended_img[:, :, 1] = min_2020_2021.astype(np.float32)  # Green band: minimum of 2020-2021 compared\n    blended_img[:, :, 2] = max_2022.astype(np.float32)  # Blue band: maximum of 2022\n    \n    return blended_img, profile        ","key":"w8zLvfgxLE"},{"type":"output","id":"LfA7ZJ_xHyvEJmKBTXZmz","data":[],"key":"LMBLIc5nM4"}],"key":"UkAFmkn0wC"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Grouping files per (h,v) tiles and years span\ngrouped_files = {}\nfor root, _, files in os.walk(input_path):\n    \n    \n    # Group files by h and v\n    for file in files:\n        match = pattern.match(file)\n        if match:\n            h, v, year, H = match.groups()\n            key = (h, v)\n            if key not in grouped_files:\n                grouped_files[key] = []\n            grouped_files[key].append((year, H, os.path.join(root, file)))\n\n\n# blending           \nblended_img, profile = additive_blending(grouped_files)","visibility":"show","key":"zOVbQxCeYu"},{"type":"output","id":"PzcsMlyv3Z2xs_YaCtCZn","data":[],"visibility":"show","key":"UFJgw2S0qH"}],"visibility":"show","key":"wtbUj56Sad"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.6 Employing “urban” stretch processing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jt3w1whkoE"}],"identifier":"id-1-6-employing-urban-stretch-processing","label":"1.6 Employing “urban” stretch processing","html_id":"id-1-6-employing-urban-stretch-processing","implicit":true,"key":"vMkYsvrE6l"}],"key":"oOKnJUXuHw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The purpose of the stretch processing is to emphasize the nighttime light level of each band (corresponding to 2019, 2020-21, and 2022), focusing on:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"McTBEmwTPN"}],"key":"EGs9DgGirF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"“urban” nighttime light levels: the display range of each band is adjusted to 25-1000 [watts·cm-2·sr-1], emphasizing brighter areas","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lVaFLrmA5J"}],"key":"de2J97KgOn"}],"key":"sOhfq0kkDK"}],"key":"GGu2E6VdVX"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Urban stretch processing: Emphasize brighter areas\ndef urban_stretch_processing(band):\n    min_val = 25\n    max_val = 1000\n    band = np.clip(band, min_val, max_val)\n    band = (band - min_val) / (max_val - min_val) * 255\n    return band.astype(np.uint8)\n\n# Apply urban stretch processing to each band\nblended_img[:, :, 0] = urban_stretch_processing(blended_img[:, :, 0])\nblended_img[:, :, 1] = urban_stretch_processing(blended_img[:, :, 1])\nblended_img[:, :, 2] = urban_stretch_processing(blended_img[:, :, 2])\n        \n# Update the profile for a 3-band image and set nodata value to None\nprofile.update(count=3, dtype=rasterio.uint8, nodata=None)","visibility":"show","key":"zMdzMQroxt"},{"type":"output","id":"k-Fv9BzRbffWrzye8MiAP","data":[],"visibility":"show","key":"Qvzi5lp64H"}],"visibility":"show","key":"qalVHBWFh2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.7 Plotting blended image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Crkw3GEa5a"}],"identifier":"id-1-7-plotting-blended-image","label":"1.7 Plotting blended image","html_id":"id-1-7-plotting-blended-image","implicit":true,"key":"QjyCLNraPO"}],"key":"vN5TCwpl0i"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_image(image, factor=1.0, clip_range = None, **kwargs):\n    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15, 15))\n    if clip_range is not None:\n        ax.imshow(np.clip(image * factor, *clip_range), **kwargs)\n    else:\n        ax.imshow(image * factor, **kwargs)\n    ax.set_xticks([])\n    ax.set_yticks([])\n\n\nplot_image(blended_img, factor=1.5/255., clip_range=(0,1))","visibility":"show","key":"yKjqCrwTU1"},{"type":"output","id":"wrhp9UYQ0KZBHDAwr2RSB","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f198eccc56d09718ec07ec34ee418bfc","path":"/eodashboard-notebooks/build/f198eccc56d09718ec07ec34ee418bfc.png"},"text/plain":{"content":"\u003cFigure size 1500x1500 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"YnfPLDTlMo"}],"visibility":"show","key":"CRFUHU4xLo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.8 Overlaying with an interactive map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jAR9tbj9WH"}],"identifier":"id-1-8-overlaying-with-an-interactive-map","label":"1.8 Overlaying with an interactive map","html_id":"id-1-8-overlaying-with-an-interactive-map","implicit":true,"key":"yfLjhWy73U"}],"key":"YsirwPafdV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Saving blended image as Cloud Optimized GeoTIFF","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ghdi0ZQoUl"}],"key":"srpdXuGo7w"}],"key":"wOjHb1ULaX"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Exporting output as COG file \nres_name = f\"Nighttimelevel_Urban_{grid_tile}_2019-2022.tif\"\noutput_cog = os.path.join(urban_path, res_name)\n\n\n# Write the blended image directly to a temporary file\nwith tempfile.NamedTemporaryFile(suffix=\".tif\") as temp_file:\n    with rasterio.open(temp_file.name, \"w\", **profile) as dst:\n        dst.write(blended_img[:, :, 0], 1)\n        dst.write(blended_img[:, :, 1], 2)\n        dst.write(blended_img[:, :, 2], 3)\n\n    subprocess.run([\n        \"gdal_translate\", \"-of\", \"COG\",\n        \"-co\", \"COMPRESS=DEFLATE\",\n        \"-co\", \"BLOCKSIZE=512\",\n        \"-co\", \"RESAMPLING=NEAREST\",\n        \"-co\", \"OVERVIEWS=IGNORE_EXISTING\",\n        temp_file.name,\n        output_cog\n    ])\n\nprint(f\"COG file saved as {output_cog}\")","visibility":"show","key":"BIkcnsvps0"},{"type":"output","id":"ngEiDC6a9kDwdSMh0Npi5","data":[{"name":"stdout","output_type":"stream","text":"Input file size is 2400, 2400\n0...10...20...30...40...50...60...70...80...90...100 - done.\nCOG file saved as /home/lubojr/2025-BiDS-EODashboard/notebook/Nightlights/output/Nighttimelevel_Urban_h25v06_2019-2022.tif\n"}],"visibility":"show","key":"VqrDzRIS9r"}],"visibility":"show","key":"w3kF3Sohxo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Extracting bounding-box coordinates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AXc4Uz0jR7"}],"key":"PrtHrPr2Qe"}],"key":"bNq7nNcrN3"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"p1 = Popen([\"gdalinfo\", \"-json\", output_cog, \"-mm\"], stdout=PIPE)\noutput = p1.communicate()[0]\ndec_out = output.decode('utf-8')\nj_str = json.loads(dec_out)\nbbox = j_str['cornerCoordinates']\nll = bbox['lowerLeft']  # SW coo\nur = bbox['upperRight'] # NE coo\ncenter = bbox['center']","visibility":"show","key":"weB0hoQ75U"},{"type":"output","id":"GULKefHaOFhrUBwRhWc_u","data":[],"visibility":"show","key":"FreGdMQ6u6"}],"visibility":"show","key":"pXH0o6c9UV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Adding alpha channel to the blended image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lw4MQSMP1R"}],"key":"bg8jvHs7zg"}],"key":"oBzbWeJNpB"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def almostEquals(a,b,thres=50):\n    return all(abs(a[i]-b[i])\u003cthres for i in range(len(a)))\n\n\nimage = Image.open(output_cog).convert('RGBA')\npixeldata = list(image.getdata())\n\n\nfor i,pixel in enumerate(pixeldata):\n    if almostEquals(pixel[:3], (0,0,0)):\n        pixeldata[i] = (0,0,0,0)\n\n\nimage.putdata(pixeldata)\npng_path = os.path.join(urban_path, res_name.replace(\".tif\",\".png\"))\nres = image.save(png_path)\n#os.path.abspath(res)\nabs_path = os.path.abspath(png_path)\nwork_dir = os.getcwd()\nid_ = work_dir.split('/')[2]\nbase_url = os.path.join('https://hub-otc-sc.eox.at/user',id_,'files')\n#base_url\nabs_path = '/'.join(abs_path.split('/')[3:])\nprint(abs_path)\nprint(base_url)\n#abs_path\nprint(os.path.join(base_url,abs_path))\n","visibility":"show","key":"pre1CrKc0Y"},{"type":"output","id":"pRRYj7Rq5DKjCnbShUBDT","data":[{"name":"stdout","output_type":"stream","text":"2025-BiDS-EODashboard/notebook/Nightlights/output/Nighttimelevel_Urban_h25v06_2019-2022.png\nhttps://hub-otc-sc.eox.at/user/lubojr/files\nhttps://hub-otc-sc.eox.at/user/lubojr/files/2025-BiDS-EODashboard/notebook/Nightlights/output/Nighttimelevel_Urban_h25v06_2019-2022.png\n"}],"visibility":"show","key":"gWuds92Zy5"}],"visibility":"show","key":"aOrSvERIrB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overlay with OpenStreetMap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QHeaIlvldK"}],"key":"QwwBlKmEPd"}],"key":"VnHxX4jjHX"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"m = Map(basemap=basemaps.CartoDB.DarkMatter, center=(center[1], center[0]), zoom=6)\nosm_url = os.path.join(base_url,abs_path)\nimage = ImageOverlay(url=osm_url,bounds=((ll[1], ll[0]), (ur[1], ur[0])))\nm.add_layer(image);\nm","visibility":"show","key":"AvFhVFeoOh"},{"type":"output","id":"OdeNf82c3c32O-Zgva6jC","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"5f502dc8811743f9aade5d476d452dee\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"Map(center=[25.0, 75.0], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title', 'zoom_out…","content_type":"text/plain"}}}],"visibility":"show","key":"qjmK7en0U5"}],"visibility":"show","key":"W1Ms8AYrCo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using additive color blending images to focus on urban areas in India, in particular the North-West part comprising New Delhi, Jaipur, Agra, Gwalior, ...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"buvpOV2u8h"}],"key":"NZAUCefTz6"}],"key":"Gk6JRAhgLC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.9 Alternative stretch processing approaches","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ld3bxX11ec"}],"identifier":"id-1-9-alternative-stretch-processing-approaches","label":"1.9 Alternative stretch processing approaches","html_id":"id-1-9-alternative-stretch-processing-approaches","implicit":true,"key":"OOFDTdUxPx"}],"key":"maDTxg3Zpd"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"“Rural” nighttime light levels: setting each band’s display range to 0-50 [Watts·cm-2·sr-1] to emphasize darker areas","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XSmt5eMG7t"}],"key":"upo7kJf8v6"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"For a broader focus (from rural to urban areas): applying a log10 transformation to the values of each band with a display range set to 0-3.6 (equivalent to 0-3981 [Watts·cm-2·sr-1])","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"f3Q8dtiu2O"}],"key":"N13cQfaVkw"}],"key":"HXVrGmAw28"}],"key":"X22gVUykXK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.10 Final remarks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KZlCDW0Mjh"}],"identifier":"id-1-10-final-remarks","label":"1.10 Final remarks","html_id":"id-1-10-final-remarks","implicit":true,"key":"Q9bnWvGeFo"}],"key":"dCBOTmqXBS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This product has been specifically designed for utilization by researchers in applied scientific fields.\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MsisWpkQB1"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Potential applications","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n8cCwX1PUE"}],"key":"qI7yAO5kkh"},{"type":"text","value":" are being explored in environmental and social issue studies, such as:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MuFOoCZ0Ex"}],"key":"i8rTBT5Nvw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"disaster recovery","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HKo9Igxm0f"}],"key":"gSlmwRI5E6"}],"key":"cpCuTGuG28"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"energy","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fIIb1w842q"}],"key":"OMWSLiZY8e"}],"key":"rnFqNvMm9v"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"urban land use changes","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Iyz2VGvAGV"}],"key":"FRHQT38SY8"}],"key":"dl7dYWlucr"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"conflicts","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wITzbLi2Z5"}],"key":"iaA3N9otKV"}],"key":"spbQwtT7pz"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"migration","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"a5SIIAXxgr"}],"key":"xRI6wmCwuO"}],"key":"CeOhPzLkfw"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"monitoring of illegal, unreported activities","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"dbhxvTyd1z"}],"key":"BIRVM0ypx8"}],"key":"sLJdVkrP59"}],"key":"FkZNcLYSeE"}],"key":"Gsx1oWLZLm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To learn more","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aAVh8b0PCB"}],"identifier":"to-learn-more","label":"To learn more","html_id":"to-learn-more","implicit":true,"key":"RV9hIvTAxS"}],"key":"nVy6db3PIs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The presented approach is often referenced in scientific and public health research. For example, Bunpei Tojo (2021) used Nightlights data in the study “Application of Earth observation satellite data to public health: Comparison of night light (VIIRS) and solar radiation (SGLI) and domestic COVID-19 epidemic,” presented at the 12th Federation of Science and Technology conference, to analyze the relationship between nighttime light intensity and public health factors.\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dgSpw3xKS1"},{"type":"cite","url":"https://doi.org/10.11487/oukan.2021.0_B-4-4","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"東城 (2021)","key":"GGtqdQFlWe"}],"kind":"narrative","label":"2021","identifier":"https://doi.org/10.11487/oukan.2021.0_B-4-4","enumerator":"1","key":"me9Im2YGpi"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4LI0pMz2y"}],"key":"vmLZbgKzPY"}],"key":"hEZJgvnPwd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"USE CASE 2: Air Pollution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eufZzhrHQD"}],"identifier":"use-case-2-air-pollution","label":"USE CASE 2: Air Pollution","html_id":"use-case-2-air-pollution","implicit":true,"key":"j2NijScJwx"},{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Monitoring NO2 concentrations over Northern India","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NR8ODd0nk3"}],"identifier":"monitoring-no2-concentrations-over-northern-india","label":"Monitoring NO2 concentrations over Northern India","html_id":"monitoring-no2-concentrations-over-northern-india","implicit":true,"key":"pWsVyvJnFH"}],"key":"MOUg6WWqaU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Air quality is poor across India, but especially poor in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZxzgqPs8lh"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Northern India","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zyJtDFHbiR"}],"key":"Q3djiiQrh8"},{"type":"text","value":" due to a mix of human activity and seasonal weather conditions:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GqgZoydlRK"}],"key":"hiyz551z9u"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Vehicle emissions","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vEy0XT8YCH"}],"key":"GyOWa5XP2d"},{"type":"text","value":": The city’s high population density results in heavy traffic and significant pollution from older and poorly maintained vehicles. Increased investment in mass transportation and stricter fuel efficiency enforcement could help mitigate these issues in future.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BTxmPwW2hs"}],"key":"v8xo7dcjz1"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Industrial and construction dust","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wEAop7nC01"}],"key":"CrrMEUY56M"},{"type":"text","value":": Industrial operations and ongoing construction projects release fine particulate matter into the air.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Dw6lk8Efgb"}],"key":"t9ymmuNObN"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Home heating","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HO7CKLH0QI"}],"key":"W3TnVb5DJA"},{"type":"text","value":": Coal, firewood, and diesel generator use can contribute to poor air quality.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RuRZpAw9It"}],"key":"eVYGAPrkza"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Weather patterns","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bOKluAh6b0"}],"key":"N1qjtMmI1O"},{"type":"text","value":": Chillier temperatures, low wind speeds, and heavy air trap pollutants close to the ground during colder months, worsening smog.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"e5dWhG6kUd"}],"key":"tJHoEI89QZ"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Crop stubble burning","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VMTae7wmHv"}],"key":"aHJTgTGL5J"},{"type":"text","value":": Farmers in neighboring states including Bihar, Haryana, and Uttar Pradesh burn agricultural waste, contributing to particulate pollution","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SEHQALpnEV"}],"key":"pUoVuTosfa"}],"key":"iMRPGXJJxO"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Combined, these factors create a toxic atmosphere. Air quality is particularly dangerous during the winter months, when weather conditions exacerbate pollution.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"itBkaBylkb"}],"key":"wg5iqjcGpa"}],"key":"FoRMS7tqNY"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/eodashboard-notebooks/build/Northern_India-air_p-c6c5212798c61ec9d4ecbb8efe813b70.JPG","alt":"title","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YGd4GrT4FL","urlSource":"Air_pollution/img/Northern_India-air_pollution.JPG"}],"key":"DqqdlYoF0D"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In particular, Delhi and large parts of North India experienced a significant ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OMrZ6eZw1l"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"air quality crisis towards the end of 2024","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tW8amOyYzo"}],"key":"QBAMvii25g"},{"type":"text","value":", with air quality reaching the “Severe” and “Hazardous” categories, leading to a public health emergency.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wB529puEPH"}],"key":"OsAJqxGFxR"}],"key":"AHiTI5HQRA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This use case aims at analyzing the air quality over North India, showing how to create a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XFd193MqNz"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"time series plot of mean tropospheric NO2 values","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SG5SQD8Nus"}],"key":"Ih8tp17Rpp"},{"type":"text","value":" accompanied by the standard deviation to assess the impact of the pollutant agent.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cr0ijdfrXw"}],"key":"ACAfGnoHJc"}],"key":"eYEOLOHk7E"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The tropospheric NO2 concetrations can be further explored on the EO Dashboard by selecting the ATMOSPHERE Theme and choosing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j14KuD7Pwz"},{"type":"link","url":"https://eodashboard.org/explore/?indicator=N1_NO2\u0026x=0.0000\u0026y=0.0000\u0026z=2.6812\u0026datetime=2025-06-23\u0026template=expert","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Air Quality (tropospheric NO2 concentrations)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KTJfShruPP"}],"urlSource":"https://eodashboard.org/explore/?indicator=N1_NO2\u0026x=0.0000\u0026y=0.0000\u0026z=2.6812\u0026datetime=2025-06-23\u0026template=expert","key":"K8F3pv9uCY"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v0g4tTdnIQ"}],"key":"QnUwlB0bDg"}],"key":"aQpqIyOTYZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.1 Input data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JXRCYpj0q4"}],"identifier":"id-2-1-input-data","label":"2.1 Input data","html_id":"id-2-1-input-data","implicit":true,"key":"C79ApQZYYK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Tropospheric nitrogen dioxide (NO2) measurements obtained by TROPOMI (multispectral imaging spectrometer) aboard ESA Sentinel-5 Precursor (S5P) satellite (part of the European Copernicus programme)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kYkOceUcHq"}],"key":"oDj4qI64ez"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Aggregation: data combined over 14 days for averaging out meteorological daily variability","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EAGRa0ervn"}],"key":"QYh36lTjg6"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Spectral bands: ultraviolet and visible (270–500 nm), near-infrared (675–775 nm) and shortwave infrared (2305–2385 nm)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JYRPfxXVxZ"}],"key":"IdeL18bNsa"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Resolution: (7 × 3.5) km","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yWSCWuZac8"}],"key":"Ale4q25NNH"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Metric: micromoles per square meter [μmol/m²], total number of molecules of NO2 within a column of the atmosphere","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dAg4IsKRaM"}],"key":"I8ciB0SREz"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Data access: aggregated data collection available on Sentinel Hub as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yafg5efAIE"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/data/byoc/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Bring Your Own COG (BYOC)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"l5YN5vIkUS"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/data/byoc/","key":"mprIFivrPC"},{"type":"text","value":" and accessed using Sentinel Hub APIs","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nCCjjf50vx"}],"key":"GHlaVMO64q"}],"key":"tRFUAHJVRf"}],"key":"XOZZkniSxn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.2 Importing Python libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PgkBBWHbqN"}],"identifier":"id-2-2-importing-python-libraries","label":"2.2 Importing Python libraries","html_id":"id-2-2-importing-python-libraries","implicit":true,"key":"OEfiSxqmu2"}],"key":"XOZwqccVgV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from oauthlib.oauth2 import BackendApplicationClient\nfrom requests_oauthlib import OAuth2Session\nimport subprocess\nimport json\nimport requests\nimport pandas as pd\nimport os \nimport IPython.display\nfrom datetime import datetime\nimport matplotlib.pyplot as plt\nfrom sentinelhub import BBox","key":"ars4PoGxzR"},{"type":"output","id":"Rr5TlLabmp3K06hpujn8n","data":[],"key":"cY3F4nuN10"}],"key":"A5M4w6I3Lg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.3 Visualizing the AoI (Gurugram, South-West of New Delhi)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nrxTcCrDhH"}],"identifier":"id-2-3-visualizing-the-aoi-gurugram-south-west-of-new-delhi","label":"2.3 Visualizing the AoI (Gurugram, South-West of New Delhi)","html_id":"id-2-3-visualizing-the-aoi-gurugram-south-west-of-new-delhi","implicit":true,"key":"QJhgwm0r8W"}],"key":"EJCe18uuKy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Gurugram coordinates\ntop_left_x =  76.9602268594042\ntop_left_y = 28.5355222251629\nbottom_right_x = 77.11128887112295 \nbottom_right_y = 28.394875392026698\n\nbbox = [   \n  top_left_x,\n  bottom_right_y,\n  bottom_right_x,\n  top_left_y\n        ]\n\n# Bbox EPSG\nbbox_epsg = 4326","key":"BeVqeCFTzS"},{"type":"output","id":"hIgJaocfeU8kDhr3AivvZ","data":[],"key":"K44bcMnZRl"}],"key":"WiJhy6Tw0G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plotting the bounding box on a map\n\nIPython.display.GeoJSON(BBox(bbox,crs=bbox_epsg).get_geojson())","key":"P9zyBdme77"},{"type":"output","id":"o4JmThgEoIuXRyLGZGX-c","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"coordinates\":[[[76.9602268594042,28.394875392026698],[76.9602268594042,28.5355222251629],[77.11128887112295,28.5355222251629],[77.11128887112295,28.394875392026698],[76.9602268594042,28.394875392026698]]],\"crs\":{\"properties\":{\"name\":\"urn:ogc:def:crs:EPSG::4326\"},\"type\":\"name\"},\"type\":\"Polygon\"}","content_type":"application/geo+json"},"text/plain":{"content":"\u003cIPython.display.GeoJSON object\u003e","content_type":"text/plain"}}}],"key":"mzcDD3QpPd"}],"key":"FNnBRCpVlQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.4 Using Sentinel Hub statistical API request to access NO2 data collection for the selected AoI","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WbLmHwZf18"}],"identifier":"id-2-4-using-sentinel-hub-statistical-api-request-to-access-no2-data-collection-for-the-selected-aoi","label":"2.4 Using Sentinel Hub statistical API request to access NO2 data collection for the selected AoI","html_id":"id-2-4-using-sentinel-hub-statistical-api-request-to-access-no2-data-collection-for-the-selected-aoi","implicit":true,"key":"CyZxEfWDeb"}],"key":"s1hZuIXJQN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The Statistical API (or shortly “Stats API”) enables to get statistics calculated based on satellite imagery without having to download images.\nIn the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jUHdoQFSZq"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Statistical API request","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"phGqaarrts"}],"key":"fo6EvCKdXb"},{"type":"text","value":", one can specify the following ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"swLx3qzzE1"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"inputs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AgOpVVfN2P"}],"key":"ENMIOIM7Hq"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ms0yAzR6G6"}],"key":"sHKYiOyrG9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"area of interest (AoI)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zgnU53Pvqh"}],"key":"TSouQSlue7"}],"key":"C6DDhnQiAe"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"time period","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"arkZXBBls8"}],"key":"ZPBBJ3uIw6"}],"key":"Ghl5UZqH8W"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"data collection","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iHatt3blak"}],"key":"NTUo9yLF9z"},{"type":"text","value":" data collection id info on the publicly accessible ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XBU7ZbhoKi"},{"type":"link","url":"https://esa-eodashboards.github.io/eodashboard-catalog/trilateral/catalog.json","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"STAC catalog","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hWtxWP2BUc"}],"urlSource":"https://esa-eodashboards.github.io/eodashboard-catalog/trilateral/catalog.json","key":"UHKugVHM23"},{"type":"text","value":" (it can be also be queried via the pystac library as in this ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"D1m81MIWS5"},{"type":"link","url":"https://eodashboard.org/notebook/?id=notebooks/eodashboard-stac-access/eodashboard-stac-access","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"example","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dhZ2pxQucI"}],"urlSource":"https://eodashboard.org/notebook/?id=notebooks/eodashboard-stac-access/eodashboard-stac-access","key":"hur1LOHRkI"},{"type":"text","value":")","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Qgex1gjKEc"}],"key":"nu5nfNdZbG"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"evalscript","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qWibNSmOrF"}],"key":"q80TwpYodt"},{"type":"text","value":" or “custom script” is a piece of Javascript code which defines how the satellite data shall be processed by Sentinel Hub and what values the service shall return (more info ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"P9uNf5y7Af"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/evalscript/v3/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"I8AHH9wbaK"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/evalscript/v3/","key":"HosnnyVCpV"},{"type":"text","value":")","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LOoFMzkSs2"}],"key":"N0k9Gl2hBL"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"statistics to be calculated","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ac224opFTx"}],"key":"RSTSzQnNe5"},{"type":"text","value":" are returned in the API response in a json format. Further details can be found on the corresponding ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RbHtJXnfrp"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/api/statistical/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"SH documentation","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rRm77A3VB9"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/api/statistical/","key":"DrVNvctFgo"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NRkM9Th6UE"}],"key":"bLaRNw6H3g"}],"key":"rn8DvzByji"}],"key":"z7TZxR9jzN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining Statistical API input parameters: AoI, time period, data collection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GQKhuLKB98"}],"identifier":"defining-statistical-api-input-parameters-aoi-time-period-data-collection","label":"Defining Statistical API input parameters: AoI, time period, data collection","html_id":"defining-statistical-api-input-parameters-aoi-time-period-data-collection","implicit":true,"key":"Pa91Lae4EJ"}],"key":"PEXibTjXd6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# AoI coordinates WGS84 (Gurugram)\nbbox = [   \n  top_left_x,\n  top_left_y,\n  bottom_right_x,\n  bottom_right_y,\n        ]\n\n# Time period\ndate_from = \"2024-11-01T00:00:00.000Z\"\ndate_to = \"2025-02-28T00:00:00.000Z\"\n\n# Data collection id\ndata_collection = \"byoc-972e67a7-2ca8-4bf6-964a-11fe772e3ac2\"","key":"DXApWKD1fi"},{"type":"output","id":"Bd9jADnqNN-n0Ril5DTnm","data":[],"key":"HVEawHs7cG"}],"key":"hCJwtMMavK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining Statistical API input parameters: custom script (evalscript)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LkyUf3oWLG"}],"identifier":"defining-statistical-api-input-parameters-custom-script-evalscript","label":"Defining Statistical API input parameters: custom script (evalscript)","html_id":"defining-statistical-api-input-parameters-custom-script-evalscript","implicit":true,"key":"QR3LiYzOxj"}],"key":"JNEopL9qlB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evalscript version 3 (V3) requires to specify two functions:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uhLe75CbGa"}],"key":"GjqLSZULrb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"setup: where you specify inputs and outputs.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"k2PRgpJcJT"}],"key":"oi48rCNzcL"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"evaluatePixel: which calculates the output values for each pixel.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N6HFS7dPf0"}],"key":"X15AWrFS2x"}],"key":"AYRkL7k5pZ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"evaluatePixel() function must, in addition to other output, always return also dataMask output.\nThis output defines which pixels are excluded from calculations.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aQzmNXRp0i"}],"key":"dvyrXsZGVC"}],"key":"UHUbwFAKnm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Evalscript\nevalscript=\"\"\"\n//VERSION=3\nfunction setup() {\n  return {\n    input: [{bands: [\"tropno2\",\"dataMask\"]}],\n    output: [\n      {\n      id: \"data\",\n      bands: 1,\n      sampleType: \"FLOAT32\"\n      },\n      {\n      id: \"dataMask\",\n      bands: 1\n      }]\n    }\n}\n\nfunction evaluatePixel(samples) {\n  let validValue = 1    // data sanitation\n  if (samples.tropno2 \u003e= 1e20 ){\n    validValue = 0\n    }\n  let index = samples.tropno2;\n  return {\n    data:  [index],\n    dataMask: [samples.dataMask * validValue]\n    }\n}\n\"\"\"","key":"Nb2NSR82Wf"},{"type":"output","id":"PWtyrg4lUyY05uxR0qw5C","data":[],"key":"w3JztHwsrl"}],"key":"ijUdMcRrW0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Building NO2 data request","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"evVaKtkag7"}],"identifier":"building-no2-data-request","label":"Building NO2 data request","html_id":"building-no2-data-request","implicit":true,"key":"b7u6bzAlMD"}],"key":"yBU8I5Ptkz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_req = {\n  \"input\": {\n    \"bounds\": {\n      \"bbox\": bbox\n    },\n    \"data\": [\n      {\n        \"dataFilter\": {},\n        \"type\": data_collection\n      }\n    ]\n  },\n  \"aggregation\": {\n    \"evalscript\": evalscript,\n    \"timeRange\": {\n      \"from\": date_from,\n      \"to\": date_to\n    },\n    \"aggregationInterval\": {\n      \"of\": \"P1D\"\n    },\n    \"width\": 100,\n    \"height\": 100\n  },\n  \"calculations\": {\n    \"default\": {}\n  }\n}\n","key":"nGssvV89cz"},{"type":"output","id":"xIw8qFn22LR3DXP0x5NsS","data":[],"key":"nBuDyipKpC"}],"key":"itYPQHymyl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setting credentials for accessing Sentinel Hub services","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xXIgM687NL"}],"identifier":"setting-credentials-for-accessing-sentinel-hub-services","label":"Setting credentials for accessing Sentinel Hub services","html_id":"setting-credentials-for-accessing-sentinel-hub-services","implicit":true,"key":"nQhc53FaNr"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"OAuth credentials to access SH services can be obtained by following the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FRs8Rpnlrg"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/api/overview/authentication/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"instructions","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"mHaf59fccX"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/api/overview/authentication/","key":"d3qtyRK8PU"},{"type":"text","value":" provided on the SH platform.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"j9zno5qMUK"}],"key":"UXq7vs1pOt"}],"key":"n5viwL8Abv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\n# Creating a session\nservice_url = \"https://services.sentinel-hub.com\" # SH services endpoint\n\n# OAuth Client configuration\nclient_id = os.environ.get(\"SH_CLIENT_ID\")\nclient_secret = os.environ.get(\"SH_CLIENT_SECRET\")\n\nclient = BackendApplicationClient(client_id=client_id)\noauth = OAuth2Session(client=client)\n\n# Get token for the session\ntoken_url = f\"{service_url}/oauth/token\" # Sentinel-Hub OAuth2 server token endpoint\ntoken = oauth.fetch_token(token_url=token_url,\n                          client_secret=client_secret)","key":"wdBsKVfkGE"},{"type":"output","id":"5HXj2qo0zlH7PHY-Vp3fW","data":[],"key":"tSBIhvalWB"}],"key":"cw4x8nyNeY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sending a POST request to SH Statistical API","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AkgrhCmxFn"}],"identifier":"sending-a-post-request-to-sh-statistical-api","label":"Sending a POST request to SH Statistical API","html_id":"sending-a-post-request-to-sh-statistical-api","implicit":true,"key":"xUqcJ8kM2L"}],"key":"w0v0VQzEDp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"stat_url = f\"{service_url}/api/v1/statistics\" # SH statistical API endpoint\nresp = oauth.post(stat_url,\n                  headers={\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},\n                  json=data_req)\n#print(resp.status_code, resp.text)\n","key":"V3SiOfhvnb"},{"type":"output","id":"lS38U6QSEwBkZs69uvXIJ","data":[],"key":"vPRZSP45UG"}],"key":"xrn79W7JyA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Parsing response and extracting relevant statistics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t75STPna1u"}],"identifier":"parsing-response-and-extracting-relevant-statistics","label":"Parsing response and extracting relevant statistics","html_id":"parsing-response-and-extracting-relevant-statistics","implicit":true,"key":"yuMNKCmCdN"}],"key":"JvciaNu3uW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extracting stats from timeseries data within the specified time interval\ndata_r = resp.json() # parsing response to json\ntime_axis = [datetime.strptime(entry[\"interval\"][\"from\"], \"%Y-%m-%dT%H:%M:%SZ\").strftime(\"%Y/%m/%d\") for entry in data_r[\"data\"]]\nmeans = [float(entry['outputs']['data']['bands']['B0']['stats']['mean']) for entry in data_r[\"data\"]]\nstd_devs = [float(entry['outputs']['data']['bands']['B0']['stats']['stDev']) for entry in data_r[\"data\"]]\nstd_upper = [m+s for (m,s) in zip(means, std_devs)]\nstd_lower = [m-s for (m,s) in zip(means, std_devs)]","key":"gpGy0R8bGu"},{"type":"output","id":"oO9tISxjCxD-pM7jRjtV_","data":[],"key":"VDyqapsY4f"}],"key":"PAgZTWhDzI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.5 Plotting the statistics for the NO2 timeseries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GNyVb8D7a5"}],"identifier":"id-2-5-plotting-the-statistics-for-the-no2-timeseries","label":"2.5 Plotting the statistics for the NO2 timeseries","html_id":"id-2-5-plotting-the-statistics-for-the-no2-timeseries","implicit":true,"key":"PoPUX5Ay3U"}],"key":"aAZMTCADSQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(20,10))\n# plot mean values \nplt.plot(time_axis, means, linestyle='solid', linewidth=2, color=\"black\", label=\"Mean Tropospheric NO2 values [umol/ m^2]\")\n\n# plot standard deviation error bars\nplt.errorbar(time_axis, means, yerr=std_devs, linestyle=\"-\")\n\nplt.title('Tropospheric NO2 Values over the AOI')\nplt.legend()\nfig.autofmt_xdate()\n\n# Saving plot\noutput_no2 = \"output\"\noutput_no2_path = os.path.join(os.getcwd(), \"Air_pollution\", output_no2)\nos.makedirs(output_no2_path, exist_ok=True)\nplt.savefig(os.path.join(output_no2_path, 'NO2_Gurugram.png'))\n\nplt.show()","key":"DQoAYas0Gw"},{"type":"output","id":"St07-oPaXhFD0veJlPkl6","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"67372d6fd9791368d098641b91b6fff1","path":"/eodashboard-notebooks/build/67372d6fd9791368d098641b91b6fff1.png"},"text/plain":{"content":"\u003cFigure size 2000x1000 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"RDNufNwVO7"}],"key":"uWprFZs1Wn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The plot shows a spike in NO2 concentration over Gurugram in December 2024, when the significant air quality crisis in Northern India has been reported.\nIn particular, it can be noticed that the standard deviation starts increasing over this month with respect to the preceding and subsequent  time interval.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G4dPRr1weM"}],"key":"TIQSh5QpcX"}],"key":"J6tBHKJpmU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.6 Final remarks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x3yYQjDRxZ"}],"identifier":"id-2-6-final-remarks","label":"2.6 Final remarks","html_id":"id-2-6-final-remarks","implicit":true,"key":"DoZjxrEgC5"}],"key":"YlSXIjJCgX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The analysis carried out in this use case demonstrates how the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mLnK6T254z"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sentinel-5 Precursor Copernicus mission","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nin3rMzwTt"}],"key":"Lh8s63QfAF"},{"type":"text","value":" represents an essential contribution to monitoring air quality and providing critical information to services and decision makers to safeguard the everyday life of citizens.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cUNUP0MSo7"}],"key":"svgKjl8a6b"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In addition to nitrogen dioxide, the Tropomi spectrometer can map a multitude of trace gases such as:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jDbQu5qK3R"}],"key":"IDFbWulnSW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"ozone","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kRnjPLm3B7"}],"key":"P9n6phWrqo"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"formaldehyde","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mbJsbXHj21"}],"key":"RkObK7YED5"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sulphur dioxide","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QsWBKj1vFV"}],"key":"ZViOVyrE8J"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"methane","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lflGQ4l6lk"}],"key":"Mg9hPN1yR9"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"carbon monoxide","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"slNrHAzXLn"}],"key":"tE8frFmS1C"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"aerosols","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eQjtXTJbgf"}],"key":"EdB4pLoMQP"}],"key":"KIrlqHPuES"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"all of which affect the air we breathe and therefore our ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OMG179050O"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"health","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YEJXgOPITL"}],"key":"h62YaEsjib"},{"type":"text","value":", and our ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MqfDpJJIyC"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"climate","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"esj5IKT2aX"}],"key":"jYIV7jYNz9"},{"type":"text","value":".","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KmYq2WiUby"}],"key":"EC4aUE51AS"}],"key":"Mi2r4Y1Rd5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"USE CASE 3: HEATWAVES","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZZdHfqlLPc"}],"identifier":"use-case-3-heatwaves","label":"USE CASE 3: HEATWAVES","html_id":"use-case-3-heatwaves","implicit":true,"key":"XtuTeWrD2T"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Analyzing Land Surface Temperature with GCOM-C ‘Shikisai’ Satellite Data from JAXA","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s35B0n1Im9"}],"identifier":"analyzing-land-surface-temperature-with-gcom-c-shikisai-satellite-data-from-jaxa","label":"Analyzing Land Surface Temperature with GCOM-C ‘Shikisai’ Satellite Data from JAXA","html_id":"analyzing-land-surface-temperature-with-gcom-c-shikisai-satellite-data-from-jaxa","implicit":true,"key":"yWSh9reAaH"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In this use case, we will explore ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eMUbZZifgq"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"GCOM (Global Change Observation Mission)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"opocf0hEN2"}],"key":"QGfnT7qtqN"},{"type":"text","value":" satellite data to analyze ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"q1W0YhfDuj"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Land Surface Temperature (LST)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"naH9Iu5kX9"}],"key":"zxZboyQCO6"},{"type":"text","value":". Specifically, we’ll look at data from the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"e01qZieIFJ"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"GCOM-C","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PrTz6FxICq"}],"key":"GFfu60yH4c"},{"type":"text","value":" satellite, which is part of the Japan Aerospace Exploration Agency’s (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LWTdXldDMB"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"JAXA","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ioKEZtpYPd"}],"key":"dam72AIoXB"},{"type":"text","value":") efforts to monitor global climate change. GCOM-C provides valuable information on various environmental factors, including temperature, vegetation, and water bodies, through its thermal infrared sensors.\nOur focus will be on studying the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VWPIsSIQYZ"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"heatwave","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gkLzJ3wamR"}],"key":"xgWsfEEb1L"},{"type":"text","value":" that occurred in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vi49scMlK0"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"New Delhi, India, in 2024","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FDwmXmwDPs"}],"key":"Xz1tt070hj"},{"type":"text","value":". In particular, the city experienced a significant temperature surge during the peak summer months. The temperature exceeded ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wMtyg1deul"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"45°C (113°F)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"x3QpQ15TfV"}],"key":"ggP20NBNCp"},{"type":"text","value":", causing severe disruptions to daily life, and raising concerns about the increasing frequency and intensity of heatwaves due to climate change.\nBy analyzing GCOM-C’s satellite data, we can better understand the spatial distribution of land surface temperature during that period.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Znns4n3cYu"}],"key":"YijVjt1pzO"},{"type":"image","url":"/eodashboard-notebooks/build/4cea597f3e78ea8f2da8950b64da3d78.jpeg","alt":"Title","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gFRk0yfmnJ","urlSource":"https://th-i.thgim.com/public/incoming/ifa6rc/article68228316.ece/alternates/LANDSCAPE_1200/07_Standalone_Hot_Weather_Mirage_29_05_Delhi.jpg"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The July LST can be further explored on the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yIHIWfw1FP"},{"type":"link","url":"https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json\u0026x=1.4778\u0026y=9.5915\u0026z=4.0973\u0026datetime=2018-07-20\u0026indicator=GCOM_global_monthly","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"EO Dashboard ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"T59QMI4FKh"}],"urlSource":"https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json\u0026x=1.4778\u0026y=9.5915\u0026z=4.0973\u0026datetime=2018-07-20\u0026indicator=GCOM_global_monthly","key":"wdZjQwi275"},{"type":"text","value":".","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"x5bZmN6j9b"}],"key":"wc7IeCGIRx"}],"key":"kuy7hiYX4E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.1 Input data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ALZ5LVrFGF"}],"identifier":"id-3-1-input-data","label":"3.1 Input data","html_id":"id-3-1-input-data","implicit":true,"key":"hycHjJqhEm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Aggregation: Monthly ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BwQ7NSuGbV"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"averaged global dataset for July 2024","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hSKtHppqLM"}],"key":"Yso8KYbrqi"},{"type":"text","value":" (daytime measurements)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NTXKFC51Ni"}],"key":"pzIg7HQzO6"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Variable: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EGD0tUNNxT"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Land Surface Temperature (LST)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sC4vSTC1ks"}],"key":"ssFdtxL4KT"},{"type":"text","value":" (which is a Level-2 product, calculating from two thermal infrared (TIR) bands  two TIR bands (10.8 µm \u0026 12.0 µm) using a hybrid split-window + semi-analytical algorithm that accounts for emissivity and atmospheric effects.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"A0HJCx2B1m"}],"key":"EGA0cDBTj4"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Spatial coverage: spatial coordinates 0°–90° East and 0°–90° North.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AFnb7okEZp"}],"key":"gpEl9jRNY3"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Resolution: Approximately 1 km (spatial resolution of SGLI Level 3 products).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Br4jlSuXRG"}],"key":"zh9M0CMKBo"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Metric (units): Kelvin (°K) with scale factor of ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oJeI1jHY0E"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"0.02","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qY5Iyt43SB"}],"key":"BJZHdrCfhf"},{"type":"text","value":", since: K = DN*0.02.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mh04xu9g28"}],"key":"tvRzNXglmG"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dataset documentation: ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"W4I1PC3q2Q"},{"type":"link","url":"https://suzaku.eorc.jaxa.jp/GCOM_C/data/ATBD/ver2/V2ATBD_T4A_LST_Moriyama_r1.pdf","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"https://​suzaku​.eorc​.jaxa​.jp​/GCOM​_C​/data​/ATBD​/ver2​/V2ATBD​_T4A​_LST​_Moriyama​_r1​.pdf","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"R3a7HovNZq"}],"urlSource":"https://suzaku.eorc.jaxa.jp/GCOM_C/data/ATBD/ver2/V2ATBD_T4A_LST_Moriyama_r1.pdf","key":"TeC6UJp0o9"}],"key":"Ys4pDe5cjH"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"DOI: 10.57746/EO.01gs73bfs5sbzhyxg4j9ytajsa","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"mgTZd4hOHq"}],"key":"gt8aLaPuxB"}],"key":"bBFtFt8lOp"}],"key":"SnjnNS9hYl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.2 Import libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BLEgTRPUFb"}],"identifier":"id-3-2-import-libraries","label":"3.2 Import libraries","html_id":"id-3-2-import-libraries","implicit":true,"key":"xbDTVCLDVo"}],"key":"rAo3Zh0yEr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport geopandas as gpd\nimport rasterio\nfrom rasterio.mask import mask\nimport matplotlib.pyplot as plt\nfrom osgeo import gdal\nimport requests\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom osgeo import gdal\nfrom matplotlib.colors import LinearSegmentedColormap\nimport matplotlib.patches as patches\nimport matplotlib.colors as mcolors","key":"T4AwuL8t1b"},{"type":"output","id":"JyKl2WPF56XcSAD-Oy229","data":[],"key":"Eo5bHHiLGO"}],"key":"j2zWgtweg9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3 Defining working folders","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hlJInezYIo"}],"identifier":"id-3-3-defining-working-folders","label":"3.3 Defining working folders","html_id":"id-3-3-defining-working-folders","implicit":true,"key":"KHwsVeMOiD"}],"key":"QiR0abSXXh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"output_urban = \"output\"\nurban_path = os.path.join(os.getcwd(), \"Heatwaves\", output_urban)\n\n# Create output dir\nos.makedirs(urban_path, exist_ok=True)","key":"nvJrg2Sp2w"},{"type":"output","id":"lqFzjrNXNwa84ViY3FnLg","data":[],"key":"j7BF6fjz9T"}],"key":"ottG74jyob"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.4 Visualizing input dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VjkzuEaHTM"}],"identifier":"id-3-4-visualizing-input-dataset","label":"3.4 Visualizing input dataset","html_id":"id-3-4-visualizing-input-dataset","implicit":true,"key":"j9ohLWWhzz"}],"key":"RfwocQnPIr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Saving dataset locally from data endpoint","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lR5mYvccyf"}],"identifier":"saving-dataset-locally-from-data-endpoint","label":"Saving dataset locally from data endpoint","html_id":"saving-dataset-locally-from-data-endpoint","implicit":true,"key":"H3bIh9g5lt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This URL (data endpoint) contains a GeoTIFF file from LST and ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yh8urXmrU7"},{"type":"link","url":"https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json\u0026x=1.4778\u0026y=9.5915\u0026z=4.0973\u0026datetime=2018-07-20\u0026indicator=GCOM_global_monthly","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"it’s part of the EO Dashboard data ecosystem","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HP8UbqzyOt"}],"key":"bxeOHHQRDi"}],"urlSource":"https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json\u0026x=1.4778\u0026y=9.5915\u0026z=4.0973\u0026datetime=2018-07-20\u0026indicator=GCOM_global_monthly","key":"zkB2Eh8Vwq"}],"key":"h7mPEaANdR"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Dataset originally was generated in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q7Hq7yqzGW"},{"type":"link","url":"https://data.earth.jaxa.jp/en/datasets/#/id/JAXA.G-Portal_GCOM-C.SGLI_standard.L3-AROT.daytime.v3_global_daily","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"JAXA’s G-Portal","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iELy1yKAzb"}],"urlSource":"https://data.earth.jaxa.jp/en/datasets/#/id/JAXA.G-Portal_GCOM-C.SGLI_standard.L3-AROT.daytime.v3_global_daily","key":"UG8JQECQoR"},{"type":"text","value":" and JAXA provides direct access to this and other COGs through their Earth API","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cLdl6QJuTX"}],"key":"YrJEV059w9"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"While these COGs differ between Level 0 and Level 1 data (meaning it is not yet possible to create composite layers), the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LmvM5kCGu0"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"EO Dashboard","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OrY2koSsAz"}],"key":"hsEIeVqhWL"},{"type":"text","value":" allows integration of raw Level 1 COGs hosted by JAXA (","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"A088WhIaWo"},{"type":"link","url":"https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json\u0026x=1.4778\u0026y=9.5915\u0026z=4.0973\u0026datetime=2018-07-20\u0026indicator=GCOM_global_monthly","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"example","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XK4BEdfNGQ"}],"urlSource":"https://eodash.github.io/preview-instance/?stacEndpoint=https%3A%2F%2Fesa-eodashboards.github.io%2Feodashboard-catalog%2Fpr-preview%2Fpr-80%2Ftrilateral%2Fcatalog.json\u0026x=1.4778\u0026y=9.5915\u0026z=4.0973\u0026datetime=2018-07-20\u0026indicator=GCOM_global_monthly","key":"UQbztULL4L"},{"type":"text","value":")","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wfWizLgacf"}],"key":"DmbHdnKgm8"}],"key":"tBj4SdIVlh"}],"key":"PlL50vm0K3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Data endpoint\nurl = \"https://s3.ap-northeast-1.wasabisys.com/je-pds/cog/v1/JAXA.G-Portal_GCOM-C.SGLI_standard.L3-LST.daytime.v3_global_monthly/2024-07/1/E000.00-E090.00/E000.00-N00.00-E090.00-N90.00-LST.tiff\"\n# Downloads the file from the URL\nresponse = requests.get(url)\n# Saves file locally \nwith open(\"Heatwaves/LST.tiff\", \"wb\") as f:\n    f.write(response.content)","key":"Sb5MaxlQAy"},{"type":"output","id":"HqjfBOEU98pL2R9H2DxTG","data":[],"key":"aI2Q3ZALHm"}],"key":"IOV7frznyE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hZ3mQAHkSx"}],"identifier":"plot-the-image","label":"Plot the image","html_id":"plot-the-image","implicit":true,"key":"omO2UX07Cd"}],"key":"dwB1EpWSQv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Opening the file with GDAL (library for geospatial raster data)\nds = gdal.Open(\"Heatwaves/LST.tiff\")\n# Gests the first (and in this case) only band refering to LST.\nband = ds.GetRasterBand(1)\n#Reads the raster into a NumPy array (a sort of matrix)\narr = band.ReadAsArray().astype(float)\n\n# Plotting\nimport matplotlib.pyplot as plt\nplt.imshow(arr, cmap=\"viridis\")\nplt.colorbar()\nplt.title(\"LST\")\nplt.show()\n\nprint(' - - - ')\nprint('Aditional information about the dataset:')\nprint(' - - - ')\nprint(ds.GetProjection(), ds.GetGeoTransform())\n","key":"t3IXu5KTIX"},{"type":"output","id":"sKcRlz0nmR8-kKZJMujxK","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d02536bc5ff9e1c0b153e66b17be6474","path":"/eodashboard-notebooks/build/d02536bc5ff9e1c0b153e66b17be6474.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":" - - - \nAditional information about the dataset:\n - - - \nGEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AXIS[\"Latitude\",NORTH],AXIS[\"Longitude\",EAST],AUTHORITY[\"EPSG\",\"4326\"]] (0.0, 0.025, 0.0, 90.0, 0.0, -0.025)\n"}],"key":"mfUJLtAwNj"}],"key":"r85Z2PdZbJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.4 Converting to Celsius Degrees and clean unvalid pixels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cyMI0NDBhS"}],"identifier":"id-3-4-converting-to-celsius-degrees-and-clean-unvalid-pixels","label":"3.4 Converting to Celsius Degrees and clean unvalid pixels","html_id":"id-3-4-converting-to-celsius-degrees-and-clean-unvalid-pixels","implicit":true,"key":"X30Q5ebeNn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The JAXA GCOM-C SGLI L3 LST had a 0.02 scalling factor and was in Kelvin.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fuBFpmq3Hf"}],"key":"ThK7qezMIM"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Removing values of pixels (consider them as NaN)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hCP89Q0gdN"}],"key":"i0t4a4Cm2l"}],"key":"BBkkvOV032"}],"key":"sqc3qYTwpq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Now we mask invalid or unrealistic values (sometimes satellite data have artifacts or other issues that render the value of a pixel wrong)\narr[(arr \u003c= 0) | (arr \u003e 35000)] = np.nan\n\n# Re-scale and convert from Kelvin to Celsius\narr_c = arr * 0.02 - 273.15  ","key":"qzK5jF4VRD"},{"type":"output","id":"jGgFyYfUCgU0CcluAQHq5","data":[],"key":"hk29t30fdB"}],"key":"snNS2XSgr6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.4 Croping to areas of interest: Northern India and New Dehli","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s55krnPdDJ"}],"identifier":"id-3-4-croping-to-areas-of-interest-northern-india-and-new-dehli","label":"3.4 Croping to areas of interest: Northern India and New Dehli","html_id":"id-3-4-croping-to-areas-of-interest-northern-india-and-new-dehli","implicit":true,"key":"cnJ7dFoV9R"}],"key":"umNh7CeUyT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining locations of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CAmEC3ifUK"}],"identifier":"defining-locations-of-interest","label":"Defining locations of interest","html_id":"defining-locations-of-interest","implicit":true,"key":"xtJIVzeuZE"}],"key":"lNwFGfdMCZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# GeoTransform is a GDAL function that helps map between the raster coordinates and georeference coordinates\n# In other words it is converting geographic coordinates (lat, lon) into pixel coordinates of our matrix (X, y)\ngt = ds.GetGeoTransform()\ndef latlon_to_pixel(lat, lon, gt):\n    px = int((lon - gt[0]) / gt[1])\n    py = int((lat - gt[3]) / gt[5])\n    return px, py\n\n# Now we use this function to get the pixel coordinates of an area around Northern India \nlon_min, lon_max = 70, 90\nlat_min, lat_max = 20, 37\npx_min, py_max = latlon_to_pixel(lat_min, lon_min, gt)\npx_max, py_min = latlon_to_pixel(lat_max, lon_max, gt)\n# 'Bounding box of northern India'\narr_crop_india = arr_c[py_min:py_max, px_min:px_max]\n\n# We do the same for New Dehli\nlon_min, lon_max = 76.8, 77.5\nlat_min, lat_max = 28.4, 28.9\npx_min2, py_max2 = latlon_to_pixel(lat_min, lon_min, gt)\npx_max2, py_min2 = latlon_to_pixel(lat_max, lon_max, gt)\narr_crop_delhi = arr_c[py_min2:py_max2, px_min2:px_max2]","key":"ZjLCjQIfBG"},{"type":"output","id":"5Czq2gyUyBYAX2Qcj85ZK","data":[],"key":"FgLfA6Jhj8"}],"key":"hHV4YXHz5H"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X8n5TCvoe9"}],"identifier":"plotting-results","label":"Plotting results","html_id":"plotting-results","implicit":true,"key":"EwC9kWnElX"}],"key":"xIgfwEiHHa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Selecting the color scheme \ncmap = \"plasma\"  \n\n# Settlings to ensure we have 2 plots, side by side\nfig, axes = plt.subplots(1, 2, figsize=(14, 6))\nvmin, vmax = 27, 50  \n\n# \nim1 = axes[0].imshow(arr_crop_india, cmap=cmap, vmin=vmin, vmax=vmax)\naxes[0].set_title(\"LST (°C) - Northern India\")\ncbar1 = fig.colorbar(im1, ax=axes[0], orientation=\"horizontal\", fraction=0.046, pad=0.08)\ncbar1.set_label(\"LST (°C)\")\n\n# Mark New Delhi on Northern India map\ndelhi_lat, delhi_lon = 28.61, 77.21\npx_delhi, py_delhi = latlon_to_pixel(delhi_lat, delhi_lon, gt)\npx_delhi_rel = px_delhi - px_min\npy_delhi_rel = py_delhi - py_min\naxes[0].scatter(px_delhi_rel, py_delhi_rel, color=\"red\", s=40, marker=\"o\")\naxes[0].text(px_delhi_rel + 5, py_delhi_rel - 5, \"New Delhi\", color=\"white\",\n             fontsize=10, weight=\"bold\", backgroundcolor=\"black\")\n\n# Plot side-by-side\nim2 = axes[1].imshow(arr_crop_delhi, cmap=cmap, vmin=vmin, vmax=vmax)\naxes[1].set_title(\"LST (°C) - New Delhi (Cropped and zoomed it)\")\ncbar2 = fig.colorbar(im2, ax=axes[1], orientation=\"horizontal\", fraction=0.046, pad=0.08)\ncbar2.set_label(\"LST (°C)\")\n\nplt.tight_layout()\nplt.show()","key":"xCZYJIm1r9"},{"type":"output","id":"nZL3OSz9TSwNCw3mVDfoJ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8c4ee3ee3fdb8cd666a6987e0b7b9df7","path":"/eodashboard-notebooks/build/8c4ee3ee3fdb8cd666a6987e0b7b9df7.png"},"text/plain":{"content":"\u003cFigure size 1400x600 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"gIyVeGZv39"}],"key":"A4aI4XOxBR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.5 Identifying locations where Heatwave has occured in June 2024","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oeXpAy6l1H"}],"identifier":"id-3-5-identifying-locations-where-heatwave-has-occured-in-june-2024","label":"3.5 Identifying locations where Heatwave has occured in June 2024","html_id":"id-3-5-identifying-locations-where-heatwave-has-occured-in-june-2024","implicit":true,"key":"zWSgQpn19e"},{"type":"heading","depth":6,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Defiyning the threshold:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GnJizCP2uu"}],"identifier":"defiyning-the-threshold","label":"Defiyning the threshold:","html_id":"defiyning-the-threshold","implicit":true,"key":"pqSiUT3H29"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Applying a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DcpRhmnX5j"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"threshold","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JqdJQEPceE"}],"key":"dQ4ryw9Dok"},{"type":"text","value":" (temperature limit from which it’s considered to be a ‘heatwave’): ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RYYy9yUnYY"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"40","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"plmLXBOCsM"}],"key":"iGCFMvSlqh"}],"key":"mLsHgVzeBi"}],"key":"pQvGcj5WeD"}],"key":"x2jslNo8uo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"threshold = 40","key":"bISpWx26de"},{"type":"output","id":"UDXjMj47XaeTPe__5PZmj","data":[],"key":"LIdXz6YLj8"}],"key":"kETNu1nVwC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Selecting the AoI","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"imGiN2XWfD"}],"identifier":"selecting-the-aoi","label":"Selecting the AoI","html_id":"selecting-the-aoi","implicit":true,"key":"dmPLfPimG2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"From before we defined New Delhi ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jhmbp4RDH0"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"arr_crop_delhi","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Y4ADLC6fqi"}],"key":"EHV6MqPAGO"},{"type":"text","value":" or northern india ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pg8F5WCL54"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"arr_crop_india","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"v9MlIhflxt"}],"key":"yuBE3HDNGK"}],"key":"S3w2LwGV16"}],"key":"qnkkIxz1qM"}],"key":"hKaJcSuFIP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"arr_view = arr_crop_delhi","key":"NNdfyZIdjm"},{"type":"output","id":"gat0xWy4ubHpgcTxvdBnf","data":[],"key":"x9JxwHMQlW"}],"key":"fsvhQN4vwj"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Creating a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OCbhXPde6N"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mask","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ybuZD8AQar"}],"key":"Hqw7OFYUr0"},{"type":"text","value":" with that value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YdcEQ1fn5C"}],"key":"OeNu8Hpllh"}],"key":"tT8irzvImk"}],"key":"DduxmHClNJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a colormap from plasma\nbase_cmap = plt.cm.plasma\nnewcolors = base_cmap(np.linspace(0, 1, 256))\nvmin, vmax = 27, 49\n\n# Create a ListedColormap\ncmap = mcolors.ListedColormap(newcolors)\n\n# Create a mask for values \u003e threshold\narr_masked = np.where(arr_view \u003e threshold, np.nan, arr_view)\n\n# Plot\nfig, ax = plt.subplots(figsize=(12, 9))\nim = ax.imshow(arr_masked, cmap=cmap, vmin=vmin, vmax=vmax)\n\n# Overlay black for pixels \u003e threshold\nax.imshow(np.where(arr_view \u003e threshold, 1, np.nan), cmap=mcolors.ListedColormap([[0,0,0,1]]))\n\n# Colorbar\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", fraction=0.046, pad=0.08)\ncbar.set_label(\"LST (°C)\")\ncbar.ax.text(0.99, -0.99, f\"\u003e{threshold}°C = black = heatwave location\", color=\"black\",\n             fontsize=12, ha='center', va='center', transform=cbar.ax.transAxes)\n\n# Title\nax.set_title(\"LST (°C) July Average Land Surface Temperatures\", fontsize=16)\n\n\n# Only show New Delhi if arr_view is arr_crop_india\nif 'arr_crop_india' in globals() and arr_view is arr_crop_india:\n    ax.scatter(px_delhi_rel, py_delhi_rel, color=\"red\", s=100, marker=\"X\")\n    circle = patches.Circle((px_delhi_rel, py_delhi_rel), radius=40,\n                            edgecolor='red', facecolor='none', linewidth=2.5)\n    ax.add_patch(circle)\n    ax.text(px_delhi_rel + 50, py_delhi_rel - 15, \"New Delhi\",\n            color=\"white\", fontsize=10, weight=\"bold\", backgroundcolor=\"black\")\n\n\nplt.tight_layout()\nplt.show()\n","key":"JcUN7xMXj2"},{"type":"output","id":"f4GbH66W_n1tNZoEyCjwm","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8d2d6eb30ae78ccbae39b94ecc56ea29","path":"/eodashboard-notebooks/build/8d2d6eb30ae78ccbae39b94ecc56ea29.png"},"text/plain":{"content":"\u003cFigure size 1200x900 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"XheQFoT7uq"}],"key":"HWxoRkv2Ce"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.6 Calculating areas (sqkm) affected within the selected area","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bcA5ttKqkF"}],"identifier":"id-3-6-calculating-areas-sqkm-affected-within-the-selected-area","label":"3.6 Calculating areas (sqkm) affected within the selected area","html_id":"id-3-6-calculating-areas-sqkm-affected-within-the-selected-area","implicit":true,"key":"lCqZDRTRAM"}],"key":"pfcPQHYZGM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Mask pixels above threshold value\nhot_pixels = arr_view \u003e threshold\n\n# Count pixels\nnum_hot_pixels = np.sum(hot_pixels)\n\n# Assuming 1 km² per pixel\narea_km2 = num_hot_pixels * 1  # 1 km² per pixel\n\nprint(f\"Number of pixels \u003e {threshold}°C: {num_hot_pixels}\")\nprint(f\"Total area \u003e {threshold}°C: {area_km2} km²\")","key":"MI8ZK5TzG9"},{"type":"output","id":"2h_zNHuMPcYBe9Yo5n_-B","data":[{"name":"stdout","output_type":"stream","text":"Number of pixels \u003e 40°C: 26\nTotal area \u003e 40°C: 26 km²\n"}],"key":"pblIL40Sub"}],"key":"xmh9zJ062n"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.7 Final remarks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TTu9tCvMsu"}],"identifier":"id-3-7-final-remarks","label":"3.7 Final remarks","html_id":"id-3-7-final-remarks","implicit":true,"key":"awp3kaBWNX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"High Temperatures Around New Delhi\nThe highlighted region (New Delhi) shows elevated land surface temperatures, consistent with the reported heatwave where values exceeded 40 °C.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hypz3kGgH8"}],"key":"G3FJPccfMj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Central and northwestern plains (yellow/orange shades) show much higher LST, typical of semi-arid and urbanized regions during peak summer.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yWHSC2IlU5"}],"key":"DojnGAFPGN"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Urban Heat Island Effect","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kDRJvxLML8"}],"key":"HZGqccgHRj"},{"type":"text","value":" - The dense, bright patch around New Delhi suggests an intensified heating effect compared to the surrounding rural areas, which may be attributed to urbanization, infrastructure, and reduced vegetation cover.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KGcGVVGKct"}],"key":"zpTYDB0uev"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In contrast, coastal and mountainous regions show a clear temperature contrast, indicating geographical control over heat distribution.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Q6gCVedq3b"}],"key":"aUAM5iWqQm"}],"key":"vhWV3PYcB0"}],"key":"jiPr6s4uKC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"USE CASE 4: URBAN HEALTH","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gvgVS2bjBP"}],"identifier":"use-case-4-urban-health","label":"USE CASE 4: URBAN HEALTH","html_id":"use-case-4-urban-health","implicit":true,"key":"CGrgS6zieR"},{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Assessing deprivation and poverty in New Dehli and Gurugram","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ilPmIoKi4q"}],"identifier":"assessing-deprivation-and-poverty-in-new-dehli-and-gurugram","label":"Assessing deprivation and poverty in New Dehli and Gurugram","html_id":"assessing-deprivation-and-poverty-in-new-dehli-and-gurugram","implicit":true,"key":"OMZ3DF8soG"}],"key":"inTmqIedm3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This use case demonstrates how to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UU4CqAv1To"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"estimate deprivation and poverty of two cities","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TlePF33Y1O"}],"key":"NxK77tWWic"},{"type":"text","value":", using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fDxDheYnjg"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Global Gridded Relative Deprivation Index (GRDI), Version 1 dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I4fwLmyQ8H"}],"key":"x5y5VIc5GU"},{"type":"text","value":". characterizes the relative levels of multidimensional deprivation and poverty where a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N75xHShQ28"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"value of 100 represents the highest level of deprivation and a value of 0 the lowest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ndnfSsd3A5"}],"key":"VJAQlqVxIG"},{"type":"text","value":". GRDI is built from sociodemographic and satellite data inputs that were spatially harmonized, indexed, and weighted into six main components to produce the final GRDI layer. Inputs were selected from the best-available data that either continuously vary across space or have at least administrative level 1 (provincial/state) resolution, and which have global spatial coverage. GRDI has six input components, or dimensions, that are combined to determine the degree of relative deprivation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q1NiFSDgoQ"}],"key":"s2TPODAIEz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Built-up to Non-built-up Area Ratio (BUILT)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q0iSnrwc2p"}],"key":"lyeEwDG4Fe"},{"type":"text","value":": Lower ratios mean higher deprivation, as rural areas (with less built-up land) tend to face more poverty.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T37ZcjasoA"}],"key":"brFPZ5J6OY"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Child Dependency Ratio (CDR)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"S2oADJM3X4"}],"key":"bG7uG8g53r"},{"type":"text","value":": Higher ratios mean higher deprivation, since more children depend on fewer working-age adults.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"M6VwECSJ5Q"}],"key":"SooYqPbAsQ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Infant Mortality Rate (IMR)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZxNLABMEqy"}],"key":"KAVNaVCUbn"},{"type":"text","value":": Higher mortality rates signal higher deprivation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qZxj8nRhaW"}],"key":"AD2zjes1ea"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Subnational Human Development Index (SHDI)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cBobAVnB1W"}],"key":"PEl70Ahh9H"},{"type":"text","value":": Lower values mean higher deprivation in education, health, and living standards.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DLroicGFkw"}],"key":"gjlaH0uoKZ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"VIIRS Night Lights (VNL)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wQVyQMTS9B"}],"key":"d0K4eic1xx"},{"type":"text","value":": Lower light intensity indicates higher deprivation, reflecting weaker economic activity and infrastructure.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TY4xhJYgpX"}],"key":"xt2owgQ0J3"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"VNL Slope (2012–2020)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"IoeF1xewA7"}],"key":"AsHrESo7RS"},{"type":"text","value":": A positive slope (increasing brightness) implies decreasing deprivation; a negative slope implies increasing deprivation.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wmSMhYzrvz"}],"key":"qoCdF633u3"}],"key":"mKwzBpC2at"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"In this use case, we will compare both the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"YeEcF8Aazk"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"GRDI","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"hVaUiri95O"}],"key":"SyhTvqUTGd"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"mUy3YUm8Bo"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"VNL slope","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"CgMzfT7v6A"}],"key":"Jv3DVtgvkw"},{"type":"text","value":" specifically to the the cities of New Dehli and Gurugram.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eYy025vGrX"}],"key":"qV6o23QVYi"},{"type":"image","url":"/eodashboard-notebooks/build/dd434246310f90d1292b41aefe3cae36.jpeg","alt":"Description","width":"70%","key":"UqhQAIsxBI","urlSource":"https://thumbnails.openveda.cloud/grdi--dataset-cover.jpg"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The Global Gridded Relative Deprivation Indexindicator can be explored on the EO Dashboard by selecting the EXPLORE DATASETS mode and choosing ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"b30GkpuD4y"},{"type":"link","url":"https://eodashboard.org/explore/?x=-0.0917\u0026y=39.4096\u0026z=2.4939\u0026datetime=2010-01-01\u0026template=expert\u0026indicator=GRDI2","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"GRDI Indicator","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rsZbghNB6w"}],"urlSource":"https://eodashboard.org/explore/?x=-0.0917\u0026y=39.4096\u0026z=2.4939\u0026datetime=2010-01-01\u0026template=expert\u0026indicator=GRDI2","key":"Cnhp7Ndanp"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"cAnXQhfGpE"}],"key":"rD1DwORtNe"}],"key":"mr1K8zTvFc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.1. Input data (GRDI)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pkkhkNc8qE"}],"identifier":"id-4-1-input-data-grdi","label":"4.1. Input data (GRDI)","html_id":"id-4-1-input-data-grdi","implicit":true,"key":"YSfnYymtwD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Temporal Resolution: n/a ( single image resulting from the aggregation of 6 indicators collected within (2010-2020)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Swewv0NBkc"}],"key":"hy0Wo8nMb6"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Spatial Extent: Global","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ie4gCzVBbA"}],"key":"EDEKeQpA1P"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Spatial Resolution: 30 arc-second (~1 km x 1 km)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zXNSm14VEG"}],"key":"GNmXMijrTf"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Data Units: relative level of multidimensional deprivation and poverty in each pixel represented as an index ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ceeSxWr4De"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"from 0 to 100","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zUW7n6u6fx"}],"key":"JEKdqb0IC1"}],"key":"ijsmzJhR8S"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"DOI: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"fpb3zLRoQL"},{"type":"cite","url":"https://doi.org/10.7927/3xxe-ap97","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Center For International Earth Science Information Network-CIESIN-Columbia University (2022)","key":"KKk37TqbeX"}],"kind":"narrative","label":"https://doi.org/10.7927/3xxe-ap97","identifier":"https://doi.org/10.7927/3xxe-ap97","enumerator":"2","key":"ZoDnL71uL4"}],"key":"Qxyio5HRYp"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dataset documentation: ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dlm6ZT9WUE"},{"type":"link","url":"https://www.earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-pmp-grdi-2010-2020-1.00#documents-and-resources","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"https://​www​.earthdata​.nasa​.gov​/data​/catalog​/sedac​-ciesin​-sedac​-pmp​-grdi​-2010​-2020​-1​.00​#documents​-and​-resources","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QyfE9JX0vG"}],"urlSource":"https://www.earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-pmp-grdi-2010-2020-1.00#documents-and-resources","key":"it30BY4XGk"}],"key":"yAYJgaCbNm"}],"key":"o1y9dcTDe5"}],"key":"qhq7W0V6li"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.2 Import python libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CgkLyIZtzk"}],"identifier":"id-4-2-import-python-libraries","label":"4.2 Import python libraries","html_id":"id-4-2-import-python-libraries","implicit":true,"key":"qpu9KxP8IQ"}],"key":"PsDKYCgLPa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport requests\nfrom IPython.display import Image\nimport mercantile\nfrom io import BytesIO\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom PIL import Image\nimport mercantile\nimport numpy as np\nfrom shapely.geometry import Polygon, Point\n#from pykml import parser\nimport matplotlib.pyplot as plt\n#!pip install fastkml shapely\n#!pip install pykml\nimport requests\nimport folium\nfrom folium.raster_layers import ImageOverlay","key":"GoFJwoXD4e"},{"type":"output","id":"VElN_YCHLCTk_ZVZogTiG","data":[],"key":"JvaV87eWhZ"}],"key":"ELxicShxkW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.3 Defining working folders","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mNDDwCQPuE"}],"identifier":"id-4-3-defining-working-folders","label":"4.3 Defining working folders","html_id":"id-4-3-defining-working-folders","implicit":true,"key":"Cuon5z4Tsl"}],"key":"co7STxRbGj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"output_urban = \"output\"\nurban_path = os.path.join(os.getcwd(), \"Poverty\", output_urban)\n\n# Create output dir\nos.makedirs(urban_path, exist_ok=True)","key":"f2avLWXdRa"},{"type":"output","id":"gUIWQD_P9HzDNOdc-MP58","data":[],"key":"SpSobTrsN0"}],"key":"LexE5YNrBt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.4. Visualizing the input data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dUSrENpxuF"}],"identifier":"id-4-4-visualizing-the-input-data","label":"4.4. Visualizing the input data","html_id":"id-4-4-visualizing-the-input-data","implicit":true,"key":"SC3vslJ1Sw"},{"type":"heading","depth":5,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Query the STAC endpoint","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"U05Rs1Yp1x"}],"identifier":"query-the-stac-endpoint","label":"Query the STAC endpoint","html_id":"query-the-stac-endpoint","implicit":true,"key":"YNF0UXbny1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"GRDI dataset and all its 6 forming components ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GYkRJEJLtE"},{"type":"link","url":"https://github.com/ESA-eodashboards/eodashboard-catalog/tree/main/collections","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"are part of the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Hwd0BdrhPv"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"EO Dashboard data ecosystem","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GsnuDNR78T"}],"key":"MX4sIi6dj7"},{"type":"text","value":": check the collections.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Eqnl90ctTe"}],"urlSource":"https://github.com/ESA-eodashboards/eodashboard-catalog/tree/main/collections","error":true,"key":"OJLDuOiO3m"},{"type":"text","value":" and explore them on the EO Dashboard:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QxhicsNYmn"},{"type":"link","url":"https://eodashboard.org/explore/?x=-0.0917\u0026y=39.4096\u0026z=2.3242\u0026datetime=2010-01-01\u0026template=expert\u0026indicator=GRDI2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"GRDI","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gtLJCZvJS2"}],"urlSource":"https://eodashboard.org/explore/?x=-0.0917\u0026y=39.4096\u0026z=2.3242\u0026datetime=2010-01-01\u0026template=expert\u0026indicator=GRDI2","key":"bxgVoGRuJJ"},{"type":"text","value":"; ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QaavAxyrUk"},{"type":"link","url":"https://eodashboard.org/explore/?x=-0.0917\u0026y=39.4096\u0026z=2.3242\u0026datetime=2015-01-01\u0026template=expert\u0026indicator=GRDI1","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Builtup Area","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Xmom1H9bUs"}],"urlSource":"https://eodashboard.org/explore/?x=-0.0917\u0026y=39.4096\u0026z=2.3242\u0026datetime=2015-01-01\u0026template=expert\u0026indicator=GRDI1","key":"xHzPO0oJfO"},{"type":"text","value":"; ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZUzSPwC35N"},{"type":"link","url":"https://eodashboard.org/explore/?x=5.9701\u0026y=49.2863\u0026z=3.5875\u0026datetime=2010-01-01\u0026template=expert\u0026indicator=GRDI8","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Child Dependency Ratio","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"klLmfQcfK3"}],"urlSource":"https://eodashboard.org/explore/?x=5.9701\u0026y=49.2863\u0026z=3.5875\u0026datetime=2010-01-01\u0026template=expert\u0026indicator=GRDI8","key":"MoLKEsDsya"},{"type":"text","value":"; ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"l5BkcnTPQ0"},{"type":"link","url":"https://eodashboard.org/explore/?x=-0.0917\u0026y=39.4096\u0026z=2.3242\u0026datetime=2015-01-01\u0026template=expert\u0026indicator=GRDI7","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Infant Mortality Rates","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PYSZJisKMP"}],"urlSource":"https://eodashboard.org/explore/?x=-0.0917\u0026y=39.4096\u0026z=2.3242\u0026datetime=2015-01-01\u0026template=expert\u0026indicator=GRDI7","key":"IM3MfapiRy"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kpsfL1tY4E"}],"key":"cl8sNoqOUp"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The data endpoint in this case is not public accessible, but NASA VEDA allows to use a Tile Endpoint, which enables to show interactive map without downloading the full raster (VEDA API handles S3 authentication). VEDA endpoint is used by ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Va2rMXecfq"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"EO Dashboard","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"me3p3w0WwB"}],"key":"SMvc4y4G7Y"},{"type":"text","value":" that directly interacts with the services provided by VEDA, e.g. like rendering the image.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MN0YKjKH9t"}],"key":"Ab9K8DznLO"}],"key":"wu9DTgvwDd"}],"key":"A0lGt2bnLL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pystac_client import Client\n\n# STAC endpoint\nstac_url = \"https://openveda.cloud/api/stac/\"\nclient = Client.open(stac_url)\n\n# list available collections. \n# Uncomment below to see all collecions:\n#collections = [c.id for c in client.get_collections()]\n#print(collections[:])  # print all collections","key":"gG5rNsHMpd"},{"type":"output","id":"P3legVQvQRKNF1C9ooqLS","data":[],"key":"Y8DLdn1JDy"}],"key":"rXI650SLHo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Selection of collection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B6QklWXUUB"}],"identifier":"selection-of-collection","label":"Selection of collection","html_id":"selection-of-collection","implicit":true,"key":"KefgJYyppQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Selecting which dataset to query","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Sa9XXFLNZq"}],"key":"hlwLjd6wIA"}],"key":"ChlkkL2Ahn"}],"key":"MKCDBwGEXL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"collection_id = \"grdi-v1-raster\"\n#collection_id =  \"grdi-v1-raster\" or \"grdi-vnl-slope-raster\" or  'grdi-vnl-raster' or grdi-v1-built', 'grdi-v1-raster',\"grdi-vnl-slope-raster\" or","key":"likELTkBby"},{"type":"output","id":"CdUinDjO4270p2Zlji5La","data":[],"key":"oGtW8a1Ty8"}],"key":"KbHte1vmEJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Query the STAC Endpoint with selected collection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"piEN5nfS6Y"}],"identifier":"query-the-stac-endpoint-with-selected-collection","label":"Query the STAC Endpoint with selected collection","html_id":"query-the-stac-endpoint-with-selected-collection","implicit":true,"key":"c47nanZJBb"}],"key":"rY3s2q4AWX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"search = client.search(collections=[collection_id], max_items=5)\nitems = list(search.items())\n\nprint(f\"Found {len(items)} items\")\n\n# Look at the first item\nitem = items[0]\nprint(\"Item ID:\", item.id)\nprint(\"Assets:\", item.assets.keys())\n\ncog_url = item.assets[\"cog_default\"].href\nprint(\"Data endpoint: COG URL:\", cog_url)\n\ncog_url = item.assets[\"rendered_preview\"].href\nprint(\"Rendered preview:\", cog_url)\n\ncog_path = item.assets.get(\"cog_default\", None)\nif cog_path is None:\n    raise ValueError(\"No COG asset found for this item!\")\n\ncog_path = cog_path.href\nprint(\"COG PATH:\", cog_path)","key":"ApEsfkoXao"},{"type":"output","id":"XcF9qGLwP5A3n-FKkAq8Q","data":[{"name":"stdout","output_type":"stream","text":"Found 1 items\nItem ID: povmap-grdi-v1_2010-01-01_2021-12-31\nAssets: dict_keys(['cog_default', 'rendered_preview'])\nData endpoint: COG URL: s3://veda-data-store/grdi-v1-raster/povmap-grdi-v1_2010-01-01_2021-12-31.tif\nRendered preview: https://openveda.cloud/api/raster/collections/grdi-v1-raster/items/povmap-grdi-v1_2010-01-01_2021-12-31/preview.png?assets=cog_default\u0026rescale=0%2C100\u0026colormap_name=viridis\nCOG PATH: s3://veda-data-store/grdi-v1-raster/povmap-grdi-v1_2010-01-01_2021-12-31.tif\n"}],"key":"Iub4fR9xGm"}],"key":"wq3o3N2su1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Preview of data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T7k3FGlVy8"}],"identifier":"preview-of-data","label":"Preview of data","html_id":"preview-of-data","implicit":true,"key":"uJmAjsAVGI"}],"key":"JNREgVsefJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cog_preview_url = item.assets[\"rendered_preview\"].href\n\nresponse = requests.get(cog_preview_url)\nimg = Image.open(BytesIO(response.content))\n\nplt.figure(figsize=(8,6))\nplt.imshow(img)\nplt.axis(\"off\")\nplt.title(\"Rendered Preview\")\nplt.show()","key":"wAR8ttJRJd"},{"type":"output","id":"wfILV_CIg4XNX-p9UCz5V","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3a55d0e0e03245bca47340314550899e","path":"/eodashboard-notebooks/build/3a55d0e0e03245bca47340314550899e.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"qniHV7D553"}],"key":"vQg0vxvBMu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Tile Endpoint","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fWg0CeUEu3"}],"identifier":"tile-endpoint","label":"Tile Endpoint","html_id":"tile-endpoint","implicit":true,"key":"g5AY2ykx3T"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Using Tile endpoint since in this case S3 path is not public","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bw7Z2rL56d"}],"key":"qGh7hAKJXt"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The VEDA Tile endpoint generates Web Mercator map tiles from a Cloud-Optimized GeoTIFF (COG) for given z/x/y coordinates, applying optional resampling, band selection, colormap, and value rescaling.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dS63yDVVzW"}],"key":"UgEqJP6ywt"}],"key":"jn0uEsH0UU"}],"key":"zwfnKe9C7n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Coordinates over India\nlon, lat = 77.1025, 28.7041\nzoom = 6\n\n# Converts longitude and latitude into a tile in the Web Mercator grid\ntile = mercantile.tile(lon, lat, zoom)\n\n# Tile endpoint (which takes the COG and returns map tiles)\nbase_url = \"https://openveda.cloud/api/raster/cog/tiles/WebMercatorQuad\"\n\n# Constructs the full url to request the tile image\ntile_url = (\n    f\"{base_url}/{tile.z}/{tile.x}/{tile.y}\"\n    f\"?url={cog_path}\u0026resampling_method=nearest\u0026bidx=1\"\n    f\"\u0026colormap_name=viridis\u0026rescale=0,100\"\n)\n\n# Request and plot the tile\nresponse = requests.get(tile_url)\nimg = Image.open(BytesIO(response.content))\n\nplt.imshow(img)\nplt.axis(\"off\")\nplt.title(f\"GRDI - Zoomed to India (Zoom level: {zoom})\")\nplt.show()\n","key":"kBrz8kuwUv"},{"type":"output","id":"VYnb9aXiv_WHDxFhifa1-","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"11f78414fa778b25cd4e148f6cf87f3f","path":"/eodashboard-notebooks/build/11f78414fa778b25cd4e148f6cf87f3f.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"J5TevCbnsv"}],"key":"kGPjGJZP3I"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.4 Comparing two cities: New Delhi vs Gurugram","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JnifumR7O1"}],"identifier":"id-4-4-comparing-two-cities-new-delhi-vs-gurugram","label":"4.4 Comparing two cities: New Delhi vs Gurugram","html_id":"id-4-4-comparing-two-cities-new-delhi-vs-gurugram","implicit":true,"key":"vhxeB1BG2z"}],"key":"q1eQgeiFby"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Definition of the city boundaries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ApvMqDFZfF"}],"identifier":"definition-of-the-city-boundaries","label":"Definition of the city boundaries","html_id":"definition-of-the-city-boundaries","implicit":true,"key":"Dbm0AU1Xbk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Since we are comparing specifically the overall indicator of two distinct cities, we will try to focus on their admnistrative context","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"g6ewqMHbZa"}],"key":"r9qAwefYbW"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You can hand-draw your own coordinates, or downdload kml or shapefile for your AoI","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X7gaxZdg4D"}],"key":"mWM2B71AHM"}],"key":"nZZNkdTHpP"}],"key":"dSl1NQ15Ao"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Coordinates for cities \nnewdelhi_nd = Polygon([(77.05010024928556, 28.545329632240488),(77.06932632350431, 28.527232785401164),(77.12151138209806, 28.493443691269704),(77.11052505397306, 28.458436437649425),(77.15172378444181, 28.435494362127248),(77.19292251491056, 28.4463622814295),(77.20253555201994, 28.472923604842666),(77.19292251491056, 28.497064469025712),(77.23961440944181, 28.5043056518795),(77.28355972194181, 28.530852403411522),(77.31102554225431, 28.545329632240488),(77.28767959498869, 28.571866050451412),(77.32201187037931, 28.574278120363793),(77.35085098170744, 28.6032186447749),(77.34398452662931, 28.633356550416348),(77.36321060084806, 28.65505048508341),(77.32475845241056, 28.73214811494396),(77.34398452662931, 28.777897949422616),(77.25884048366056, 28.786323363598065),(77.23961440944181, 28.730943901281826),(77.23686782741056, 28.705652209939004),(77.19841567897306, 28.729739673745172),(77.17094985866056, 28.751413646301874),(77.11876480006681, 28.768268071318303),(77.10365859889494, 28.751413646301874),(77.06245986842619, 28.724922624860923),(77.02812759303556, 28.67914959345852),(77.01027480983244, 28.638177812503272),(77.00478164576994, 28.593572688482055),(77.01988784694181, 28.569453925238474),(77.05010024928556, 28.545329632240488)])\ngurugram_nd = Polygon([(77.03636733912931, 28.552567500585084),(77.06795303248869, 28.526026218441455),(77.10777847194181, 28.493443691269704),(77.11464492701994, 28.43066381740982),(76.99928848170744, 28.389595287262374),(76.97319595241056, 28.388387148302826),(76.92650405787931, 28.334006651363715),(76.87981216334806, 28.359387683848297),(76.89079849147306, 28.400467918290314),(76.92238418483244, 28.478959338289766),(76.96844764838063, 28.48499472683416),(77.00827308783376, 28.50792605695689),(77.00415321478688, 28.540504110335135),(77.03636733912931, 28.552567500585084)])\n#ballabgarh_nd = Polygon([(77.305, 28.390),(77.315, 28.385),(77.325, 28.375),(77.330, 28.365),(77.320, 28.355),(77.310, 28.350),(77.300, 28.355),(77.295, 28.365),(77.295, 28.375),(77.300, 28.385),(77.305, 28.390)])\n#ghaziabad_nd = Polygon([(77.380, 28.670),(77.400, 28.660),(77.420, 28.645),(77.435, 28.625),(77.430, 28.605),(77.410, 28.590),(77.390, 28.595),(77.370, 28.610),(77.360, 28.630),(77.365, 28.650),(77.380, 28.670)])\n\n# Creating a dictionary of the cities to loop through them later\npolygons = {\n    \"New Delhi\": newdelhi_nd,\n    \"Gurugram\": gurugram_nd\n}","key":"NY8mB4RjJT"},{"type":"output","id":"PSMtHmbxFRVoJzoP0VsGW","data":[],"key":"t71Mg3ZvlD"}],"key":"ZD0l81T3DV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fetch COG into tile","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ih0sGkV73O"}],"identifier":"fetch-cog-into-tile","label":"Fetch COG into tile","html_id":"fetch-cog-into-tile","implicit":true,"key":"q081jdNXt4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Fetches COG map tiles for polygon-centered coordinates, crops them to the polygons, and overlays onto a Folium map","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Jjw4S5qk8N"}],"key":"yEAeKgimsg"}],"key":"RZvV9izcT6"}],"key":"QrgepT9vVt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n# This will fetch the map tile image of defined lon and lat and a cog_raster\ndef get_tile_image(lon, lat, zoom, cog_path, base_url):\n    tile = mercantile.tile(lon, lat, zoom)\n    url = (\n        f\"{base_url}/{tile.z}/{tile.x}/{tile.y}\"\n        f\"?url={cog_path}\u0026resampling_method=nearest\u0026bidx=1\"\n        f\"\u0026colormap_name=viridis\u0026rescale=0,100\"\n    )\n    response = requests.get(url)\n    img = Image.open(BytesIO(response.content)).convert(\"RGBA\")\n    return np.array(img), tile\n\n# Crops the tile into defined polygon\ndef crop_to_polygon(img_array, tile, polygon):\n    height, width = img_array.shape[:2]\n    lon_ul, lat_ul = mercantile.ul(tile.x, tile.y, tile.z).lng, mercantile.ul(tile.x, tile.y, tile.z).lat\n    lon_lr, lat_lr = mercantile.ul(tile.x+1, tile.y+1, tile.z).lng, mercantile.ul(tile.x+1, tile.y+1, tile.z).lat\n    res_lon = (lon_lr - lon_ul) / width\n    res_lat = (lat_lr - lat_ul) / height\n\n    mask = np.zeros((height, width), dtype=bool)\n    for i in range(height):\n        for j in range(width):\n            lat_p = lat_ul + i * res_lat\n            lon_p = lon_ul + j * res_lon\n            if polygon.contains(Point(lon_p, lat_p)):\n                mask[i, j] = True\n    img_array[~mask] = [0, 0, 0, 0]\n    return img_array\n\n# --- Settings ---\nzoom = 8\n#base_url = \"https://openveda.cloud/api/raster/cog/tiles/WebMercatorQuad\"\n#cog_path = \"s3://veda-data-store/grdi-v1-raster/povmap-grdi-v1_2010-01-01_2021-12-31.tif\"\n# cog_path= \"s3://veda-data-store/grdi-vnl-slope-raster/povmap-grdi-v1_VNL-slope_2012-01-01_2020-12-31.tif\"\n\n\n\n# Loop through each city to get the tile crop and plot\nm = folium.Map(location=[28.55, 77.13], zoom_start=11)\n\nfor city, polygon in polygons.items():\n    # Get approximate center of polygon for fetching tile\n    lon, lat = polygon.centroid.x, polygon.centroid.y\n    img, tile = get_tile_image(lon, lat, zoom, cog_path, base_url)\n    img = crop_to_polygon(img, tile, polygon)\n\n    # Overlay image\n    ul_lat, ul_lon = mercantile.ul(tile.x, tile.y, tile.z).lat, mercantile.ul(tile.x, tile.y, tile.z).lng\n    lr_lat, lr_lon = mercantile.ul(tile.x+1, tile.y+1, tile.z).lat, mercantile.ul(tile.x+1, tile.y+1, tile.z).lng\n    ImageOverlay(image=img, bounds=[[lr_lat, ul_lon], [ul_lat, lr_lon]], opacity=0.6).add_to(m)\n\n    # Add border\n    folium.Polygon(\n        locations=[(lat, lon) for lon, lat in polygon.exterior.coords],\n        color='red' if city==\"New Delhi\" else 'blue',\n        weight=6,  # \u003c-- thicker border\n        fill=False\n).add_to(m)\n\nm","key":"GWMfJgO7uo"},{"type":"output","id":"dZkRIG6SUzBRY1CyeL2VK","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/html":{"content":"\u003cdiv style=\"width:100%;\"\u003e\u003cdiv style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"\u003e\u003cspan style=\"color:#565656\"\u003eMake this Notebook Trusted to load map: File -\u003e Trust Notebook\u003c/span\u003e\u003ciframe srcdoc=\"\u0026lt;!DOCTYPE html\u0026gt;\n\u0026lt;html\u0026gt;\n\u0026lt;head\u0026gt;\n    \n    \u0026lt;meta http-equiv=\u0026quot;content-type\u0026quot; content=\u0026quot;text/html; charset=UTF-8\u0026quot; /\u0026gt;\n    \u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n    \u0026lt;script src=\u0026quot;https://code.jquery.com/jquery-3.7.1.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n    \u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n    \u0026lt;script src=\u0026quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css\u0026quot;/\u0026gt;\n    \n            \u0026lt;meta name=\u0026quot;viewport\u0026quot; content=\u0026quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no\u0026quot; /\u0026gt;\n            \u0026lt;style\u0026gt;\n                #map_e0fafccfc46c30ec1ad3931048ea3181 {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            \u0026lt;/style\u0026gt;\n\n            \u0026lt;style\u0026gt;html, body {\n                width: 100%;\n                height: 100%;\n                margin: 0;\n                padding: 0;\n            }\n            \u0026lt;/style\u0026gt;\n\n            \u0026lt;style\u0026gt;#map {\n                position:absolute;\n                top:0;\n                bottom:0;\n                right:0;\n                left:0;\n                }\n            \u0026lt;/style\u0026gt;\n\n            \u0026lt;script\u0026gt;\n                L_NO_TOUCH = false;\n                L_DISABLE_3D = false;\n            \u0026lt;/script\u0026gt;\n\n        \n    \n            \n                \u0026lt;style\u0026gt;\n                    .leaflet-image-layer {\n                        /* old android/safari*/\n                        image-rendering: -webkit-optimize-contrast;\n                        image-rendering: crisp-edges; /* safari */\n                        image-rendering: pixelated; /* chrome */\n                        image-rendering: -moz-crisp-edges; /* firefox */\n                        image-rendering: -o-crisp-edges; /* opera */\n                        -ms-interpolation-mode: nearest-neighbor; /* ie */\n                    }\n                \u0026lt;/style\u0026gt;\n            \n        \n    \n            \n                \u0026lt;style\u0026gt;\n                    .leaflet-image-layer {\n                        /* old android/safari*/\n                        image-rendering: -webkit-optimize-contrast;\n                        image-rendering: crisp-edges; /* safari */\n                        image-rendering: pixelated; /* chrome */\n                        image-rendering: -moz-crisp-edges; /* firefox */\n                        image-rendering: -o-crisp-edges; /* opera */\n                        -ms-interpolation-mode: nearest-neighbor; /* ie */\n                    }\n                \u0026lt;/style\u0026gt;\n            \n        \n\u0026lt;/head\u0026gt;\n\u0026lt;body\u0026gt;\n    \n    \n            \u0026lt;div class=\u0026quot;folium-map\u0026quot; id=\u0026quot;map_e0fafccfc46c30ec1ad3931048ea3181\u0026quot; \u0026gt;\u0026lt;/div\u0026gt;\n        \n\u0026lt;/body\u0026gt;\n\u0026lt;script\u0026gt;\n    \n    \n            var map_e0fafccfc46c30ec1ad3931048ea3181 = L.map(\n                \u0026quot;map_e0fafccfc46c30ec1ad3931048ea3181\u0026quot;,\n                {\n                    center: [28.55, 77.13],\n                    crs: L.CRS.EPSG3857,\n                    ...{\n  \u0026quot;zoom\u0026quot;: 11,\n  \u0026quot;zoomControl\u0026quot;: true,\n  \u0026quot;preferCanvas\u0026quot;: false,\n}\n\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_13cb9fafc1744d22e140ffaf0bd31e1a = L.tileLayer(\n                \u0026quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png\u0026quot;,\n                {\n  \u0026quot;minZoom\u0026quot;: 0,\n  \u0026quot;maxZoom\u0026quot;: 19,\n  \u0026quot;maxNativeZoom\u0026quot;: 19,\n  \u0026quot;noWrap\u0026quot;: false,\n  \u0026quot;attribution\u0026quot;: \u0026quot;\\u0026copy; \\u003ca href=\\\u0026quot;https://www.openstreetmap.org/copyright\\\u0026quot;\\u003eOpenStreetMap\\u003c/a\\u003e contributors\u0026quot;,\n  \u0026quot;subdomains\u0026quot;: \u0026quot;abc\u0026quot;,\n  \u0026quot;detectRetina\u0026quot;: false,\n  \u0026quot;tms\u0026quot;: false,\n  \u0026quot;opacity\u0026quot;: 1,\n}\n\n            );\n        \n    \n            tile_layer_13cb9fafc1744d22e140ffaf0bd31e1a.addTo(map_e0fafccfc46c30ec1ad3931048ea3181);\n        \n    \n            var image_overlay_88a76dc0961d69dd4befa9d03a18a33a = L.imageOverlay(\n                \u0026quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAIuklEQVR42u3d63NcZRkAcPxHkFtbWgqlpbb0Qul18AKOKKKiIIowiKPiFXHEtrRpTJNdPzt+c/zm6L943OfNPicnh3P2kmSbJvn9Zp6ZzXaz6eyZ59n3fh55BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2HUnfzaoInwScIALwNkfrG2KU+8NqidX1uPRf65UR/4yVCRgPyZ/MyLxI6IIfOVH63H0T8PqsX8vlXj6z8Pqy/+6V8InCAoAsNMO3xpWL99Yrh5UAWh3AZrxxLgbEPH0/25Wh/5zu4SrBAtw/Utv1AUg4uqlperS11Z2NOFeeHfzN/+8BcBVggU59smwOv7xsLp28W6JSP5m7MTfePF7o+b92xsxqQBEnH5nUOLQnUF15L+3FABYVPJPKwB1fPVvlQIA+0Ak+tWXJiR7TwGI39vK37vwrfvVS99YKTEt+Zvx+Jo1A7DjyR9x4qPBXAUgRuijCMzbErh6eWk9+V9dj4uv3a+iRRAxrQBYDwALSP7tFoCXX5m9CGynALhisAMuX1+uIkrT/9JSiRiNz+SOJvosRSBH8eO9Tn4wW/P8ypV7dfM/I2ccXnxztUQz6WNM4rlfrocrBzvwrb+oAhBx7fydalLyKwCwSyJpJ43sn3lrrcT576zWz53/9mpdJL7QDRiP4p/54Vp19NNhiegSRNL2Nf/rLkBHZAGI7kD+X+K9musFXEXYYvI/yALQVQQUANjlAnD52vJMzfvmOoArV++VmPT60z8elGhPFT7/4cbYQD7fTPoTPx/Uj899d7XExW9uDAxG5IBhFIfH/q4IwJaSf57IpI8++1Z+PwtAtCYi4v9x7A+jlsEo+loAdUsgkn78uLQYvr5S4oWfDBQAWHTyL6IAxK6+nSoAigAsuABMXQo8JfFzfUDG4ZvDKjYaRfQlfiR4RPO5HDeIeOb3ZgRg4cmvAMAel3PrJRqJ2EzMTNR8LhNt1gJx8v1Bib73j3j218MSUQBiM0/EtC7Apnh1ZWNA8M3V+qAQVxgUAGBi8m8hmoWhN0ZFoJno0yISf1oXYOr6gFHEmoMIVxm2WACyfx9bgLdVLOYoANF/z2/vLyT5eJS/r9jEYqSISHwbg2CC2F2nAMABdeSzjfP8YmNORPTrr124UyLm9mM1YEQWgYh4vNUCkH8nI9cQNP8tHsdagIhzb6zO9Xdic1JEmSV4dz1caVAAgBSJFltz2wWgJGAjoZpbd7v+fStx/eztEqW4jLcbt1+TTf4oUjk7MFMBeP1+ieYJwq42dBSAvshv5Xay506/8rpxK6EvEeMbuOv5TPiIaG1kC6MuCK2I8YC4yUfE1MJy7nNjALCd5FcA4IAXgEz03pmBxmsjSZv/lht6nvldd8LGFt44sDMifjdP/rlxprsAROTrZ+kC5OyB8wFBAVAAYN4C0Jn0F+7MPRB49vtrJZ77xbA+tSeW+eag3o3TNzdt4ImfI6Ipn92QWD6cMwJ93Yp2NyCi+fddcVAAgE2DfaOmdw7mtZv1Ze6/rxi0Bgyb/xZHdEXENFyeA3j8t+sbfDKaST8tmvsNojmfR4E1Ez67LJn8GTnY6KrDjN/+s7QM2kWksy8+Svwjfx2WOPT5KPFvrUeM5vclexae8vN40VEkcLYAom8/rQWQYwpRALZyNyJQABQAUABmip61ANnnj2ie8Vf6+mdul2gmerMQxArAej7/rbV6FuDZX01eFVjOF2gtCY5w1UEBAGKAblJCx1bbrhV/OSgYEYNxedrPplV+17rX88fa/K4mf3sWIOP0O4ON04dG7xM/Rxz743Dj8bigNAceS8K/vhFZRFx1UACASODYYhvRuQ/gyr2pzf4Y4JtlHUAma3MHYLx/JmzZX9AYAOw6fzAKUa4JKN2B8cBidgViurFu7o93AUbENuB4vSsOk8YBxif+zDsL0PV41qg3BMVS4LyV2AxnCx7/zbB66u5gUzy5PKhvNZbJHyH5YZYisE8LgCsMMxSAPEY7fy797HFCNZO/OXaQTfh8bjuHg+R7znS6cEc8vjaoHv3H/RJRDFxZmKMI7PUC4CrCNsQttyN6DwcZr6xrbq6J4pBz/O3DQXL9/8QuQG71vb5c/+6kJD/13qBEZ7fgY7f+gh0bFIxv9WZyZ9Kf+umgs2XQjhMfDUpMmhnIIjHrt3z+3VgKnNN/WgGwgCKwFwtAjAO4grATReDi3XpkPubS42SfiGOfbEQUh/q+f60CkItwnv9wUK8DiPP55r6dWE/kmEUUpIiyVmC8lsAVhO0WAQUAtASaNwppH8wRm3L61gnUN/oYPY6TgCKikGRXIrf4RsR71bceu7Q0UwGIOwBH5HtHgYlBSlcNFlAEHvYC4ErBgkSy9t0joOtwkPZr8rnYd1C28o6ivda/r5lv/h8eAtOW/MbCoRyZb94/sG8WIHbn5TjBpATPU4CarYRYOyD5YReKwMNQAFwJ2EX1yP+F7huJNM8HbJ8VmIkdswPzjvxLfniIisCDLgA+dXiIxK2/crVg3Dp801n940M9mo9nSfIoGBIf9pCdLgA+Udhjjn463LRoqG72v6JZDwdC/a3fSvr6FmN56tAoDOqBAqAIwH7Qnq5r/ty3+ScLg08PFABgr2o275srAM3xwwEQS4DjXL6I2O2X3+6SH/a5uN23AgAH1BMrg3KbrqeWBiUO3x7W3YE4RSgXCF187X7n2IBPEPYBBQAOuCOfrd+pNwtAHP6R237jjsOZ/PFzrBfwicE+NK0A+IRgn8udfXn2n08EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2hf8D1XtRwlyZLZUAAAAASUVORK5CYII=\u0026quot;,\n                [[28.304380682962773, 75.9375], [29.535229562948455, 77.34375]],\n                {\n  \u0026quot;opacity\u0026quot;: 0.6,\n}\n            );\n        \n    \n            image_overlay_88a76dc0961d69dd4befa9d03a18a33a.addTo(map_e0fafccfc46c30ec1ad3931048ea3181);\n        \n    \n            var polygon_abf1925d87fe78e1ab35d878874a641f = L.polygon(\n                [[28.545329632240488, 77.05010024928556], [28.527232785401164, 77.06932632350431], [28.493443691269704, 77.12151138209806], [28.458436437649425, 77.11052505397306], [28.435494362127248, 77.15172378444181], [28.4463622814295, 77.19292251491056], [28.472923604842666, 77.20253555201994], [28.497064469025712, 77.19292251491056], [28.5043056518795, 77.23961440944181], [28.530852403411522, 77.28355972194181], [28.545329632240488, 77.31102554225431], [28.571866050451412, 77.28767959498869], [28.574278120363793, 77.32201187037931], [28.6032186447749, 77.35085098170744], [28.633356550416348, 77.34398452662931], [28.65505048508341, 77.36321060084806], [28.73214811494396, 77.32475845241056], [28.777897949422616, 77.34398452662931], [28.786323363598065, 77.25884048366056], [28.730943901281826, 77.23961440944181], [28.705652209939004, 77.23686782741056], [28.729739673745172, 77.19841567897306], [28.751413646301874, 77.17094985866056], [28.768268071318303, 77.11876480006681], [28.751413646301874, 77.10365859889494], [28.724922624860923, 77.06245986842619], [28.67914959345852, 77.02812759303556], [28.638177812503272, 77.01027480983244], [28.593572688482055, 77.00478164576994], [28.569453925238474, 77.01988784694181], [28.545329632240488, 77.05010024928556]],\n                {\u0026quot;bubblingMouseEvents\u0026quot;: true, \u0026quot;color\u0026quot;: \u0026quot;red\u0026quot;, \u0026quot;dashArray\u0026quot;: null, \u0026quot;dashOffset\u0026quot;: null, \u0026quot;fill\u0026quot;: false, \u0026quot;fillColor\u0026quot;: \u0026quot;red\u0026quot;, \u0026quot;fillOpacity\u0026quot;: 0.2, \u0026quot;fillRule\u0026quot;: \u0026quot;evenodd\u0026quot;, \u0026quot;lineCap\u0026quot;: \u0026quot;round\u0026quot;, \u0026quot;lineJoin\u0026quot;: \u0026quot;round\u0026quot;, \u0026quot;noClip\u0026quot;: false, \u0026quot;opacity\u0026quot;: 1.0, \u0026quot;smoothFactor\u0026quot;: 1.0, \u0026quot;stroke\u0026quot;: true, \u0026quot;weight\u0026quot;: 6}\n            ).addTo(map_e0fafccfc46c30ec1ad3931048ea3181);\n        \n    \n            var image_overlay_97f9828d634f75e52a62c4f89ec440ee = L.imageOverlay(\n                \u0026quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAEOUlEQVR42u3d628UVRgH4PqPFIoKKiI3AWkpGiDxhkYFjfd4wagkaExMNMaoSSntdndGP/hJEyXGy5959D1l1mndIRXrXmaeJ3mTdrv9cjbnN2feOTM7NwcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMB0OL+4kqKMBHTIoY/LVE1+IQAdsfT8xpZJv/x0L5cQAAEgBKDNHn18PZ15ZiPXIy/1/3EaIASgxY69W6TFS/1hLV/s5Tq/tJLrzLMbKVYJUUYLOhwAVgLQMosv9NPZJ3ub9cT6sOLUIOrc2dV0bvl6rvi9+ruRgw4HwGMX1oQAzLr6pN9JVVcJhAB0aOI3BYAQgFlb9l/qpzsNgKYyqjDlDl8tUtTtJvKDn5S5Yk9A1E4D4MTrAyEA0+rAV2USANABR98rUlT9nD1+r6713+kyv75foP569AGOv10IAJiEvd8O0t7fVnPt+eVGEgDQEcffKtJCMUiHPipz3f95mXfvRdUn6f6vy3TvSpFrtxuAEQD3fVEKABj70f+7QVr4fTXN31zbrB96+WgcdeSDIh34ssxVXbr7LxU9gaZVxP5vBAAIAGA8YtkddfjDIp18dZDr4KfllnP2k68Ncu3GUj/fLPRUL1f99egv7OvpAYAAAMaj6vbXl+b1ADj9Yj89/GaRa7cbf1FLz23kip+j6egTgTGZ/7GXpi0AhACMycIf19OpVwa5clPu1i29sdPvnhubdfdakS//Rf0fAeCeAJiQ05f/PurHuX+14ae+WSfu9d/XL3JduOvy3JH3ixS1/egtAGCWlv8319I0BoBPBsYguvBN23KPvVMMw6C6QhAVz/4b3tN/sbflf+s/bw+S7e818WHCk38aAsAnARMwap9/vaLzP+o98dz/pv+p3t94tK89M9AnABO0W+fro0JiS/+gFgRGHabAqZcHaZwBYMRhyo7+J94Y5IrlerX9t75kb2rWxSlA1T+IL/nQ0AMBYOLDzJ7/32rOxalB9fVdTacJ9RuDqpuDjCjMiIeujdjO+y8CwAhCC47+TZ36Ua/r4kPLAqD69t7bTfpq80/cGWjkoKMBYNSgRZO/fv2+fiNPUxAYOehoABg1aJH5n9bT0SvF8CEgsee/6vzXJ76n8kBL7SQAjBK03J7v+2n+5/WUvxIs6tfVYXPQ6EBXTgv+CoGoBz4rdf2hqyEQAWAkAAAAAAAA/gQ96dAsaLCluwAAAABJRU5ErkJggg==\u0026quot;,\n                [[28.304380682962773, 75.9375], [29.535229562948455, 77.34375]],\n                {\n  \u0026quot;opacity\u0026quot;: 0.6,\n}\n            );\n        \n    \n            image_overlay_97f9828d634f75e52a62c4f89ec440ee.addTo(map_e0fafccfc46c30ec1ad3931048ea3181);\n        \n    \n            var polygon_985caf75b54fb5738c373b5367a5e2a3 = L.polygon(\n                [[28.552567500585084, 77.03636733912931], [28.526026218441455, 77.06795303248869], [28.493443691269704, 77.10777847194181], [28.43066381740982, 77.11464492701994], [28.389595287262374, 76.99928848170744], [28.388387148302826, 76.97319595241056], [28.334006651363715, 76.92650405787931], [28.359387683848297, 76.87981216334806], [28.400467918290314, 76.89079849147306], [28.478959338289766, 76.92238418483244], [28.48499472683416, 76.96844764838063], [28.50792605695689, 77.00827308783376], [28.540504110335135, 77.00415321478688], [28.552567500585084, 77.03636733912931]],\n                {\u0026quot;bubblingMouseEvents\u0026quot;: true, \u0026quot;color\u0026quot;: \u0026quot;blue\u0026quot;, \u0026quot;dashArray\u0026quot;: null, \u0026quot;dashOffset\u0026quot;: null, \u0026quot;fill\u0026quot;: false, \u0026quot;fillColor\u0026quot;: \u0026quot;blue\u0026quot;, \u0026quot;fillOpacity\u0026quot;: 0.2, \u0026quot;fillRule\u0026quot;: \u0026quot;evenodd\u0026quot;, \u0026quot;lineCap\u0026quot;: \u0026quot;round\u0026quot;, \u0026quot;lineJoin\u0026quot;: \u0026quot;round\u0026quot;, \u0026quot;noClip\u0026quot;: false, \u0026quot;opacity\u0026quot;: 1.0, \u0026quot;smoothFactor\u0026quot;: 1.0, \u0026quot;stroke\u0026quot;: true, \u0026quot;weight\u0026quot;: 6}\n            ).addTo(map_e0fafccfc46c30ec1ad3931048ea3181);\n        \n\u0026lt;/script\u0026gt;\n\u0026lt;/html\u0026gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cfolium.folium.Map at 0x7fc6da34f640\u003e","content_type":"text/plain"}}}],"key":"pwtQJrcp96"}],"key":"k9i30Dt0ge"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.5 Estimating poverty (average values): New Delhi vs Gurugram","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LLE639iMUm"}],"identifier":"id-4-5-estimating-poverty-average-values-new-delhi-vs-gurugram","label":"4.5 Estimating poverty (average values): New Delhi vs Gurugram","html_id":"id-4-5-estimating-poverty-average-values-new-delhi-vs-gurugram","implicit":true,"key":"IYvRdig30a"}],"key":"VUUrPKwKJ9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Fetch tile image \ndef get_tile_image(lon, lat, zoom, cog_path, base_url):\n    tile = mercantile.tile(lon, lat, zoom)\n    url = (\n        f\"{base_url}/{tile.z}/{tile.x}/{tile.y}\"\n        f\"?url={cog_path}\u0026resampling_method=nearest\u0026bidx=1\"\n        f\"\u0026colormap_name=viridis\u0026rescale=0,100\"\n    )\n    response = requests.get(url)\n    img = Image.open(BytesIO(response.content))\n    img_array = np.array(img).astype(float)\n\n    # Rescale if tile is in 0-255\n    if img_array.max() \u003e 100:\n        img_array = img_array * (100.0 / 255.0)\n\n    return img_array, tile\n\n#  Generate boolean mask for each city/polygon\ndef polygon_mask(tile, polygon, img_shape):\n    height, width = img_shape[:2]\n    lon_ul, lat_ul = mercantile.ul(tile.x, tile.y, tile.z).lng, mercantile.ul(tile.x, tile.y, tile.z).lat\n    lon_lr, lat_lr = mercantile.ul(tile.x+1, tile.y+1, tile.z).lng, mercantile.ul(tile.x+1, tile.y+1, tile.z).lat\n\n    res_lon = (lon_lr - lon_ul) / width\n    res_lat = (lat_lr - lat_ul) / height\n\n    mask = np.zeros((height, width), dtype=bool)\n    for i in range(height):\n        for j in range(width):\n            lon = lon_ul + j * res_lon\n            lat = lat_ul + i * res_lat\n            if polygon.contains(Point(lon, lat)):\n                mask[i, j] = True\n    return mask\n\n# Compute average GRDI for each polygon\ndef compute_average_grdi(polygon, zoom=8):\n    min_lon, min_lat, max_lon, max_lat = polygon.bounds\n    tiles = list(mercantile.tiles(min_lon, min_lat, max_lon, max_lat, zoom))\n    all_values = []\n\n    for tile in tiles:\n        lon = (mercantile.ul(tile.x, tile.y, tile.z).lng + mercantile.ul(tile.x+1, tile.y+1, tile.z).lng) / 2\n        lat = (mercantile.ul(tile.x, tile.y, tile.z).lat + mercantile.ul(tile.x+1, tile.y+1, tile.z).lat) / 2\n\n        img_array, tile = get_tile_image(lon, lat, tile.z, cog_path, base_url)\n\n        mask = polygon_mask(tile, polygon, img_array.shape)\n        all_values.extend(img_array[mask])\n\n    return np.mean(all_values) if all_values else np.nan\n\n","key":"WyqhQATYzK"},{"type":"output","id":"u1QzvQncJ7e1QtFC0XVLE","data":[],"key":"uGbuf2SXGg"}],"key":"DTAaZumjRI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualizing averaged values by city","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v1RMFgp2Ob"}],"identifier":"visualizing-averaged-values-by-city","label":"Visualizing averaged values by city","html_id":"visualizing-averaged-values-by-city","implicit":true,"key":"pHorYPsBEu"}],"key":"fbHlPhFUDU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compute averages\naverages = {city: compute_average_grdi(poly, zoom) for city, poly in polygons.items()}\n\n# Print results\nfor city, avg in averages.items():\n    print(f\"Average GRDI for {city}: {avg:.2f}\")\n\n# Plot results\nplt.figure(figsize=(6, 4))\nplt.bar(averages.keys(), averages.values(), color=['red', 'blue'])\nplt.ylabel(\"Average GRDI Value\")\nplt.title(\"Average GRDI (Masked by Polygons)\")\nfor i, v in enumerate(averages.values()):\n    plt.text(i, v + 0.5, f\"{v:.1f}\", ha='center', fontsize=10, fontweight='bold')\nplt.ylim(0, max(averages.values()) * 1.2)\nplt.show()\n","key":"ENede94hV7"},{"type":"output","id":"0ueGR8N1cgMRjDzYSX73A","data":[{"name":"stdout","output_type":"stream","text":"Average GRDI for New Delhi: 51.64\nAverage GRDI for Gurugram: 52.01\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5f53792d40bf41a706911c897912e9cb","path":"/eodashboard-notebooks/build/5f53792d40bf41a706911c897912e9cb.png"},"text/plain":{"content":"\u003cFigure size 600x400 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"tNj1SaglQQ"}],"key":"KDCGXHuutP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Export graph results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GUPsbBBDDd"}],"identifier":"export-graph-results","label":"Export graph results","html_id":"export-graph-results","implicit":true,"key":"g9bni3Xwbg"}],"key":"OPKWP3QgRS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Sets location of output\noutput_file = os.path.join(urban_path, \"average_grdi.png\")\n\n# --- Plot bar chart and save ---\nplt.figure(figsize=(6, 4))\nplt.bar(averages.keys(), averages.values(), color=['red', 'blue'])\nplt.ylabel(\"Average Value\")\nplt.title(\"Average GRDI (Masked by Polygons)\")\nfor i, v in enumerate(averages.values()):\n    plt.text(i, v + 0.5, f\"{v:.1f}\", ha='center', fontsize=10, fontweight='bold')\nplt.ylim(0, max(averages.values()) * 1.2)\n\n# Save figure\nplt.savefig(output_file, dpi=300, bbox_inches='tight')\nplt.close()\nprint(f\"Graph saved to: {output_file}\")\n","key":"iEQBD5ABPl"},{"type":"output","id":"1gLbQ5d9dL8felR0qIClA","data":[{"name":"stdout","output_type":"stream","text":"Graph saved to: /home/lubojr/2025-BiDS-EODashboard/notebook/Poverty/output/average_grdi.png\n"}],"key":"lGJYtkbkla"}],"key":"EPsDaYXSGf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.5 Final remarks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"osry6lpplA"}],"identifier":"id-4-5-final-remarks","label":"4.5 Final remarks","html_id":"id-4-5-final-remarks","implicit":true,"key":"IlvzRDIlyO"}],"key":"YBqomgNph8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overall GRDI values are ‘mid’. Both New Delhi (51.6) and Gurugram (52) have GRDI values close to the middle on a 0–100 scale, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JnfrXyRK79"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"suggesting relative deprivation \u0026 proverty","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wMfXP4D8Jg"}],"key":"apasBLQHQN"},{"type":"text","value":" . Gurugram ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bVPotMYt70"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"slightly higher than New Delhi, Gurugram’s average","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pX9fTshf2m"}],"key":"MJ9VSmpfXi"},{"type":"text","value":" higher than New Delhi could ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oMQIotlrq5"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"indicate marginally worse development indicators","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rQu5iYLKyB"}],"key":"Ax7k0RRp3z"},{"type":"text","value":", but the difference is small—so not necessarily a large practical difference.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lCXOtDn8Ws"}],"key":"HkqgDJXkJe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"However, other indicators might indicate a relatively different result.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r4ZEPdYwkP"}],"key":"wQ7FuVJIix"}],"key":"LHtrMAA3px"}],"key":"Zd7TBEeBdC"},"references":{"cite":{"order":["2021","https://doi.org/10.7927/3xxe-ap97"],"data":{"2021":{"label":"2021","enumerator":"1","doi":"10.11487/oukan.2021.0_B-4-4","html":"東城文柄. (2021). 地球観測衛星データの公衆衛生学への応用. In \u003ci\u003e横幹連合コンファレンス予稿集\u003c/i\u003e (No. 0; Vol. 2021). 特定非営利活動法人　横断型基幹科学技術研究団体連合. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.11487/oukan.2021.0_B-4-4\"\u003e10.11487/oukan.2021.0_B-4-4\u003c/a\u003e","url":"https://doi.org/10.11487/oukan.2021.0_B-4-4"},"https://doi.org/10.7927/3xxe-ap97":{"label":"https://doi.org/10.7927/3xxe-ap97","enumerator":"2","doi":"10.7927/3XXE-AP97","html":"Center For International Earth Science Information Network-CIESIN-Columbia University. (2022). \u003ci\u003eGlobal Gridded Relative Deprivation Index (GRDI), Version 1\u003c/i\u003e. Palisades, NY: NASA Socioeconomic Data. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.7927/3XXE-AP97\"\u003e10.7927/3XXE-AP97\u003c/a\u003e","url":"https://doi.org/10.7927/3XXE-AP97"}}}},"footer":{"navigation":{"prev":{"title":"2025-BiDS-EODashboard","url":"/external-notebooks/group1/2025-bids-eodashboard/readme","group":"2025 Bi DS EO Dashboard"},"next":{"title":"Evaluation of Fire Impact on Populated Areas on a European Site","url":"/notebooks/fire-impact-analysis","group":"Notebooks"}}},"domain":"http://localhost:3000"},"project":{"subject":"Notebook examples","title":"EO Dashboard Notebooks","description":"Collection of examples relevant to the EO Dashboard project","github":"https://github.com/ESA-eodashboards/eodashboard-notebooks","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Group1","level":2},{"title":"2025 Bi DS EO Dashboard","level":3},{"slug":"external-notebooks.group1.2025-bids-eodashboard.readme","title":"2025-BiDS-EODashboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebook","level":4},{"slug":"external-notebooks.group1.2025-bids-eodashboard.notebook.urban-health-and-megacities","title":"URBAN HEALTH AND MEGACITIES: THE CASE OF NEW DELHI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/header-be0a09fdf5a46e3efaa55b331b0060c1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Notebooks","level":1},{"slug":"notebooks.fire-impact-analysis","title":"Evaluation of Fire Impact on Populated Areas on a European Site","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/22a5ee1ff975cb9c3eb3b1e899bb858e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.inland-water-with-edc","title":"Exploring Inland Water Bodies with Sentinel-2 data in EDC","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallangenotebook-team-5-challenge-3-timeserie","title":"PART 1: SUMMARY","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/a737ae6d2b7cf4511053168c9e99be3b.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.openchallengenotebook-c1-jessel-hezzi-roussel","title":"Earth System Science Open Challenge 1: L. Jessel, S. Hezzi, M. Roussel","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/49e045ccedfe842015ba44cc25ccb377.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.veda-api-bids-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/5d71b8fb32fb3d611031d0ea697e5422.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Eodashboard STAC Access","level":2},{"slug":"notebooks.eodashboard-stac-access.eodashboard-stac-access","title":"EODashboard STAC access examples","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/ff5b0d0faa9a9d99644d137afe5bbd92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Nightlights Notebook","level":2},{"slug":"notebooks.nightlights-notebook.night-lights-blending","title":"Monitoring socio-economic activities with nighttime light maps","description":"","date":"","thumbnail":"/eodashboard-notebooks/build/nighttime_northeaste-2011f743867dcc9f3a804e552695e0e5.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/eodashboard-notebooks/build/manifest-ED236704.js";
import * as route0 from "/eodashboard-notebooks/build/root-ZJOPFBMV.js";
import * as route1 from "/eodashboard-notebooks/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/eodashboard-notebooks/build/entry.client-UNPC4GT3.js");</script></body></html>